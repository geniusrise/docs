
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Print Site - Geniusrise</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Code:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Fira Code";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../main.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="deep-purple">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Geniusrise" class="md-header__button md-logo" aria-label="Geniusrise" data-md-component="logo">
      
  <img src="../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Geniusrise
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Geniusrise" class="md-nav__button md-logo" aria-label="Geniusrise" data-md-component="logo">
      
  <img src="../assets/logo.jpg" alt="logo">

    </a>
    Geniusrise
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../guides/concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../guides/installation/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Design and Architecture
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Local experimentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Packaging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Staged deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Workflow ops
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Data ops
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Model ops
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Apache Airflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Apache Spark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Apache Flink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Apache Beam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Apache Storm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        AWS ECS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        AWS Batch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        YAML structure
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Core Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Core Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_1" >
      
      
      
        <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
          cli
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_1">
          <span class="md-nav__icon md-icon"></span>
          cli
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/cli_boltctl/" class="md-nav__link">
        boltctl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/cli_discover/" class="md-nav__link">
        discover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/cli_geniusctl/" class="md-nav__link">
        geniusctl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/cli_schema/" class="md-nav__link">
        schema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/cli_spoutctl/" class="md-nav__link">
        spoutctl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/cli_yamlctl/" class="md-nav__link">
        yamlctl
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2" >
      
      
      
        <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
          core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_2">
          <span class="md-nav__icon md-icon"></span>
          core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_bolt/" class="md-nav__link">
        bolt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_spout/" class="md-nav__link">
        spout
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_8_2_3" id="__nav_8_2_3_label" tabindex="0">
          data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_2_3">
          <span class="md-nav__icon md-icon"></span>
          data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_data_batch_input/" class="md-nav__link">
        batch_input
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_data_batch_output/" class="md-nav__link">
        batch_output
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_data_input/" class="md-nav__link">
        input
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_data_output/" class="md-nav__link">
        output
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_data_streaming_input/" class="md-nav__link">
        streaming_input
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_data_streaming_output/" class="md-nav__link">
        streaming_output
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_8_2_4" id="__nav_8_2_4_label" tabindex="0">
          state
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_2_4">
          <span class="md-nav__icon md-icon"></span>
          state
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_state_base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_state_dynamo/" class="md-nav__link">
        dynamo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_state_memory/" class="md-nav__link">
        memory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_state_postgres/" class="md-nav__link">
        postgres
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_state_redis/" class="md-nav__link">
        redis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2_5" >
      
      
      
        <label class="md-nav__link" for="__nav_8_2_5" id="__nav_8_2_5_label" tabindex="0">
          task
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8_2_5">
          <span class="md-nav__icon md-icon"></span>
          task
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_task_base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_task_ecs/" class="md-nav__link">
        ecs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core/core_task_k8s/" class="md-nav__link">
        k8s
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guides-concepts" class="md-nav__link">
    2. Concepts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guides-installation" class="md-nav__link">
    3. Getting started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    4. Design and Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-development" class="md-nav__link">
    I. Development
  </a>
  
    <nav class="md-nav" aria-label="I. Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    5. Local experimentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    6. Packaging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    7. Staged deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    8. Workflow ops
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    9. Data ops
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    10. Model ops
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-deployment" class="md-nav__link">
    II. Deployment
  </a>
  
    <nav class="md-nav" aria-label="II. Deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    11. Kubernetes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    12. Apache Airflow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    13. Apache Spark
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    14. Apache Flink
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    15. Apache Beam
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    16. Apache Storm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    17. AWS ECS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    18. AWS Batch
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-reference" class="md-nav__link">
    III. Reference
  </a>
  
    <nav class="md-nav" aria-label="III. Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    19. YAML structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-core-reference" class="md-nav__link">
    IV. Core Reference
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <div id="print-site-banner">
            
        </div>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="guides-concepts"><h1 id="guides-concepts-concepts">Concepts<a class="headerlink" href="#guides-concepts-concepts" title="Permanent link">&para;</a></h1>
<h2 id="guides-concepts-need">Need<a class="headerlink" href="#guides-concepts-need" title="Permanent link">&para;</a></h2>
<hr />
<p>The landscape of machine learning and data processing has been rapidly evolving. While there are numerous solutions available for MLOps and DAG orchestration, most of them cater primarily to data engineering and data science teams. However, the rise of Large Language Models (LLMs) is reshaping this landscape, necessitating a more inclusive approach to MLOps.</p>
<p>LLMs have democratized the use of machine learning models, enabling a broader spectrum of users within an organization to engage with them. This means that even organizations without a traditional data science data management or model management functions are now venturing into this domain.</p>
<p>This shift brings forth several challenges:</p>
<ol>
<li>
<p><strong>Infrastructure Complexity</strong>: The world of MLOps is vast, with a plethora of options available for different use cases. Organizations often grapple with questions like:</p>
<ul>
<li>Which infrastructure is best suited for their needs?</li>
<li>How can they efficiently reuse their existing infrastructure?</li>
<li>How can they ensure scalability and performance while managing costs?</li>
</ul>
</li>
<li>
<p><strong>Diverse Competence Levels</strong>: As LLM workflows become more prevalent, their volume is set to surpass that of traditional ML workflows in many organizations. This surge means that individuals without a formal engineering background or core ML expertise will be involved in the MLOps process. Ensuring that these individuals can contribute effectively without compromising the quality or integrity of the workflows is crucial.</p>
</li>
<li>
<p><strong>Standardization and Productionization</strong>: While many aspects of building LLM workflows can be managed without deep engineering expertise, there's a critical need for standardization. Engineers play a pivotal role in defining the processes for productionizing these workflows. Without standardized practices:</p>
<ul>
<li>How can organizations ensure consistency across workflows?</li>
<li>How can they maintain the reliability and robustness of deployed models?</li>
<li>How can they ensure that best practices are adhered to, regardless of who is building or deploying the workflow?</li>
</ul>
</li>
</ol>
<p>The advent of LLMs underscores the need for a comprehensive MLOps framework that caters to a diverse audience. Such a framework should be flexible enough to accommodate the varied infrastructure needs of organizations, inclusive enough to empower contributors regardless of their technical expertise, and robust enough to ensure standardized, reliable workflows.</p>
<h2 id="guides-concepts-introduction">Introduction<a class="headerlink" href="#guides-concepts-introduction" title="Permanent link">&para;</a></h2>
<hr />
<p>In the ever-evolving landscape of software development, the need for modular, scalable, and interoperable systems has never been greater. The Geniusrise framework is a testament to this philosophy, designed to act as a cohesive adhesive between distinct, modular components, much like how one would piece together Lego blocks. This design approach not only promotes flexibility but also ensures that each module or "Lego block" remains sufficiently independent. Such independence is crucial for diverse teams, each with its own unique infrastructure and requirements, to seamlessly build and manage their respective components.</p>
<p>In brief these are the concepts:</p>
<ol>
<li>
<p><strong>Task</strong>: At its core, a task represents a discrete unit of work within the Geniusrise framework. Think of it as a singular action or operation that the system needs to execute. A task further manifests itself into a Bolt or a Spout as stated below.</p>
</li>
<li>
<p><strong>Components of a Task</strong>: Each task is equipped with four components:</p>
<ol>
<li><strong>State Manager</strong>: This component is responsible for continuously monitoring and managing the task's state, ensuring that it progresses smoothly from initiation to completion and to report errors and ship logs into a central location.</li>
<li><strong>Data Manager</strong>: As the name suggests, the Data Manager oversees the input and output data associated with a task, ensuring data integrity and efficient data flow. It also ensures data sanity follows partition semantics and isolation.</li>
<li><strong>Model Manager</strong>: In the realm of machine learning, model versioning and management are paramount. The Model Manager serves as a GitOps tool for ML models, ensuring that they are versioned, tracked, and managed effectively.</li>
<li><strong>Runner</strong>: These are wrappers for executing a task on various platforms. Depending on the platform, the runner ensures that the task is executed seamlessly.</li>
</ol>
</li>
<li>
<p><strong>Task Classification</strong>: Tasks within the Geniusrise framework can be broadly classified into two categories:</p>
<ul>
<li><strong>Spout</strong>: If a task's primary function is to ingest or bring in data, it's termed as a 'spout'.</li>
<li><strong>Bolt</strong>: For tasks that don't primarily ingest data but perform other operations, they are termed 'bolts'.</li>
</ul>
</li>
</ol>
<p>The beauty of the Geniusrise framework lies in its adaptability. Developers can script their workflow components once and have the freedom to deploy them across various platforms. To facilitate this, Geniusrise offers:</p>
<ol>
<li>
<p><strong>Runners for Task Execution</strong>: Geniusrise is equipped with a diverse set of runners, each tailored for different platforms, ensuring that tasks can be executed almost anywhere:</p>
<ol>
<li>On your <strong>local machine</strong> for quick testing and development.</li>
<li>Within <strong>Docker containers</strong> for isolated, reproducible environments.</li>
<li>On <strong>Kubernetes</strong> clusters for scalable, cloud-native deployments.</li>
<li>Using <strong>Apache Airflow</strong> for complex workflow orchestration.</li>
<li>On <strong>AWS ECS</strong> for containerized application management.</li>
<li>With <strong>AWS Batch</strong> for efficient batch computing workloads.</li>
</ol>
</li>
<li>
<p><strong>Library Wrappers</strong>: To ensure that tasks can interface with a variety of frameworks, Geniusrise provides integrations with:</p>
<ol>
<li><strong>Jupyter/ipython</strong> for interactive computing.</li>
<li><strong>Apache PySpark</strong> for large-scale data processing.</li>
<li><strong>Apache PyFlink</strong> for stream and batch processing.</li>
<li><strong>Apache Beam</strong> for unified stream and batch data processing.</li>
<li><strong>Apache Storm</strong> for real-time computation.</li>
</ol>
</li>
</ol>
<p>The framework aims to support multiple languages:</p>
<ol>
<li>Python</li>
<li>Scala / JVM (WIP)</li>
<li>Golang (WIP)</li>
</ol>
<p>This document delves into the core components and concepts that make up the Geniusrise framework.</p>
<h2 id="guides-concepts-tasks">Tasks<a class="headerlink" href="#guides-concepts-tasks" title="Permanent link">&para;</a></h2>
<hr />
<p>A <strong>task</strong> is the fundamental unit of work in the Geniusrise framework. It represents a specific operation or computation and can run for an arbitrary amount of time, performing any amount of work.</p>
<div class="puml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1376px" preserveAspectRatio="true" style="background: #ffffff" version="1.1" viewBox="0 0 735 1376" width="735px" zoomAndPan="magnify"><defs/><g><rect fill="#0D0816" height="1376" style="stroke:none;stroke-width:1.0;" width="735" x="0" y="0"/><g id="elem_Task"><rect codeLine="12" fill="#E7B67E" height="64.2969" id="Task" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="84" x="44" y="928"/><ellipse cx="67.55" cy="944" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M69.8938,939.6719 C68.9563,939.2344 68.3625,939.0938 67.4875,939.0938 C64.8625,939.0938 62.8625,941.1719 62.8625,943.8906 L62.8625,945.0156 C62.8625,947.5938 64.9719,949.4844 67.8625,949.4844 C69.0813,949.4844 70.2375,949.1875 70.9875,948.6406 C71.5656,948.2344 71.8938,947.7813 71.8938,947.3906 C71.8938,946.9375 71.5031,946.5469 71.0344,946.5469 C70.8156,946.5469 70.6125,946.625 70.425,946.8125 C69.9719,947.2969 69.9719,947.2969 69.7844,947.3906 C69.3625,947.6563 68.675,947.7813 67.9094,947.7813 C65.8625,947.7813 64.5656,946.6875 64.5656,944.9844 L64.5656,943.8906 C64.5656,942.1094 65.8156,940.7969 67.55,940.7969 C68.1281,940.7969 68.7375,940.9531 69.2063,941.2031 C69.6906,941.4844 69.8625,941.7031 69.9563,942.1094 C70.0188,942.5156 70.05,942.6406 70.1906,942.7656 C70.3313,942.9063 70.5656,943.0156 70.7844,943.0156 C71.05,943.0156 71.3156,942.875 71.4875,942.6563 C71.5969,942.5 71.6281,942.3125 71.6281,941.8906 L71.6281,940.4688 C71.6281,940.0313 71.6125,939.9063 71.5188,939.75 C71.3625,939.4844 71.0813,939.3438 70.7844,939.3438 C70.4875,939.3438 70.2844,939.4375 70.0656,939.75 L69.8938,939.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="83.45" y="948.8467">Task</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="45" x2="127" y1="960" y2="960"/><ellipse cx="55" cy="973.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="64" y="976.9951">execute</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="45" x2="127" y1="984.2969" y2="984.2969"/></g><g id="elem_SM"><rect codeLine="16" fill="#E7B67E" height="96.8906" id="SM" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="137" x="550" y="618.5"/><ellipse cx="565" cy="634.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M567.3438,630.1719 C566.4063,629.7344 565.8125,629.5938 564.9375,629.5938 C562.3125,629.5938 560.3125,631.6719 560.3125,634.3906 L560.3125,635.5156 C560.3125,638.0938 562.4219,639.9844 565.3125,639.9844 C566.5313,639.9844 567.6875,639.6875 568.4375,639.1406 C569.0156,638.7344 569.3438,638.2813 569.3438,637.8906 C569.3438,637.4375 568.9531,637.0469 568.4844,637.0469 C568.2656,637.0469 568.0625,637.125 567.875,637.3125 C567.4219,637.7969 567.4219,637.7969 567.2344,637.8906 C566.8125,638.1563 566.125,638.2813 565.3594,638.2813 C563.3125,638.2813 562.0156,637.1875 562.0156,635.4844 L562.0156,634.3906 C562.0156,632.6094 563.2656,631.2969 565,631.2969 C565.5781,631.2969 566.1875,631.4531 566.6563,631.7031 C567.1406,631.9844 567.3125,632.2031 567.4063,632.6094 C567.4688,633.0156 567.5,633.1406 567.6406,633.2656 C567.7813,633.4063 568.0156,633.5156 568.2344,633.5156 C568.5,633.5156 568.7656,633.375 568.9375,633.1563 C569.0469,633 569.0781,632.8125 569.0781,632.3906 L569.0781,630.9688 C569.0781,630.5313 569.0625,630.4063 568.9688,630.25 C568.8125,629.9844 568.5313,629.8438 568.2344,629.8438 C567.9375,629.8438 567.7344,629.9375 567.5156,630.25 L567.3438,630.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="579" y="639.3467">State Manager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="551" x2="686" y1="650.5" y2="650.5"/><ellipse cx="561" cy="664.1484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="570" y="667.4951">monitor state</text><ellipse cx="561" cy="680.4453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="570" y="683.792">report errors</text><ellipse cx="561" cy="696.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="570" y="700.0889">ship logs</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="551" x2="686" y1="707.3906" y2="707.3906"/></g><g id="elem_DM"><rect codeLine="22" fill="#E7B67E" height="113.1875" id="DM" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="219" x="509" y="750.5"/><ellipse cx="564.75" cy="766.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M567.0938,762.1719 C566.1563,761.7344 565.5625,761.5938 564.6875,761.5938 C562.0625,761.5938 560.0625,763.6719 560.0625,766.3906 L560.0625,767.5156 C560.0625,770.0938 562.1719,771.9844 565.0625,771.9844 C566.2813,771.9844 567.4375,771.6875 568.1875,771.1406 C568.7656,770.7344 569.0938,770.2813 569.0938,769.8906 C569.0938,769.4375 568.7031,769.0469 568.2344,769.0469 C568.0156,769.0469 567.8125,769.125 567.625,769.3125 C567.1719,769.7969 567.1719,769.7969 566.9844,769.8906 C566.5625,770.1563 565.875,770.2813 565.1094,770.2813 C563.0625,770.2813 561.7656,769.1875 561.7656,767.4844 L561.7656,766.3906 C561.7656,764.6094 563.0156,763.2969 564.75,763.2969 C565.3281,763.2969 565.9375,763.4531 566.4063,763.7031 C566.8906,763.9844 567.0625,764.2031 567.1563,764.6094 C567.2188,765.0156 567.25,765.1406 567.3906,765.2656 C567.5313,765.4063 567.7656,765.5156 567.9844,765.5156 C568.25,765.5156 568.5156,765.375 568.6875,765.1563 C568.7969,765 568.8281,764.8125 568.8281,764.3906 L568.8281,762.9688 C568.8281,762.5313 568.8125,762.4063 568.7188,762.25 C568.5625,761.9844 568.2813,761.8438 567.9844,761.8438 C567.6875,761.8438 567.4844,761.9375 567.2656,762.25 L567.0938,762.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="585.25" y="771.3467">Data Manager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="510" x2="727" y1="782.5" y2="782.5"/><ellipse cx="520" cy="796.1484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="529" y="799.4951">manage input data</text><ellipse cx="520" cy="812.4453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="529" y="815.792">manage output data</text><ellipse cx="520" cy="828.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="193" x="529" y="832.0889">ensure partition semantics</text><ellipse cx="520" cy="845.0391" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="529" y="848.3857">ensure data isolation</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="510" x2="727" y1="855.6875" y2="855.6875"/></g><g id="elem_MM"><rect codeLine="29" fill="#E7B67E" height="96.8906" id="MM" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="140" x="548.5" y="898.5"/><ellipse cx="563.5" cy="914.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M565.8438,910.1719 C564.9063,909.7344 564.3125,909.5938 563.4375,909.5938 C560.8125,909.5938 558.8125,911.6719 558.8125,914.3906 L558.8125,915.5156 C558.8125,918.0938 560.9219,919.9844 563.8125,919.9844 C565.0313,919.9844 566.1875,919.6875 566.9375,919.1406 C567.5156,918.7344 567.8438,918.2813 567.8438,917.8906 C567.8438,917.4375 567.4531,917.0469 566.9844,917.0469 C566.7656,917.0469 566.5625,917.125 566.375,917.3125 C565.9219,917.7969 565.9219,917.7969 565.7344,917.8906 C565.3125,918.1563 564.625,918.2813 563.8594,918.2813 C561.8125,918.2813 560.5156,917.1875 560.5156,915.4844 L560.5156,914.3906 C560.5156,912.6094 561.7656,911.2969 563.5,911.2969 C564.0781,911.2969 564.6875,911.4531 565.1563,911.7031 C565.6406,911.9844 565.8125,912.2031 565.9063,912.6094 C565.9688,913.0156 566,913.1406 566.1406,913.2656 C566.2813,913.4063 566.5156,913.5156 566.7344,913.5156 C567,913.5156 567.2656,913.375 567.4375,913.1563 C567.5469,913 567.5781,912.8125 567.5781,912.3906 L567.5781,910.9688 C567.5781,910.5313 567.5625,910.4063 567.4688,910.25 C567.3125,909.9844 567.0313,909.8438 566.7344,909.8438 C566.4375,909.8438 566.2344,909.9375 566.0156,910.25 L565.8438,910.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="577.5" y="919.3467">Model Manager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="549.5" x2="687.5" y1="930.5" y2="930.5"/><ellipse cx="559.5" cy="944.1484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="568.5" y="947.4951">version model</text><ellipse cx="559.5" cy="960.4453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="568.5" y="963.792">track model</text><ellipse cx="559.5" cy="976.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="568.5" y="980.0889">manage model</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="549.5" x2="687.5" y1="987.3906" y2="987.3906"/></g><g id="elem_Runner"><rect codeLine="35" fill="#E7B67E" height="64.2969" id="Runner" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="209" x="214" y="304"/><ellipse cx="288.75" cy="320" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M291.0938,315.6719 C290.1563,315.2344 289.5625,315.0938 288.6875,315.0938 C286.0625,315.0938 284.0625,317.1719 284.0625,319.8906 L284.0625,321.0156 C284.0625,323.5938 286.1719,325.4844 289.0625,325.4844 C290.2813,325.4844 291.4375,325.1875 292.1875,324.6406 C292.7656,324.2344 293.0938,323.7813 293.0938,323.3906 C293.0938,322.9375 292.7031,322.5469 292.2344,322.5469 C292.0156,322.5469 291.8125,322.625 291.625,322.8125 C291.1719,323.2969 291.1719,323.2969 290.9844,323.3906 C290.5625,323.6563 289.875,323.7813 289.1094,323.7813 C287.0625,323.7813 285.7656,322.6875 285.7656,320.9844 L285.7656,319.8906 C285.7656,318.1094 287.0156,316.7969 288.75,316.7969 C289.3281,316.7969 289.9375,316.9531 290.4063,317.2031 C290.8906,317.4844 291.0625,317.7031 291.1563,318.1094 C291.2188,318.5156 291.25,318.6406 291.3906,318.7656 C291.5313,318.9063 291.7656,319.0156 291.9844,319.0156 C292.25,319.0156 292.5156,318.875 292.6875,318.6563 C292.7969,318.5 292.8281,318.3125 292.8281,317.8906 L292.8281,316.4688 C292.8281,316.0313 292.8125,315.9063 292.7188,315.75 C292.5625,315.4844 292.2813,315.3438 291.9844,315.3438 C291.6875,315.3438 291.4844,315.4375 291.2656,315.75 L291.0938,315.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="309.25" y="324.8467">Runner</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="215" x2="422" y1="336" y2="336"/><ellipse cx="225" cy="349.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183" x="234" y="352.9951">execute task on platform</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="215" x2="422" y1="360.2969" y2="360.2969"/></g><g id="elem_Spout"><rect codeLine="39" fill="#E7B67E" height="64.2969" id="Spout" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="107" x="265" y="676"/><ellipse cx="294.4" cy="692" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M296.7438,687.6719 C295.8063,687.2344 295.2125,687.0938 294.3375,687.0938 C291.7125,687.0938 289.7125,689.1719 289.7125,691.8906 L289.7125,693.0156 C289.7125,695.5938 291.8219,697.4844 294.7125,697.4844 C295.9313,697.4844 297.0875,697.1875 297.8375,696.6406 C298.4156,696.2344 298.7438,695.7813 298.7438,695.3906 C298.7438,694.9375 298.3531,694.5469 297.8844,694.5469 C297.6656,694.5469 297.4625,694.625 297.275,694.8125 C296.8219,695.2969 296.8219,695.2969 296.6344,695.3906 C296.2125,695.6563 295.525,695.7813 294.7594,695.7813 C292.7125,695.7813 291.4156,694.6875 291.4156,692.9844 L291.4156,691.8906 C291.4156,690.1094 292.6656,688.7969 294.4,688.7969 C294.9781,688.7969 295.5875,688.9531 296.0563,689.2031 C296.5406,689.4844 296.7125,689.7031 296.8063,690.1094 C296.8688,690.5156 296.9,690.6406 297.0406,690.7656 C297.1813,690.9063 297.4156,691.0156 297.6344,691.0156 C297.9,691.0156 298.1656,690.875 298.3375,690.6563 C298.4469,690.5 298.4781,690.3125 298.4781,689.8906 L298.4781,688.4688 C298.4781,688.0313 298.4625,687.9063 298.3688,687.75 C298.2125,687.4844 297.9313,687.3438 297.6344,687.3438 C297.3375,687.3438 297.1344,687.4375 296.9156,687.75 L296.7438,687.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="311.6" y="696.8467">Spout</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="266" x2="371" y1="708" y2="708"/><ellipse cx="276" cy="721.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="285" y="724.9951">ingest data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="266" x2="371" y1="732.2969" y2="732.2969"/></g><g id="elem_Bolt"><rect codeLine="43" fill="#E7B67E" height="64.2969" id="Bolt" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="118" x="259.5" y="775"/><ellipse cx="299.7" cy="791" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M302.0438,786.6719 C301.1063,786.2344 300.5125,786.0938 299.6375,786.0938 C297.0125,786.0938 295.0125,788.1719 295.0125,790.8906 L295.0125,792.0156 C295.0125,794.5938 297.1219,796.4844 300.0125,796.4844 C301.2313,796.4844 302.3875,796.1875 303.1375,795.6406 C303.7156,795.2344 304.0438,794.7813 304.0438,794.3906 C304.0438,793.9375 303.6531,793.5469 303.1844,793.5469 C302.9656,793.5469 302.7625,793.625 302.575,793.8125 C302.1219,794.2969 302.1219,794.2969 301.9344,794.3906 C301.5125,794.6563 300.825,794.7813 300.0594,794.7813 C298.0125,794.7813 296.7156,793.6875 296.7156,791.9844 L296.7156,790.8906 C296.7156,789.1094 297.9656,787.7969 299.7,787.7969 C300.2781,787.7969 300.8875,787.9531 301.3563,788.2031 C301.8406,788.4844 302.0125,788.7031 302.1063,789.1094 C302.1688,789.5156 302.2,789.6406 302.3406,789.7656 C302.4813,789.9063 302.7156,790.0156 302.9344,790.0156 C303.2,790.0156 303.4656,789.875 303.6375,789.6563 C303.7469,789.5 303.7781,789.3125 303.7781,788.8906 L303.7781,787.4688 C303.7781,787.0313 303.7625,786.9063 303.6688,786.75 C303.5125,786.4844 303.2313,786.3438 302.9344,786.3438 C302.6375,786.3438 302.4344,786.4375 302.2156,786.75 L302.0438,786.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="319.3" y="795.8467">Bolt</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="260.5" x2="376.5" y1="807" y2="807"/><ellipse cx="270.5" cy="820.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="279.5" y="823.9951">process data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="260.5" x2="376.5" y1="831.2969" y2="831.2969"/></g><g id="elem_Local"><rect codeLine="47" fill="#E7B67E" height="64.2969" id="Local" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="132" x="552.5" y="304"/><ellipse cx="567.5" cy="320" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M569.8438,315.6719 C568.9063,315.2344 568.3125,315.0938 567.4375,315.0938 C564.8125,315.0938 562.8125,317.1719 562.8125,319.8906 L562.8125,321.0156 C562.8125,323.5938 564.9219,325.4844 567.8125,325.4844 C569.0313,325.4844 570.1875,325.1875 570.9375,324.6406 C571.5156,324.2344 571.8438,323.7813 571.8438,323.3906 C571.8438,322.9375 571.4531,322.5469 570.9844,322.5469 C570.7656,322.5469 570.5625,322.625 570.375,322.8125 C569.9219,323.2969 569.9219,323.2969 569.7344,323.3906 C569.3125,323.6563 568.625,323.7813 567.8594,323.7813 C565.8125,323.7813 564.5156,322.6875 564.5156,320.9844 L564.5156,319.8906 C564.5156,318.1094 565.7656,316.7969 567.5,316.7969 C568.0781,316.7969 568.6875,316.9531 569.1563,317.2031 C569.6406,317.4844 569.8125,317.7031 569.9063,318.1094 C569.9688,318.5156 570,318.6406 570.1406,318.7656 C570.2813,318.9063 570.5156,319.0156 570.7344,319.0156 C571,319.0156 571.2656,318.875 571.4375,318.6563 C571.5469,318.5 571.5781,318.3125 571.5781,317.8906 L571.5781,316.4688 C571.5781,316.0313 571.5625,315.9063 571.4688,315.75 C571.3125,315.4844 571.0313,315.3438 570.7344,315.3438 C570.4375,315.3438 570.2344,315.4375 570.0156,315.75 L569.8438,315.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="581.5" y="324.8467">Local Machine</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="553.5" x2="683.5" y1="336" y2="336"/><ellipse cx="563.5" cy="349.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="572.5" y="352.9951">run locally</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="553.5" x2="683.5" y1="360.2969" y2="360.2969"/></g><g id="elem_Docker"><rect codeLine="51" fill="#E7B67E" height="64.2969" id="Docker" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="139" x="549" y="403"/><ellipse cx="588.75" cy="419" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M591.0938,414.6719 C590.1563,414.2344 589.5625,414.0938 588.6875,414.0938 C586.0625,414.0938 584.0625,416.1719 584.0625,418.8906 L584.0625,420.0156 C584.0625,422.5938 586.1719,424.4844 589.0625,424.4844 C590.2813,424.4844 591.4375,424.1875 592.1875,423.6406 C592.7656,423.2344 593.0938,422.7813 593.0938,422.3906 C593.0938,421.9375 592.7031,421.5469 592.2344,421.5469 C592.0156,421.5469 591.8125,421.625 591.625,421.8125 C591.1719,422.2969 591.1719,422.2969 590.9844,422.3906 C590.5625,422.6563 589.875,422.7813 589.1094,422.7813 C587.0625,422.7813 585.7656,421.6875 585.7656,419.9844 L585.7656,418.8906 C585.7656,417.1094 587.0156,415.7969 588.75,415.7969 C589.3281,415.7969 589.9375,415.9531 590.4063,416.2031 C590.8906,416.4844 591.0625,416.7031 591.1563,417.1094 C591.2188,417.5156 591.25,417.6406 591.3906,417.7656 C591.5313,417.9063 591.7656,418.0156 591.9844,418.0156 C592.25,418.0156 592.5156,417.875 592.6875,417.6563 C592.7969,417.5 592.8281,417.3125 592.8281,416.8906 L592.8281,415.4688 C592.8281,415.0313 592.8125,414.9063 592.7188,414.75 C592.5625,414.4844 592.2813,414.3438 591.9844,414.3438 C591.6875,414.3438 591.4844,414.4375 591.2656,414.75 L591.0938,414.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="608.25" y="423.8467">Docker</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="550" x2="687" y1="435" y2="435"/><ellipse cx="560" cy="448.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="569" y="451.9951">run in container</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="550" x2="687" y1="459.2969" y2="459.2969"/></g><g id="elem_Kubernetes"><rect codeLine="55" fill="#E7B67E" height="80.5938" id="Kubernetes" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="135" x="551" y="502.5"/><ellipse cx="574.55" cy="518.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M576.8938,514.1719 C575.9563,513.7344 575.3625,513.5938 574.4875,513.5938 C571.8625,513.5938 569.8625,515.6719 569.8625,518.3906 L569.8625,519.5156 C569.8625,522.0938 571.9719,523.9844 574.8625,523.9844 C576.0813,523.9844 577.2375,523.6875 577.9875,523.1406 C578.5656,522.7344 578.8938,522.2813 578.8938,521.8906 C578.8938,521.4375 578.5031,521.0469 578.0344,521.0469 C577.8156,521.0469 577.6125,521.125 577.425,521.3125 C576.9719,521.7969 576.9719,521.7969 576.7844,521.8906 C576.3625,522.1563 575.675,522.2813 574.9094,522.2813 C572.8625,522.2813 571.5656,521.1875 571.5656,519.4844 L571.5656,518.3906 C571.5656,516.6094 572.8156,515.2969 574.55,515.2969 C575.1281,515.2969 575.7375,515.4531 576.2063,515.7031 C576.6906,515.9844 576.8625,516.2031 576.9563,516.6094 C577.0188,517.0156 577.05,517.1406 577.1906,517.2656 C577.3313,517.4063 577.5656,517.5156 577.7844,517.5156 C578.05,517.5156 578.3156,517.375 578.4875,517.1563 C578.5969,517 578.6281,516.8125 578.6281,516.3906 L578.6281,514.9688 C578.6281,514.5313 578.6125,514.4063 578.5188,514.25 C578.3625,513.9844 578.0813,513.8438 577.7844,513.8438 C577.4875,513.8438 577.2844,513.9375 577.0656,514.25 L576.8938,514.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="590.45" y="523.3467">Kubernetes</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="552" x2="685" y1="534.5" y2="534.5"/><ellipse cx="562" cy="548.1484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="571" y="551.4951">run in pod</text><ellipse cx="562" cy="564.4453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="571" y="567.792">run as a service</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="552" x2="685" y1="575.0938" y2="575.0938"/></g><g id="elem_Airflow"><rect codeLine="60" fill="#E7B67E" height="64.2969" id="Airflow" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="167" x="535" y="7"/><ellipse cx="562.15" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M564.4938,18.6719 C563.5563,18.2344 562.9625,18.0938 562.0875,18.0938 C559.4625,18.0938 557.4625,20.1719 557.4625,22.8906 L557.4625,24.0156 C557.4625,26.5938 559.5719,28.4844 562.4625,28.4844 C563.6813,28.4844 564.8375,28.1875 565.5875,27.6406 C566.1656,27.2344 566.4938,26.7813 566.4938,26.3906 C566.4938,25.9375 566.1031,25.5469 565.6344,25.5469 C565.4156,25.5469 565.2125,25.625 565.025,25.8125 C564.5719,26.2969 564.5719,26.2969 564.3844,26.3906 C563.9625,26.6563 563.275,26.7813 562.5094,26.7813 C560.4625,26.7813 559.1656,25.6875 559.1656,23.9844 L559.1656,22.8906 C559.1656,21.1094 560.4156,19.7969 562.15,19.7969 C562.7281,19.7969 563.3375,19.9531 563.8063,20.2031 C564.2906,20.4844 564.4625,20.7031 564.5563,21.1094 C564.6188,21.5156 564.65,21.6406 564.7906,21.7656 C564.9313,21.9063 565.1656,22.0156 565.3844,22.0156 C565.65,22.0156 565.9156,21.875 566.0875,21.6563 C566.1969,21.5 566.2281,21.3125 566.2281,20.8906 L566.2281,19.4688 C566.2281,19.0313 566.2125,18.9063 566.1188,18.75 C565.9625,18.4844 565.6813,18.3438 565.3844,18.3438 C565.0875,18.3438 564.8844,18.4375 564.6656,18.75 L564.4938,18.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="578.85" y="27.8467">Apache Airflow</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="536" x2="701" y1="39" y2="39"/><ellipse cx="546" cy="52.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="555" y="55.9951">create airflow tasks</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="536" x2="701" y1="63.2969" y2="63.2969"/></g><g id="elem_ECS"><rect codeLine="64" fill="#E7B67E" height="64.2969" id="ECS" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="123" x="557" y="106"/><ellipse cx="583.7" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M586.0438,117.6719 C585.1063,117.2344 584.5125,117.0938 583.6375,117.0938 C581.0125,117.0938 579.0125,119.1719 579.0125,121.8906 L579.0125,123.0156 C579.0125,125.5938 581.1219,127.4844 584.0125,127.4844 C585.2313,127.4844 586.3875,127.1875 587.1375,126.6406 C587.7156,126.2344 588.0438,125.7813 588.0438,125.3906 C588.0438,124.9375 587.6531,124.5469 587.1844,124.5469 C586.9656,124.5469 586.7625,124.625 586.575,124.8125 C586.1219,125.2969 586.1219,125.2969 585.9344,125.3906 C585.5125,125.6563 584.825,125.7813 584.0594,125.7813 C582.0125,125.7813 580.7156,124.6875 580.7156,122.9844 L580.7156,121.8906 C580.7156,120.1094 581.9656,118.7969 583.7,118.7969 C584.2781,118.7969 584.8875,118.9531 585.3563,119.2031 C585.8406,119.4844 586.0125,119.7031 586.1063,120.1094 C586.1688,120.5156 586.2,120.6406 586.3406,120.7656 C586.4813,120.9063 586.7156,121.0156 586.9344,121.0156 C587.2,121.0156 587.4656,120.875 587.6375,120.6563 C587.7469,120.5 587.7781,120.3125 587.7781,119.8906 L587.7781,118.4688 C587.7781,118.0313 587.7625,117.9063 587.6688,117.75 C587.5125,117.4844 587.2313,117.3438 586.9344,117.3438 C586.6375,117.3438 586.4344,117.4375 586.2156,117.75 L586.0438,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="600.3" y="126.8467">AWS ECS</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="558" x2="679" y1="138" y2="138"/><ellipse cx="568" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="577" y="154.9951">run as service</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="558" x2="679" y1="162.2969" y2="162.2969"/></g><g id="elem_Batch"><rect codeLine="68" fill="#E7B67E" height="64.2969" id="Batch" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="141" x="548" y="205"/><ellipse cx="576.5" cy="221" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M578.8438,216.6719 C577.9063,216.2344 577.3125,216.0938 576.4375,216.0938 C573.8125,216.0938 571.8125,218.1719 571.8125,220.8906 L571.8125,222.0156 C571.8125,224.5938 573.9219,226.4844 576.8125,226.4844 C578.0313,226.4844 579.1875,226.1875 579.9375,225.6406 C580.5156,225.2344 580.8438,224.7813 580.8438,224.3906 C580.8438,223.9375 580.4531,223.5469 579.9844,223.5469 C579.7656,223.5469 579.5625,223.625 579.375,223.8125 C578.9219,224.2969 578.9219,224.2969 578.7344,224.3906 C578.3125,224.6563 577.625,224.7813 576.8594,224.7813 C574.8125,224.7813 573.5156,223.6875 573.5156,221.9844 L573.5156,220.8906 C573.5156,219.1094 574.7656,217.7969 576.5,217.7969 C577.0781,217.7969 577.6875,217.9531 578.1563,218.2031 C578.6406,218.4844 578.8125,218.7031 578.9063,219.1094 C578.9688,219.5156 579,219.6406 579.1406,219.7656 C579.2813,219.9063 579.5156,220.0156 579.7344,220.0156 C580,220.0156 580.2656,219.875 580.4375,219.6563 C580.5469,219.5 580.5781,219.3125 580.5781,218.8906 L580.5781,217.4688 C580.5781,217.0313 580.5625,216.9063 580.4688,216.75 C580.3125,216.4844 580.0313,216.3438 579.7344,216.3438 C579.4375,216.3438 579.2344,216.4375 579.0156,216.75 L578.8438,216.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="593.5" y="225.8467">AWS Batch</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="549" x2="688" y1="237" y2="237"/><ellipse cx="559" cy="250.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="568" y="253.9951">run as batch job</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="549" x2="688" y1="261.2969" y2="261.2969"/></g><g id="elem_Jupyter"><rect codeLine="72" fill="#E7B67E" height="64.2969" id="Jupyter" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="226" x="205.5" y="874"/><ellipse cx="257.75" cy="890" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M260.0938,885.6719 C259.1563,885.2344 258.5625,885.0938 257.6875,885.0938 C255.0625,885.0938 253.0625,887.1719 253.0625,889.8906 L253.0625,891.0156 C253.0625,893.5938 255.1719,895.4844 258.0625,895.4844 C259.2813,895.4844 260.4375,895.1875 261.1875,894.6406 C261.7656,894.2344 262.0938,893.7813 262.0938,893.3906 C262.0938,892.9375 261.7031,892.5469 261.2344,892.5469 C261.0156,892.5469 260.8125,892.625 260.625,892.8125 C260.1719,893.2969 260.1719,893.2969 259.9844,893.3906 C259.5625,893.6563 258.875,893.7813 258.1094,893.7813 C256.0625,893.7813 254.7656,892.6875 254.7656,890.9844 L254.7656,889.8906 C254.7656,888.1094 256.0156,886.7969 257.75,886.7969 C258.3281,886.7969 258.9375,886.9531 259.4063,887.2031 C259.8906,887.4844 260.0625,887.7031 260.1563,888.1094 C260.2188,888.5156 260.25,888.6406 260.3906,888.7656 C260.5313,888.9063 260.7656,889.0156 260.9844,889.0156 C261.25,889.0156 261.5156,888.875 261.6875,888.6563 C261.7969,888.5 261.8281,888.3125 261.8281,887.8906 L261.8281,886.4688 C261.8281,886.0313 261.8125,885.9063 261.7188,885.75 C261.5625,885.4844 261.2813,885.3438 260.9844,885.3438 C260.6875,885.3438 260.4844,885.4375 260.2656,885.75 L260.0938,885.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="278.25" y="894.8467">Jupyter/ipython</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="206.5" x2="430.5" y1="906" y2="906"/><ellipse cx="216.5" cy="919.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200" x="225.5" y="922.9951">import into jupyter/ipython</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="206.5" x2="430.5" y1="930.2969" y2="930.2969"/></g><g id="elem_PySpark"><rect codeLine="76" fill="#E7B67E" height="80.5938" id="PySpark" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="261" x="188" y="973.5"/><ellipse cx="255.75" cy="989.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M258.0938,985.1719 C257.1563,984.7344 256.5625,984.5938 255.6875,984.5938 C253.0625,984.5938 251.0625,986.6719 251.0625,989.3906 L251.0625,990.5156 C251.0625,993.0938 253.1719,994.9844 256.0625,994.9844 C257.2813,994.9844 258.4375,994.6875 259.1875,994.1406 C259.7656,993.7344 260.0938,993.2813 260.0938,992.8906 C260.0938,992.4375 259.7031,992.0469 259.2344,992.0469 C259.0156,992.0469 258.8125,992.125 258.625,992.3125 C258.1719,992.7969 258.1719,992.7969 257.9844,992.8906 C257.5625,993.1563 256.875,993.2813 256.1094,993.2813 C254.0625,993.2813 252.7656,992.1875 252.7656,990.4844 L252.7656,989.3906 C252.7656,987.6094 254.0156,986.2969 255.75,986.2969 C256.3281,986.2969 256.9375,986.4531 257.4063,986.7031 C257.8906,986.9844 258.0625,987.2031 258.1563,987.6094 C258.2188,988.0156 258.25,988.1406 258.3906,988.2656 C258.5313,988.4063 258.7656,988.5156 258.9844,988.5156 C259.25,988.5156 259.5156,988.375 259.6875,988.1563 C259.7969,988 259.8281,987.8125 259.8281,987.3906 L259.8281,985.9688 C259.8281,985.5313 259.8125,985.4063 259.7188,985.25 C259.5625,984.9844 259.2813,984.8438 258.9844,984.8438 C258.6875,984.8438 258.4844,984.9375 258.2656,985.25 L258.0938,985.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="276.25" y="994.3467">Apache PySpark</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="189" x2="448" y1="1005.5" y2="1005.5"/><ellipse cx="199" cy="1019.1484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235" x="208" y="1022.4951">use as pyspark dataframe reader</text><ellipse cx="199" cy="1035.4453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="208" y="1038.792">use as pyspark streaming reader</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="189" x2="448" y1="1046.0938" y2="1046.0938"/></g><g id="elem_PyFlink"><rect codeLine="81" fill="#E7B67E" height="64.2969" id="PyFlink" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="192" x="222.5" y="1090"/><ellipse cx="260.45" cy="1106" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M262.7938,1101.6719 C261.8563,1101.2344 261.2625,1101.0938 260.3875,1101.0938 C257.7625,1101.0938 255.7625,1103.1719 255.7625,1105.8906 L255.7625,1107.0156 C255.7625,1109.5938 257.8719,1111.4844 260.7625,1111.4844 C261.9813,1111.4844 263.1375,1111.1875 263.8875,1110.6406 C264.4656,1110.2344 264.7938,1109.7813 264.7938,1109.3906 C264.7938,1108.9375 264.4031,1108.5469 263.9344,1108.5469 C263.7156,1108.5469 263.5125,1108.625 263.325,1108.8125 C262.8719,1109.2969 262.8719,1109.2969 262.6844,1109.3906 C262.2625,1109.6563 261.575,1109.7813 260.8094,1109.7813 C258.7625,1109.7813 257.4656,1108.6875 257.4656,1106.9844 L257.4656,1105.8906 C257.4656,1104.1094 258.7156,1102.7969 260.45,1102.7969 C261.0281,1102.7969 261.6375,1102.9531 262.1063,1103.2031 C262.5906,1103.4844 262.7625,1103.7031 262.8563,1104.1094 C262.9188,1104.5156 262.95,1104.6406 263.0906,1104.7656 C263.2313,1104.9063 263.4656,1105.0156 263.6844,1105.0156 C263.95,1105.0156 264.2156,1104.875 264.3875,1104.6563 C264.4969,1104.5 264.5281,1104.3125 264.5281,1103.8906 L264.5281,1102.4688 C264.5281,1102.0313 264.5125,1101.9063 264.4188,1101.75 C264.2625,1101.4844 263.9813,1101.3438 263.6844,1101.3438 C263.3875,1101.3438 263.1844,1101.4375 262.9656,1101.75 L262.7938,1101.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="279.55" y="1110.8467">Apache PyFlink</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="223.5" x2="413.5" y1="1122" y2="1122"/><ellipse cx="233.5" cy="1135.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="242.5" y="1138.9951">use as flink data source</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="223.5" x2="413.5" y1="1146.2969" y2="1146.2969"/></g><g id="elem_Beam"><rect codeLine="85" fill="#E7B67E" height="64.2969" id="Beam" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="209" x="214" y="1189"/><ellipse cx="264.75" cy="1205" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M267.0938,1200.6719 C266.1563,1200.2344 265.5625,1200.0938 264.6875,1200.0938 C262.0625,1200.0938 260.0625,1202.1719 260.0625,1204.8906 L260.0625,1206.0156 C260.0625,1208.5938 262.1719,1210.4844 265.0625,1210.4844 C266.2813,1210.4844 267.4375,1210.1875 268.1875,1209.6406 C268.7656,1209.2344 269.0938,1208.7813 269.0938,1208.3906 C269.0938,1207.9375 268.7031,1207.5469 268.2344,1207.5469 C268.0156,1207.5469 267.8125,1207.625 267.625,1207.8125 C267.1719,1208.2969 267.1719,1208.2969 266.9844,1208.3906 C266.5625,1208.6563 265.875,1208.7813 265.1094,1208.7813 C263.0625,1208.7813 261.7656,1207.6875 261.7656,1205.9844 L261.7656,1204.8906 C261.7656,1203.1094 263.0156,1201.7969 264.75,1201.7969 C265.3281,1201.7969 265.9375,1201.9531 266.4063,1202.2031 C266.8906,1202.4844 267.0625,1202.7031 267.1563,1203.1094 C267.2188,1203.5156 267.25,1203.6406 267.3906,1203.7656 C267.5313,1203.9063 267.7656,1204.0156 267.9844,1204.0156 C268.25,1204.0156 268.5156,1203.875 268.6875,1203.6563 C268.7969,1203.5 268.8281,1203.3125 268.8281,1202.8906 L268.8281,1201.4688 C268.8281,1201.0313 268.8125,1200.9063 268.7188,1200.75 C268.5625,1200.4844 268.2813,1200.3438 267.9844,1200.3438 C267.6875,1200.3438 267.4844,1200.4375 267.2656,1200.75 L267.0938,1200.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="285.25" y="1209.8467">Apache Beam</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="215" x2="422" y1="1221" y2="1221"/><ellipse cx="225" cy="1234.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183" x="234" y="1237.9951">use as beam components</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="215" x2="422" y1="1245.2969" y2="1245.2969"/></g><g id="elem_Storm"><rect codeLine="89" fill="#E7B67E" height="80.5938" id="Storm" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="220" x="208.5" y="1288.5"/><ellipse cx="262.75" cy="1304.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M265.0938,1300.1719 C264.1563,1299.7344 263.5625,1299.5938 262.6875,1299.5938 C260.0625,1299.5938 258.0625,1301.6719 258.0625,1304.3906 L258.0625,1305.5156 C258.0625,1308.0938 260.1719,1309.9844 263.0625,1309.9844 C264.2813,1309.9844 265.4375,1309.6875 266.1875,1309.1406 C266.7656,1308.7344 267.0938,1308.2813 267.0938,1307.8906 C267.0938,1307.4375 266.7031,1307.0469 266.2344,1307.0469 C266.0156,1307.0469 265.8125,1307.125 265.625,1307.3125 C265.1719,1307.7969 265.1719,1307.7969 264.9844,1307.8906 C264.5625,1308.1563 263.875,1308.2813 263.1094,1308.2813 C261.0625,1308.2813 259.7656,1307.1875 259.7656,1305.4844 L259.7656,1304.3906 C259.7656,1302.6094 261.0156,1301.2969 262.75,1301.2969 C263.3281,1301.2969 263.9375,1301.4531 264.4063,1301.7031 C264.8906,1301.9844 265.0625,1302.2031 265.1563,1302.6094 C265.2188,1303.0156 265.25,1303.1406 265.3906,1303.2656 C265.5313,1303.4063 265.7656,1303.5156 265.9844,1303.5156 C266.25,1303.5156 266.5156,1303.375 266.6875,1303.1563 C266.7969,1303 266.8281,1302.8125 266.8281,1302.3906 L266.8281,1300.9688 C266.8281,1300.5313 266.8125,1300.4063 266.7188,1300.25 C266.5625,1299.9844 266.2813,1299.8438 265.9844,1299.8438 C265.6875,1299.8438 265.4844,1299.9375 265.2656,1300.25 L265.0938,1300.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="283.25" y="1309.3467">Apache Storm</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="209.5" x2="427.5" y1="1320.5" y2="1320.5"/><ellipse cx="219.5" cy="1334.1484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="228.5" y="1337.4951">use spouts as storm spouts</text><ellipse cx="219.5" cy="1350.4453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="228.5" y="1353.792">use bolts as storm bolts</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="209.5" x2="427.5" y1="1361.0938" y2="1361.0938"/></g><g id="link_Task_Spout"><path codeLine="95" d="M86,927.828 C86,859.892 86,708 86,708 C86,708 178.205,708 246.868,708 " fill="none" id="Task-to-Spout" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="264.868,708,246.868,702,246.868,714,264.868,708" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Task_Bolt"><path codeLine="96" d="M107,927.926 C107,883.062 107,807 107,807 C107,807 178.735,807 241.304,807 " fill="none" id="Task-to-Bolt" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="259.304,807,241.304,801,241.304,813,259.304,807" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Bolt_SM"><path codeLine="97" d="M389.579,807 C402.803,807 401,807 401,807 C401,807 401,702.333 401,702.333 C401,702.333 486.227,702.333 549.98,702.333 " fill="none" id="Bolt-backto-SM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="377.579,807,383.579,811,389.579,807,383.579,803,377.579,807" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="379.446" y="715.3999">Uses</text></g><g id="link_Bolt_DM"><path codeLine="98" d="M389.77,791 C427.167,791 464.615,791 508.963,791 " fill="none" id="Bolt-backto-DM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="377.77,791,383.77,795,389.77,791,383.77,787,377.77,791" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="411.367" y="804.0669">Uses</text></g><g id="link_Bolt_MM"><path codeLine="99" d="M389.597,823 C420.923,823 441,823 441,823 C441,823 441,924.833 441,924.833 C441,924.833 498.733,924.833 548.347,924.833 " fill="none" id="Bolt-backto-MM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="377.597,823,383.597,827,389.597,823,383.597,819,377.597,823" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="442" y="908.9559">Uses</text></g><g id="link_Spout_SM"><path codeLine="101" d="M384.134,689.167 C433.768,689.167 495.814,689.167 549.767,689.167 " fill="none" id="Spout-backto-SM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="372.134,689.167,378.134,693.167,384.134,689.167,378.134,685.167,372.134,689.167" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="428.95" y="702.2339">Uses</text></g><g id="link_Spout_DM"><path codeLine="102" d="M384.233,723.667 C444.525,723.667 522,723.667 522,723.667 C522,723.667 522,735.631 522,750.493 " fill="none" id="Spout-backto-DM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="372.233,723.667,378.233,727.667,384.233,723.667,378.233,719.667,372.233,723.667" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="428.53" y="736.7339">Uses</text></g><g id="link_Spout_MM"><path codeLine="103" d="M384.391,731.833 C431.018,731.833 479,731.833 479,731.833 C479,731.833 479,911.667 479,911.667 C479,911.667 513.603,911.667 548.341,911.667 " fill="none" id="Spout-backto-MM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="372.391,731.833,378.391,735.833,384.391,731.833,378.391,727.833,372.391,731.833" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="447" y="816.1829">Uses</text></g><g id="link_Task_Runner"><path codeLine="105" d="M65,915.765 C65,787.987 65,336 65,336 C65,336 144.099,336 213.928,336 " fill="none" id="Task-backto-Runner" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="65,927.765,69,921.765,65,915.765,61,921.765,65,927.765" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="33" y="570.4849">Uses</text></g><g id="link_Runner_Local"><path codeLine="107" d="M441.004,346.67 C483.956,346.67 514.405,346.67 552.326,346.67 " fill="none" id="Runner-backto-Local" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="423.004,346.67,441.004,352.67,441.004,340.67,423.004,346.67" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="454.665" y="359.7369">Runs</text></g><g id="link_Runner_Docker"><path codeLine="108" d="M412,386.14 C412,415.05 412,435 412,435 C412,435 488.927,435 548.876,435 " fill="none" id="Runner-backto-Docker" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="412,368.14,406,386.14,418,386.14,412,368.14" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="414.009" y="448.0669">Runs</text></g><g id="link_Runner_Kubernetes"><path codeLine="109" d="M389,386.34 C389,444.562 389,543 389,543 C389,543 483.187,543 550.884,543 " fill="none" id="Runner-backto-Kubernetes" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="389,368.34,383,386.34,395,386.34,389,368.34" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="356" y="549.6809">Runs</text></g><g id="link_Runner_Airflow"><path codeLine="110" d="M441.052,325.33 C499.22,325.33 542,325.33 542,325.33 C542,325.33 542,145.73 542,71.01 " fill="none" id="Runner-backto-Airflow" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="423.052,325.33,441.052,331.33,441.052,319.33,423.052,325.33" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="509" y="270.7169">Runs</text></g><g id="link_Runner_ECS"><path codeLine="111" d="M284,285.75 C284,229.64 284,138 284,138 C284,138 460.106,138 556.758,138 " fill="none" id="Runner-backto-ECS" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="284,303.75,290,285.75,278,285.75,284,303.75" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="304.505" y="151.0669">Runs</text></g><g id="link_Runner_Batch"><path codeLine="112" d="M354,285.86 C354,256.95 354,237 354,237 C354,237 469.612,237 547.966,237 " fill="none" id="Runner-backto-Batch" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="354,303.86,360,285.86,348,285.86,354,303.86" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="384.554" y="250.0669">Runs</text></g><g id="link_Task_Jupyter"><path codeLine="114" d="M140.104,933 C161.958,933 177.811,933 205.425,933 " fill="none" id="Task-backto-Jupyter" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="128.104,933,134.104,937,140.104,933,134.104,929,128.104,933" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="167.765" y="946.0669">Interface</text></g><g id="link_Task_PySpark"><path codeLine="115" d="M140.104,982.75 C157.247,982.75 166.081,982.75 187.596,982.75 " fill="none" id="Task-backto-PySpark" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="128.104,982.75,134.104,986.75,140.104,982.75,134.104,978.75,128.104,982.75" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="158.85" y="978.8169">Interface</text></g><g id="link_Task_PyFlink"><path codeLine="116" d="M107,1004.006 C107,1051.218 107,1122 107,1122 C107,1122 166.472,1122 222.343,1122 " fill="none" id="Task-backto-PyFlink" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="107,992.006,103,998.006,107,1004.006,111,998.006,107,992.006" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="49" y="1127.7409">Interface</text></g><g id="link_Task_Beam"><path codeLine="117" d="M86,1004.004 C86,1073.698 86,1221 86,1221 C86,1221 152.101,1221 213.813,1221 " fill="none" id="Task-backto-Beam" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="86,992.004,82,998.004,86,1004.004,90,998.004,86,992.004" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="28" y="1183.4749">Interface</text></g><g id="link_Task_Storm"><path codeLine="118" d="M65,1004.101 C65,1093.876 65,1329 65,1329 C65,1329 140.005,1329 208.417,1329 " fill="none" id="Task-backto-Storm" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="65,992.101,61,998.101,65,1004.101,69,998.101,65,992.101" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="7" y="1245.3259">Interface</text></g></g></svg></div>

<h2 id="guides-concepts-state-managers">State Managers<a class="headerlink" href="#guides-concepts-state-managers" title="Permanent link">&para;</a></h2>
<hr />
<p><strong>State Managers</strong> play a pivotal role in maintaining the state of tasks. They ensure that the progress and status of tasks are tracked, especially in distributed environments. Geniusrise offers various types of State Managers:</p>
<ol>
<li><strong>DynamoDBStateManager</strong>: Interfaces with Amazon DynamoDB.</li>
<li><strong>InMemoryStateManager</strong>: Maintains state within the application's memory.</li>
<li><strong>PostgresStateManager</strong>: Interfaces with PostgreSQL databases.</li>
<li><strong>RedisStateManager</strong>: Interfaces with Redis in-memory data structure store.</li>
</ol>
<p>State Managers store data in various locations, allowing organizations to connect dashboards to these storage systems for real-time monitoring and analytics. This centralized storage and reporting mechanism ensures that stakeholders have a unified view of task states.</p>
<div class="puml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="375px" preserveAspectRatio="true" style="background: #ffffff" version="1.1" viewBox="0 0 604 375" width="604px" zoomAndPan="magnify"><defs/><g><rect fill="#0D0816" height="375" style="stroke:none;stroke-width:1.0;" width="604" x="0" y="0"/><g id="elem_Task"><rect codeLine="11" fill="#E7B67E" height="64.2969" id="Task" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="84" x="7" y="156"/><ellipse cx="30.55" cy="172" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M32.8938,167.6719 C31.9563,167.2344 31.3625,167.0938 30.4875,167.0938 C27.8625,167.0938 25.8625,169.1719 25.8625,171.8906 L25.8625,173.0156 C25.8625,175.5938 27.9719,177.4844 30.8625,177.4844 C32.0813,177.4844 33.2375,177.1875 33.9875,176.6406 C34.5656,176.2344 34.8938,175.7813 34.8938,175.3906 C34.8938,174.9375 34.5031,174.5469 34.0344,174.5469 C33.8156,174.5469 33.6125,174.625 33.425,174.8125 C32.9719,175.2969 32.9719,175.2969 32.7844,175.3906 C32.3625,175.6563 31.675,175.7813 30.9094,175.7813 C28.8625,175.7813 27.5656,174.6875 27.5656,172.9844 L27.5656,171.8906 C27.5656,170.1094 28.8156,168.7969 30.55,168.7969 C31.1281,168.7969 31.7375,168.9531 32.2063,169.2031 C32.6906,169.4844 32.8625,169.7031 32.9563,170.1094 C33.0188,170.5156 33.05,170.6406 33.1906,170.7656 C33.3313,170.9063 33.5656,171.0156 33.7844,171.0156 C34.05,171.0156 34.3156,170.875 34.4875,170.6563 C34.5969,170.5 34.6281,170.3125 34.6281,169.8906 L34.6281,168.4688 C34.6281,168.0313 34.6125,167.9063 34.5188,167.75 C34.3625,167.4844 34.0813,167.3438 33.7844,167.3438 C33.4875,167.3438 33.2844,167.4375 33.0656,167.75 L32.8938,167.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="46.45" y="176.8467">Task</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="188" y2="188"/><ellipse cx="18" cy="201.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="27" y="204.9951">execute</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="212.2969" y2="212.2969"/></g><g id="elem_SM"><rect codeLine="15" fill="#E7B67E" height="96.8906" id="SM" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="137" x="184" y="139.5"/><ellipse cx="199" cy="155.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M201.3438,151.1719 C200.4063,150.7344 199.8125,150.5938 198.9375,150.5938 C196.3125,150.5938 194.3125,152.6719 194.3125,155.3906 L194.3125,156.5156 C194.3125,159.0938 196.4219,160.9844 199.3125,160.9844 C200.5313,160.9844 201.6875,160.6875 202.4375,160.1406 C203.0156,159.7344 203.3438,159.2813 203.3438,158.8906 C203.3438,158.4375 202.9531,158.0469 202.4844,158.0469 C202.2656,158.0469 202.0625,158.125 201.875,158.3125 C201.4219,158.7969 201.4219,158.7969 201.2344,158.8906 C200.8125,159.1563 200.125,159.2813 199.3594,159.2813 C197.3125,159.2813 196.0156,158.1875 196.0156,156.4844 L196.0156,155.3906 C196.0156,153.6094 197.2656,152.2969 199,152.2969 C199.5781,152.2969 200.1875,152.4531 200.6563,152.7031 C201.1406,152.9844 201.3125,153.2031 201.4063,153.6094 C201.4688,154.0156 201.5,154.1406 201.6406,154.2656 C201.7813,154.4063 202.0156,154.5156 202.2344,154.5156 C202.5,154.5156 202.7656,154.375 202.9375,154.1563 C203.0469,154 203.0781,153.8125 203.0781,153.3906 L203.0781,151.9688 C203.0781,151.5313 203.0625,151.4063 202.9688,151.25 C202.8125,150.9844 202.5313,150.8438 202.2344,150.8438 C201.9375,150.8438 201.7344,150.9375 201.5156,151.25 L201.3438,151.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="213" y="160.3467">State Manager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="185" x2="320" y1="171.5" y2="171.5"/><ellipse cx="195" cy="185.1484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="204" y="188.4951">monitor state</text><ellipse cx="195" cy="201.4453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="204" y="204.792">report errors</text><ellipse cx="195" cy="217.7422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="204" y="221.0889">ship logs</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="185" x2="320" y1="228.3906" y2="228.3906"/></g><g id="elem_DynamoDB"><rect codeLine="21" fill="#E7B67E" height="64.2969" id="DynamoDB" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="213" x="383" y="7"/><ellipse cx="398" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M400.3438,18.6719 C399.4063,18.2344 398.8125,18.0938 397.9375,18.0938 C395.3125,18.0938 393.3125,20.1719 393.3125,22.8906 L393.3125,24.0156 C393.3125,26.5938 395.4219,28.4844 398.3125,28.4844 C399.5313,28.4844 400.6875,28.1875 401.4375,27.6406 C402.0156,27.2344 402.3438,26.7813 402.3438,26.3906 C402.3438,25.9375 401.9531,25.5469 401.4844,25.5469 C401.2656,25.5469 401.0625,25.625 400.875,25.8125 C400.4219,26.2969 400.4219,26.2969 400.2344,26.3906 C399.8125,26.6563 399.125,26.7813 398.3594,26.7813 C396.3125,26.7813 395.0156,25.6875 395.0156,23.9844 L395.0156,22.8906 C395.0156,21.1094 396.2656,19.7969 398,19.7969 C398.5781,19.7969 399.1875,19.9531 399.6563,20.2031 C400.1406,20.4844 400.3125,20.7031 400.4063,21.1094 C400.4688,21.5156 400.5,21.6406 400.6406,21.7656 C400.7813,21.9063 401.0156,22.0156 401.2344,22.0156 C401.5,22.0156 401.7656,21.875 401.9375,21.6563 C402.0469,21.5 402.0781,21.3125 402.0781,20.8906 L402.0781,19.4688 C402.0781,19.0313 402.0625,18.9063 401.9688,18.75 C401.8125,18.4844 401.5313,18.3438 401.2344,18.3438 C400.9375,18.3438 400.7344,18.4375 400.5156,18.75 L400.3438,18.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="412" y="27.8467">DynamoDBStateManager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="384" x2="595" y1="39" y2="39"/><ellipse cx="394" cy="52.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="403" y="55.9951">interface with DynamoDB</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="384" x2="595" y1="63.2969" y2="63.2969"/></g><g id="elem_InMemory"><rect codeLine="25" fill="#E7B67E" height="64.2969" id="InMemory" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="212" x="383.5" y="106"/><ellipse cx="402.1" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M404.4438,117.6719 C403.5063,117.2344 402.9125,117.0938 402.0375,117.0938 C399.4125,117.0938 397.4125,119.1719 397.4125,121.8906 L397.4125,123.0156 C397.4125,125.5938 399.5219,127.4844 402.4125,127.4844 C403.6313,127.4844 404.7875,127.1875 405.5375,126.6406 C406.1156,126.2344 406.4438,125.7813 406.4438,125.3906 C406.4438,124.9375 406.0531,124.5469 405.5844,124.5469 C405.3656,124.5469 405.1625,124.625 404.975,124.8125 C404.5219,125.2969 404.5219,125.2969 404.3344,125.3906 C403.9125,125.6563 403.225,125.7813 402.4594,125.7813 C400.4125,125.7813 399.1156,124.6875 399.1156,122.9844 L399.1156,121.8906 C399.1156,120.1094 400.3656,118.7969 402.1,118.7969 C402.6781,118.7969 403.2875,118.9531 403.7563,119.2031 C404.2406,119.4844 404.4125,119.7031 404.5063,120.1094 C404.5688,120.5156 404.6,120.6406 404.7406,120.7656 C404.8813,120.9063 405.1156,121.0156 405.3344,121.0156 C405.6,121.0156 405.8656,120.875 406.0375,120.6563 C406.1469,120.5 406.1781,120.3125 406.1781,119.8906 L406.1781,118.4688 C406.1781,118.0313 406.1625,117.9063 406.0688,117.75 C405.9125,117.4844 405.6313,117.3438 405.3344,117.3438 C405.0375,117.3438 404.8344,117.4375 404.6156,117.75 L404.4438,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="416.9" y="126.8467">InMemoryStateManager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="384.5" x2="594.5" y1="138" y2="138"/><ellipse cx="394.5" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="403.5" y="154.9951">maintain state in memory</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="384.5" x2="594.5" y1="162.2969" y2="162.2969"/></g><g id="elem_Postgres"><rect codeLine="29" fill="#E7B67E" height="64.2969" id="Postgres" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="215" x="382" y="205"/><ellipse cx="405.55" cy="221" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M407.8938,216.6719 C406.9563,216.2344 406.3625,216.0938 405.4875,216.0938 C402.8625,216.0938 400.8625,218.1719 400.8625,220.8906 L400.8625,222.0156 C400.8625,224.5938 402.9719,226.4844 405.8625,226.4844 C407.0813,226.4844 408.2375,226.1875 408.9875,225.6406 C409.5656,225.2344 409.8938,224.7813 409.8938,224.3906 C409.8938,223.9375 409.5031,223.5469 409.0344,223.5469 C408.8156,223.5469 408.6125,223.625 408.425,223.8125 C407.9719,224.2969 407.9719,224.2969 407.7844,224.3906 C407.3625,224.6563 406.675,224.7813 405.9094,224.7813 C403.8625,224.7813 402.5656,223.6875 402.5656,221.9844 L402.5656,220.8906 C402.5656,219.1094 403.8156,217.7969 405.55,217.7969 C406.1281,217.7969 406.7375,217.9531 407.2063,218.2031 C407.6906,218.4844 407.8625,218.7031 407.9563,219.1094 C408.0188,219.5156 408.05,219.6406 408.1906,219.7656 C408.3313,219.9063 408.5656,220.0156 408.7844,220.0156 C409.05,220.0156 409.3156,219.875 409.4875,219.6563 C409.5969,219.5 409.6281,219.3125 409.6281,218.8906 L409.6281,217.4688 C409.6281,217.0313 409.6125,216.9063 409.5188,216.75 C409.3625,216.4844 409.0813,216.3438 408.7844,216.3438 C408.4875,216.3438 408.2844,216.4375 408.0656,216.75 L407.8938,216.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="164" x="421.45" y="225.8467">PostgresStateManager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="383" x2="596" y1="237" y2="237"/><ellipse cx="393" cy="250.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="189" x="402" y="253.9951">interface with PostgreSQL</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="383" x2="596" y1="261.2969" y2="261.2969"/></g><g id="elem_Redis"><rect codeLine="33" fill="#E7B67E" height="64.2969" id="Redis" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="172" x="403.5" y="304"/><ellipse cx="418.5" cy="320" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M420.8438,315.6719 C419.9063,315.2344 419.3125,315.0938 418.4375,315.0938 C415.8125,315.0938 413.8125,317.1719 413.8125,319.8906 L413.8125,321.0156 C413.8125,323.5938 415.9219,325.4844 418.8125,325.4844 C420.0313,325.4844 421.1875,325.1875 421.9375,324.6406 C422.5156,324.2344 422.8438,323.7813 422.8438,323.3906 C422.8438,322.9375 422.4531,322.5469 421.9844,322.5469 C421.7656,322.5469 421.5625,322.625 421.375,322.8125 C420.9219,323.2969 420.9219,323.2969 420.7344,323.3906 C420.3125,323.6563 419.625,323.7813 418.8594,323.7813 C416.8125,323.7813 415.5156,322.6875 415.5156,320.9844 L415.5156,319.8906 C415.5156,318.1094 416.7656,316.7969 418.5,316.7969 C419.0781,316.7969 419.6875,316.9531 420.1563,317.2031 C420.6406,317.4844 420.8125,317.7031 420.9063,318.1094 C420.9688,318.5156 421,318.6406 421.1406,318.7656 C421.2813,318.9063 421.5156,319.0156 421.7344,319.0156 C422,319.0156 422.2656,318.875 422.4375,318.6563 C422.5469,318.5 422.5781,318.3125 422.5781,317.8906 L422.5781,316.4688 C422.5781,316.0313 422.5625,315.9063 422.4688,315.75 C422.3125,315.4844 422.0313,315.3438 421.7344,315.3438 C421.4375,315.3438 421.2344,315.4375 421.0156,315.75 L420.8438,315.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="432.5" y="324.8467">RedisStateManager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="404.5" x2="574.5" y1="336" y2="336"/><ellipse cx="414.5" cy="349.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="423.5" y="352.9951">interface with Redis</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="404.5" x2="574.5" y1="360.2969" y2="360.2969"/></g><g id="link_SM_DynamoDB"><path codeLine="37" d="M324.0357,128.2339 C345.7537,110.8249 357.242,103.053 382,88 C391.826,82.026 402.502,76.302 413.175,71.009 " fill="none" id="SM-backto-DynamoDB" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="309.991,139.492,327.7884,132.9154,320.283,123.5523,309.991,139.492" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_SM_InMemory"><path codeLine="38" d="M338.762,169.8595 C358.152,165.7345 362.159,164.881 383.24,160.396 " fill="none" id="SM-backto-InMemory" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="321.156,173.605,340.0105,175.7282,337.5135,163.9909,321.156,173.605" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_SM_Postgres"><path codeLine="39" d="M338.7771,205.781 C357.7601,209.739 361.253,210.468 381.913,214.775 " fill="none" id="SM-backto-Postgres" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="321.156,202.107,337.5524,211.6547,340.0017,199.9073,321.156,202.107" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_SM_Redis"><path codeLine="40" d="M325.9584,247.6911 C347.3434,264.3921 358.012,271.4492 382,286 C392.391,292.3031 403.705,298.3772 414.952,303.9883 " fill="none" id="SM-backto-Redis" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="311.772,236.612,322.2653,252.4199,329.6514,242.9623,311.772,236.612" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Task_SM"><path codeLine="42" d="M103.2628,188 C129.86,188 153.075,188 183.717,188 " fill="none" id="Task-backto-SM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="91.2628,188,97.2628,192,103.2628,188,97.2628,184,91.2628,188" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="122" y="184.0669">Uses</text></g></g></svg></div>

<h2 id="guides-concepts-data-managers">Data Managers<a class="headerlink" href="#guides-concepts-data-managers" title="Permanent link">&para;</a></h2>
<hr />
<p><strong>Data Managers</strong> are responsible for handling the input and output data for tasks. They implement various data operations methods that tasks can leverage to ingest or save data during their runs. Data Managers can be categorized based on their function and data processing type:</p>
<ul>
<li><strong>BatchInputConfig</strong>: Manages batch input data.</li>
<li><strong>BatchOutputConfig</strong>: Manages batch output data.</li>
<li><strong>StreamingInputConfig</strong>: Manages streaming input data.</li>
<li><strong>StreamingOutputConfig</strong>: Manages streaming output data.</li>
</ul>
<p>Data Managers play a crucial role in managing data partitioning for both batch and streaming data. By adhering to common data patterns, they enable the system's components to operate independently, fostering the creation of intricate networks of tasks. This independence, while allowing for flexibility and scalability, ensures that cascading failures in one component don't necessarily compromise the entire system.</p>
<div class="puml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="375px" preserveAspectRatio="true" style="background: #ffffff" version="1.1" viewBox="0 0 716 375" width="716px" zoomAndPan="magnify"><defs/><g><rect fill="#0D0816" height="375" style="stroke:none;stroke-width:1.0;" width="716" x="0" y="0"/><g id="elem_Task"><rect codeLine="11" fill="#E7B67E" height="64.2969" id="Task" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="84" x="7" y="156"/><ellipse cx="30.55" cy="172" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M32.8938,167.6719 C31.9563,167.2344 31.3625,167.0938 30.4875,167.0938 C27.8625,167.0938 25.8625,169.1719 25.8625,171.8906 L25.8625,173.0156 C25.8625,175.5938 27.9719,177.4844 30.8625,177.4844 C32.0813,177.4844 33.2375,177.1875 33.9875,176.6406 C34.5656,176.2344 34.8938,175.7813 34.8938,175.3906 C34.8938,174.9375 34.5031,174.5469 34.0344,174.5469 C33.8156,174.5469 33.6125,174.625 33.425,174.8125 C32.9719,175.2969 32.9719,175.2969 32.7844,175.3906 C32.3625,175.6563 31.675,175.7813 30.9094,175.7813 C28.8625,175.7813 27.5656,174.6875 27.5656,172.9844 L27.5656,171.8906 C27.5656,170.1094 28.8156,168.7969 30.55,168.7969 C31.1281,168.7969 31.7375,168.9531 32.2063,169.2031 C32.6906,169.4844 32.8625,169.7031 32.9563,170.1094 C33.0188,170.5156 33.05,170.6406 33.1906,170.7656 C33.3313,170.9063 33.5656,171.0156 33.7844,171.0156 C34.05,171.0156 34.3156,170.875 34.4875,170.6563 C34.5969,170.5 34.6281,170.3125 34.6281,169.8906 L34.6281,168.4688 C34.6281,168.0313 34.6125,167.9063 34.5188,167.75 C34.3625,167.4844 34.0813,167.3438 33.7844,167.3438 C33.4875,167.3438 33.2844,167.4375 33.0656,167.75 L32.8938,167.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="46.45" y="176.8467">Task</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="188" y2="188"/><ellipse cx="18" cy="201.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="27" y="204.9951">execute</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="212.2969" y2="212.2969"/></g><g id="elem_DM"><rect codeLine="15" fill="#E7B67E" height="64.2969" id="DM" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="215" x="184" y="156"/><ellipse cx="237.75" cy="172" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M240.0938,167.6719 C239.1563,167.2344 238.5625,167.0938 237.6875,167.0938 C235.0625,167.0938 233.0625,169.1719 233.0625,171.8906 L233.0625,173.0156 C233.0625,175.5938 235.1719,177.4844 238.0625,177.4844 C239.2813,177.4844 240.4375,177.1875 241.1875,176.6406 C241.7656,176.2344 242.0938,175.7813 242.0938,175.3906 C242.0938,174.9375 241.7031,174.5469 241.2344,174.5469 C241.0156,174.5469 240.8125,174.625 240.625,174.8125 C240.1719,175.2969 240.1719,175.2969 239.9844,175.3906 C239.5625,175.6563 238.875,175.7813 238.1094,175.7813 C236.0625,175.7813 234.7656,174.6875 234.7656,172.9844 L234.7656,171.8906 C234.7656,170.1094 236.0156,168.7969 237.75,168.7969 C238.3281,168.7969 238.9375,168.9531 239.4063,169.2031 C239.8906,169.4844 240.0625,169.7031 240.1563,170.1094 C240.2188,170.5156 240.25,170.6406 240.3906,170.7656 C240.5313,170.9063 240.7656,171.0156 240.9844,171.0156 C241.25,171.0156 241.5156,170.875 241.6875,170.6563 C241.7969,170.5 241.8281,170.3125 241.8281,169.8906 L241.8281,168.4688 C241.8281,168.0313 241.8125,167.9063 241.7188,167.75 C241.5625,167.4844 241.2813,167.3438 240.9844,167.3438 C240.6875,167.3438 240.4844,167.4375 240.2656,167.75 L240.0938,167.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="258.25" y="176.8467">Data Manager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="185" x2="398" y1="188" y2="188"/><ellipse cx="195" cy="201.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="189" x="204" y="204.9951">manage input/output data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="185" x2="398" y1="212.2969" y2="212.2969"/></g><g id="elem_BIC"><rect codeLine="19" fill="#E7B67E" height="64.2969" id="BIC" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="207" x="481" y="7"/><ellipse cx="517.6" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M519.9438,18.6719 C519.0063,18.2344 518.4125,18.0938 517.5375,18.0938 C514.9125,18.0938 512.9125,20.1719 512.9125,22.8906 L512.9125,24.0156 C512.9125,26.5938 515.0219,28.4844 517.9125,28.4844 C519.1313,28.4844 520.2875,28.1875 521.0375,27.6406 C521.6156,27.2344 521.9438,26.7813 521.9438,26.3906 C521.9438,25.9375 521.5531,25.5469 521.0844,25.5469 C520.8656,25.5469 520.6625,25.625 520.475,25.8125 C520.0219,26.2969 520.0219,26.2969 519.8344,26.3906 C519.4125,26.6563 518.725,26.7813 517.9594,26.7813 C515.9125,26.7813 514.6156,25.6875 514.6156,23.9844 L514.6156,22.8906 C514.6156,21.1094 515.8656,19.7969 517.6,19.7969 C518.1781,19.7969 518.7875,19.9531 519.2563,20.2031 C519.7406,20.4844 519.9125,20.7031 520.0063,21.1094 C520.0688,21.5156 520.1,21.6406 520.2406,21.7656 C520.3813,21.9063 520.6156,22.0156 520.8344,22.0156 C521.1,22.0156 521.3656,21.875 521.5375,21.6563 C521.6469,21.5 521.6781,21.3125 521.6781,20.8906 L521.6781,19.4688 C521.6781,19.0313 521.6625,18.9063 521.5688,18.75 C521.4125,18.4844 521.1313,18.3438 520.8344,18.3438 C520.5375,18.3438 520.3344,18.4375 520.1156,18.75 L519.9438,18.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="536.4" y="27.8467">BatchInputConfig</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="482" x2="687" y1="39" y2="39"/><ellipse cx="492" cy="52.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="501" y="55.9951">manage batch input data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="482" x2="687" y1="63.2969" y2="63.2969"/></g><g id="elem_BOC"><rect codeLine="23" fill="#E7B67E" height="64.2969" id="BOC" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="218" x="475.5" y="106"/><ellipse cx="511.2" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M513.5438,117.6719 C512.6063,117.2344 512.0125,117.0938 511.1375,117.0938 C508.5125,117.0938 506.5125,119.1719 506.5125,121.8906 L506.5125,123.0156 C506.5125,125.5938 508.6219,127.4844 511.5125,127.4844 C512.7313,127.4844 513.8875,127.1875 514.6375,126.6406 C515.2156,126.2344 515.5438,125.7813 515.5438,125.3906 C515.5438,124.9375 515.1531,124.5469 514.6844,124.5469 C514.4656,124.5469 514.2625,124.625 514.075,124.8125 C513.6219,125.2969 513.6219,125.2969 513.4344,125.3906 C513.0125,125.6563 512.325,125.7813 511.5594,125.7813 C509.5125,125.7813 508.2156,124.6875 508.2156,122.9844 L508.2156,121.8906 C508.2156,120.1094 509.4656,118.7969 511.2,118.7969 C511.7781,118.7969 512.3875,118.9531 512.8563,119.2031 C513.3406,119.4844 513.5125,119.7031 513.6063,120.1094 C513.6688,120.5156 513.7,120.6406 513.8406,120.7656 C513.9813,120.9063 514.2156,121.0156 514.4344,121.0156 C514.7,121.0156 514.9656,120.875 515.1375,120.6563 C515.2469,120.5 515.2781,120.3125 515.2781,119.8906 L515.2781,118.4688 C515.2781,118.0313 515.2625,117.9063 515.1688,117.75 C515.0125,117.4844 514.7313,117.3438 514.4344,117.3438 C514.1375,117.3438 513.9344,117.4375 513.7156,117.75 L513.5438,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="529.8" y="126.8467">BatchOutputConfig</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="476.5" x2="692.5" y1="138" y2="138"/><ellipse cx="486.5" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="495.5" y="154.9951">manage batch output data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="476.5" x2="692.5" y1="162.2969" y2="162.2969"/></g><g id="elem_SIC"><rect codeLine="27" fill="#E7B67E" height="64.2969" id="SIC" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="238" x="465.5" y="205"/><ellipse cx="501.2" cy="221" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M503.5438,216.6719 C502.6063,216.2344 502.0125,216.0938 501.1375,216.0938 C498.5125,216.0938 496.5125,218.1719 496.5125,220.8906 L496.5125,222.0156 C496.5125,224.5938 498.6219,226.4844 501.5125,226.4844 C502.7313,226.4844 503.8875,226.1875 504.6375,225.6406 C505.2156,225.2344 505.5438,224.7813 505.5438,224.3906 C505.5438,223.9375 505.1531,223.5469 504.6844,223.5469 C504.4656,223.5469 504.2625,223.625 504.075,223.8125 C503.6219,224.2969 503.6219,224.2969 503.4344,224.3906 C503.0125,224.6563 502.325,224.7813 501.5594,224.7813 C499.5125,224.7813 498.2156,223.6875 498.2156,221.9844 L498.2156,220.8906 C498.2156,219.1094 499.4656,217.7969 501.2,217.7969 C501.7781,217.7969 502.3875,217.9531 502.8563,218.2031 C503.3406,218.4844 503.5125,218.7031 503.6063,219.1094 C503.6688,219.5156 503.7,219.6406 503.8406,219.7656 C503.9813,219.9063 504.2156,220.0156 504.4344,220.0156 C504.7,220.0156 504.9656,219.875 505.1375,219.6563 C505.2469,219.5 505.2781,219.3125 505.2781,218.8906 L505.2781,217.4688 C505.2781,217.0313 505.2625,216.9063 505.1688,216.75 C505.0125,216.4844 504.7313,216.3438 504.4344,216.3438 C504.1375,216.3438 503.9344,216.4375 503.7156,216.75 L503.5438,216.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="519.8" y="225.8467">StreamingInputConfig</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="466.5" x2="702.5" y1="237" y2="237"/><ellipse cx="476.5" cy="250.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="485.5" y="253.9951">manage streaming input data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="466.5" x2="702.5" y1="261.2969" y2="261.2969"/></g><g id="elem_SOC"><rect codeLine="31" fill="#E7B67E" height="64.2969" id="SOC" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="249" x="460" y="304"/><ellipse cx="494.8" cy="320" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M497.1438,315.6719 C496.2063,315.2344 495.6125,315.0938 494.7375,315.0938 C492.1125,315.0938 490.1125,317.1719 490.1125,319.8906 L490.1125,321.0156 C490.1125,323.5938 492.2219,325.4844 495.1125,325.4844 C496.3313,325.4844 497.4875,325.1875 498.2375,324.6406 C498.8156,324.2344 499.1438,323.7813 499.1438,323.3906 C499.1438,322.9375 498.7531,322.5469 498.2844,322.5469 C498.0656,322.5469 497.8625,322.625 497.675,322.8125 C497.2219,323.2969 497.2219,323.2969 497.0344,323.3906 C496.6125,323.6563 495.925,323.7813 495.1594,323.7813 C493.1125,323.7813 491.8156,322.6875 491.8156,320.9844 L491.8156,319.8906 C491.8156,318.1094 493.0656,316.7969 494.8,316.7969 C495.3781,316.7969 495.9875,316.9531 496.4563,317.2031 C496.9406,317.4844 497.1125,317.7031 497.2063,318.1094 C497.2688,318.5156 497.3,318.6406 497.4406,318.7656 C497.5813,318.9063 497.8156,319.0156 498.0344,319.0156 C498.3,319.0156 498.5656,318.875 498.7375,318.6563 C498.8469,318.5 498.8781,318.3125 498.8781,317.8906 L498.8781,316.4688 C498.8781,316.0313 498.8625,315.9063 498.7688,315.75 C498.6125,315.4844 498.3313,315.3438 498.0344,315.3438 C497.7375,315.3438 497.5344,315.4375 497.3156,315.75 L497.1438,315.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="173" x="513.2" y="324.8467">StreamingOutputConfig</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="461" x2="708" y1="336" y2="336"/><ellipse cx="471" cy="349.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="223" x="480" y="352.9951">manage streaming output data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="461" x2="708" y1="360.2969" y2="360.2969"/></g><g id="link_DM_BIC"><path codeLine="35" d="M356.7457,146.2465 C389.5317,125.4865 418.838,108.29 460,88 C471.897,82.136 484.68,76.434 497.351,71.117 " fill="none" id="DM-backto-BIC" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="341.538,155.876,359.9555,151.3158,353.5359,141.1773,341.538,155.876" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_DM_BOC"><path codeLine="36" d="M416.945,166.6174 C441.763,162.3524 450.466,160.858 475.346,156.583 " fill="none" id="DM-backto-BOC" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="399.205,169.666,417.9612,172.5307,415.9287,160.7041,399.205,169.666" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_DM_SIC"><path codeLine="37" d="M416.9552,208.9565 C438.3672,212.5615 443.238,213.382 465.021,217.05 " fill="none" id="DM-backto-SIC" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="399.205,205.968,415.959,214.8732,417.9513,203.0398,399.205,205.968" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_DM_SOC"><path codeLine="38" d="M358.4542,229.6519 C391.1462,249.7969 419.638,266.152 460,286 C472.558,292.1756 486.078,298.2248 499.404,303.8625 " fill="none" id="DM-backto-SOC" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="343.13,220.209,355.3066,234.76,361.6019,224.5438,343.13,220.209" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Task_DM"><path codeLine="40" d="M103.0702,188 C128.695,188 150.954,188 183.84,188 " fill="none" id="Task-backto-DM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="91.0702,188,97.0702,192,103.0702,188,97.0702,184,91.0702,188" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="122" y="184.0669">Uses</text></g></g></svg></div>

<h2 id="guides-concepts-model-managers">Model Managers<a class="headerlink" href="#guides-concepts-model-managers" title="Permanent link">&para;</a></h2>
<hr />
<p><strong>Model Managers</strong> oversee model operations, ensuring that models are saved, loaded, and managed efficiently. They can be of two primary types:</p>
<ol>
<li><strong>S3ModelManager</strong>: Interfaces with Amazon S3 for model storage.</li>
<li><strong>WANDBModelManager</strong>: Interfaces with Weights &amp; Biases for model versioning.</li>
<li><strong>GitModelManager</strong>: Interfaces with Git repositories for versioning of models.</li>
</ol>
<div class="puml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="276px" preserveAspectRatio="true" style="background: #ffffff" version="1.1" viewBox="0 0 646 276" width="646px" zoomAndPan="magnify"><defs/><g><rect fill="#0D0816" height="276" style="stroke:none;stroke-width:1.0;" width="646" x="0" y="0"/><g id="elem_Task"><rect codeLine="11" fill="#E7B67E" height="64.2969" id="Task" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="84" x="7" y="106"/><ellipse cx="30.55" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M32.8938,117.6719 C31.9563,117.2344 31.3625,117.0938 30.4875,117.0938 C27.8625,117.0938 25.8625,119.1719 25.8625,121.8906 L25.8625,123.0156 C25.8625,125.5938 27.9719,127.4844 30.8625,127.4844 C32.0813,127.4844 33.2375,127.1875 33.9875,126.6406 C34.5656,126.2344 34.8938,125.7813 34.8938,125.3906 C34.8938,124.9375 34.5031,124.5469 34.0344,124.5469 C33.8156,124.5469 33.6125,124.625 33.425,124.8125 C32.9719,125.2969 32.9719,125.2969 32.7844,125.3906 C32.3625,125.6563 31.675,125.7813 30.9094,125.7813 C28.8625,125.7813 27.5656,124.6875 27.5656,122.9844 L27.5656,121.8906 C27.5656,120.1094 28.8156,118.7969 30.55,118.7969 C31.1281,118.7969 31.7375,118.9531 32.2063,119.2031 C32.6906,119.4844 32.8625,119.7031 32.9563,120.1094 C33.0188,120.5156 33.05,120.6406 33.1906,120.7656 C33.3313,120.9063 33.5656,121.0156 33.7844,121.0156 C34.05,121.0156 34.3156,120.875 34.4875,120.6563 C34.5969,120.5 34.6281,120.3125 34.6281,119.8906 L34.6281,118.4688 C34.6281,118.0313 34.6125,117.9063 34.5188,117.75 C34.3625,117.4844 34.0813,117.3438 33.7844,117.3438 C33.4875,117.3438 33.2844,117.4375 33.0656,117.75 L32.8938,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="46.45" y="126.8467">Task</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="138" y2="138"/><ellipse cx="18" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="27" y="154.9951">execute</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="162.2969" y2="162.2969"/></g><g id="elem_MM"><rect codeLine="15" fill="#E7B67E" height="64.2969" id="MM" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="140" x="184" y="106"/><ellipse cx="199" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M201.3438,117.6719 C200.4063,117.2344 199.8125,117.0938 198.9375,117.0938 C196.3125,117.0938 194.3125,119.1719 194.3125,121.8906 L194.3125,123.0156 C194.3125,125.5938 196.4219,127.4844 199.3125,127.4844 C200.5313,127.4844 201.6875,127.1875 202.4375,126.6406 C203.0156,126.2344 203.3438,125.7813 203.3438,125.3906 C203.3438,124.9375 202.9531,124.5469 202.4844,124.5469 C202.2656,124.5469 202.0625,124.625 201.875,124.8125 C201.4219,125.2969 201.4219,125.2969 201.2344,125.3906 C200.8125,125.6563 200.125,125.7813 199.3594,125.7813 C197.3125,125.7813 196.0156,124.6875 196.0156,122.9844 L196.0156,121.8906 C196.0156,120.1094 197.2656,118.7969 199,118.7969 C199.5781,118.7969 200.1875,118.9531 200.6563,119.2031 C201.1406,119.4844 201.3125,119.7031 201.4063,120.1094 C201.4688,120.5156 201.5,120.6406 201.6406,120.7656 C201.7813,120.9063 202.0156,121.0156 202.2344,121.0156 C202.5,121.0156 202.7656,120.875 202.9375,120.6563 C203.0469,120.5 203.0781,120.3125 203.0781,119.8906 L203.0781,118.4688 C203.0781,118.0313 203.0625,117.9063 202.9688,117.75 C202.8125,117.4844 202.5313,117.3438 202.2344,117.3438 C201.9375,117.3438 201.7344,117.4375 201.5156,117.75 L201.3438,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="213" y="126.8467">Model Manager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="185" x2="323" y1="138" y2="138"/><ellipse cx="195" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="204" y="154.9951">manage model</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="185" x2="323" y1="162.2969" y2="162.2969"/></g><g id="elem_S3"><rect codeLine="19" fill="#E7B67E" height="64.2969" id="S3" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="211" x="406.5" y="7"/><ellipse cx="447.15" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M449.4938,18.6719 C448.5563,18.2344 447.9625,18.0938 447.0875,18.0938 C444.4625,18.0938 442.4625,20.1719 442.4625,22.8906 L442.4625,24.0156 C442.4625,26.5938 444.5719,28.4844 447.4625,28.4844 C448.6813,28.4844 449.8375,28.1875 450.5875,27.6406 C451.1656,27.2344 451.4938,26.7813 451.4938,26.3906 C451.4938,25.9375 451.1031,25.5469 450.6344,25.5469 C450.4156,25.5469 450.2125,25.625 450.025,25.8125 C449.5719,26.2969 449.5719,26.2969 449.3844,26.3906 C448.9625,26.6563 448.275,26.7813 447.5094,26.7813 C445.4625,26.7813 444.1656,25.6875 444.1656,23.9844 L444.1656,22.8906 C444.1656,21.1094 445.4156,19.7969 447.15,19.7969 C447.7281,19.7969 448.3375,19.9531 448.8063,20.2031 C449.2906,20.4844 449.4625,20.7031 449.5563,21.1094 C449.6188,21.5156 449.65,21.6406 449.7906,21.7656 C449.9313,21.9063 450.1656,22.0156 450.3844,22.0156 C450.65,22.0156 450.9156,21.875 451.0875,21.6563 C451.1969,21.5 451.2281,21.3125 451.2281,20.8906 L451.2281,19.4688 C451.2281,19.0313 451.2125,18.9063 451.1188,18.75 C450.9625,18.4844 450.6813,18.3438 450.3844,18.3438 C450.0875,18.3438 449.8844,18.4375 449.6656,18.75 L449.4938,18.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="466.85" y="27.8467">S3ModelManager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="407.5" x2="616.5" y1="39" y2="39"/><ellipse cx="417.5" cy="52.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="426.5" y="55.9951">interface with Amazon S3</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="407.5" x2="616.5" y1="63.2969" y2="63.2969"/></g><g id="elem_WANDB"><rect codeLine="23" fill="#E7B67E" height="64.2969" id="WANDB" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="254" x="385" y="106"/><ellipse cx="428.35" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M430.6938,117.6719 C429.7563,117.2344 429.1625,117.0938 428.2875,117.0938 C425.6625,117.0938 423.6625,119.1719 423.6625,121.8906 L423.6625,123.0156 C423.6625,125.5938 425.7719,127.4844 428.6625,127.4844 C429.8813,127.4844 431.0375,127.1875 431.7875,126.6406 C432.3656,126.2344 432.6938,125.7813 432.6938,125.3906 C432.6938,124.9375 432.3031,124.5469 431.8344,124.5469 C431.6156,124.5469 431.4125,124.625 431.225,124.8125 C430.7719,125.2969 430.7719,125.2969 430.5844,125.3906 C430.1625,125.6563 429.475,125.7813 428.7094,125.7813 C426.6625,125.7813 425.3656,124.6875 425.3656,122.9844 L425.3656,121.8906 C425.3656,120.1094 426.6156,118.7969 428.35,118.7969 C428.9281,118.7969 429.5375,118.9531 430.0063,119.2031 C430.4906,119.4844 430.6625,119.7031 430.7563,120.1094 C430.8188,120.5156 430.85,120.6406 430.9906,120.7656 C431.1313,120.9063 431.3656,121.0156 431.5844,121.0156 C431.85,121.0156 432.1156,120.875 432.2875,120.6563 C432.3969,120.5 432.4281,120.3125 432.4281,119.8906 L432.4281,118.4688 C432.4281,118.0313 432.4125,117.9063 432.3188,117.75 C432.1625,117.4844 431.8813,117.3438 431.5844,117.3438 C431.2875,117.3438 431.0844,117.4375 430.8656,117.75 L430.6938,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="448.65" y="126.8467">WANDBModelManager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="386" x2="638" y1="138" y2="138"/><ellipse cx="396" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="228" x="405" y="154.9951">interface with Weights &amp; Biases</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="386" x2="638" y1="162.2969" y2="162.2969"/></g><g id="elem_Git"><rect codeLine="27" fill="#E7B67E" height="64.2969" id="Git" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="236" x="394" y="205"/><ellipse cx="444.75" cy="221" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M447.0938,216.6719 C446.1563,216.2344 445.5625,216.0938 444.6875,216.0938 C442.0625,216.0938 440.0625,218.1719 440.0625,220.8906 L440.0625,222.0156 C440.0625,224.5938 442.1719,226.4844 445.0625,226.4844 C446.2813,226.4844 447.4375,226.1875 448.1875,225.6406 C448.7656,225.2344 449.0938,224.7813 449.0938,224.3906 C449.0938,223.9375 448.7031,223.5469 448.2344,223.5469 C448.0156,223.5469 447.8125,223.625 447.625,223.8125 C447.1719,224.2969 447.1719,224.2969 446.9844,224.3906 C446.5625,224.6563 445.875,224.7813 445.1094,224.7813 C443.0625,224.7813 441.7656,223.6875 441.7656,221.9844 L441.7656,220.8906 C441.7656,219.1094 443.0156,217.7969 444.75,217.7969 C445.3281,217.7969 445.9375,217.9531 446.4063,218.2031 C446.8906,218.4844 447.0625,218.7031 447.1563,219.1094 C447.2188,219.5156 447.25,219.6406 447.3906,219.7656 C447.5313,219.9063 447.7656,220.0156 447.9844,220.0156 C448.25,220.0156 448.5156,219.875 448.6875,219.6563 C448.7969,219.5 448.8281,219.3125 448.8281,218.8906 L448.8281,217.4688 C448.8281,217.0313 448.8125,216.9063 448.7188,216.75 C448.5625,216.4844 448.2813,216.3438 447.9844,216.3438 C447.6875,216.3438 447.4844,216.4375 447.2656,216.75 L447.0938,216.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="465.25" y="225.8467">GitModelManager</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="395" x2="629" y1="237" y2="237"/><ellipse cx="405" cy="250.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210" x="414" y="253.9951">manage model versions in git</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="395" x2="629" y1="261.2969" y2="261.2969"/></g><g id="link_MM_S3"><path codeLine="31" d="M341.0654,104.7167 C373.0504,92.3477 394.492,84.056 428.006,71.095 " fill="none" id="MM-backto-S3" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="324.277,111.209,343.2295,110.3128,338.9013,99.1206,324.277,111.209" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_MM_WANDB"><path codeLine="32" d="M342.277,138 C361.083,138 364.048,138 384.944,138 " fill="none" id="MM-backto-WANDB" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="324.277,138,342.277,144,342.277,132,324.277,138" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_MM_Git"><path codeLine="33" d="M341.0654,171.2832 C373.0504,183.6521 394.492,191.9442 428.006,204.9045 " fill="none" id="MM-backto-Git" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="324.277,164.791,338.9013,176.8794,343.2295,165.6871,324.277,164.791" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Task_MM"><path codeLine="35" d="M103.0801,138 C129.726,138 153.108,138 183.999,138 " fill="none" id="Task-backto-MM" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="91.0801,138,97.0801,142,103.0801,138,97.0801,134,91.0801,138" style="stroke:#93A1A1;stroke-width:1.0;"/><text fill="#93A1A1" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="122" y="134.0669">Uses</text></g></g></svg></div>

<h2 id="guides-concepts-spouts-and-bolts">Spouts and Bolts<a class="headerlink" href="#guides-concepts-spouts-and-bolts" title="Permanent link">&para;</a></h2>
<hr />
<p>At the heart of the Geniusrise framework are two primary component types: <strong>spouts</strong> and <strong>bolts</strong>.</p>
<ul>
<li>
<p><strong>Spouts</strong>: These are tasks responsible for ingesting data from various sources. Depending on the output type, spouts can either produce streaming output or batch output.</p>
</li>
<li>
<p><strong>Bolts</strong>: Bolts are tasks that take in data, process it, and produce output. They can be categorized based on their input and output types:</p>
</li>
<li>Stream-Stream: Reads streaming data and produces streaming output.</li>
<li>Stream-Batch: Reads streaming data and produces batch output.</li>
<li>Batch-Stream: Reads batch data and produces streaming output.</li>
<li>Batch-Batch: Reads batch data and produces batch output.</li>
</ul>
<div class="puml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="573px" preserveAspectRatio="true" style="background: #ffffff" version="1.1" viewBox="0 0 631 573" width="631px" zoomAndPan="magnify"><defs/><g><rect fill="#0D0816" height="573" style="stroke:none;stroke-width:1.0;" width="631" x="0" y="0"/><g id="elem_Task"><rect codeLine="11" fill="#E7B67E" height="64.2969" id="Task" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="84" x="7" y="205"/><ellipse cx="30.55" cy="221" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M32.8938,216.6719 C31.9563,216.2344 31.3625,216.0938 30.4875,216.0938 C27.8625,216.0938 25.8625,218.1719 25.8625,220.8906 L25.8625,222.0156 C25.8625,224.5938 27.9719,226.4844 30.8625,226.4844 C32.0813,226.4844 33.2375,226.1875 33.9875,225.6406 C34.5656,225.2344 34.8938,224.7813 34.8938,224.3906 C34.8938,223.9375 34.5031,223.5469 34.0344,223.5469 C33.8156,223.5469 33.6125,223.625 33.425,223.8125 C32.9719,224.2969 32.9719,224.2969 32.7844,224.3906 C32.3625,224.6563 31.675,224.7813 30.9094,224.7813 C28.8625,224.7813 27.5656,223.6875 27.5656,221.9844 L27.5656,220.8906 C27.5656,219.1094 28.8156,217.7969 30.55,217.7969 C31.1281,217.7969 31.7375,217.9531 32.2063,218.2031 C32.6906,218.4844 32.8625,218.7031 32.9563,219.1094 C33.0188,219.5156 33.05,219.6406 33.1906,219.7656 C33.3313,219.9063 33.5656,220.0156 33.7844,220.0156 C34.05,220.0156 34.3156,219.875 34.4875,219.6563 C34.5969,219.5 34.6281,219.3125 34.6281,218.8906 L34.6281,217.4688 C34.6281,217.0313 34.6125,216.9063 34.5188,216.75 C34.3625,216.4844 34.0813,216.3438 33.7844,216.3438 C33.4875,216.3438 33.2844,216.4375 33.0656,216.75 L32.8938,216.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="46.45" y="225.8467">Task</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="237" y2="237"/><ellipse cx="18" cy="250.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="27" y="253.9951">execute</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="8" x2="90" y1="261.2969" y2="261.2969"/></g><g id="elem_Spout"><rect codeLine="15" fill="#E7B67E" height="64.2969" id="Spout" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="107" x="156.5" y="106"/><ellipse cx="185.9" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M188.2438,117.6719 C187.3063,117.2344 186.7125,117.0938 185.8375,117.0938 C183.2125,117.0938 181.2125,119.1719 181.2125,121.8906 L181.2125,123.0156 C181.2125,125.5938 183.3219,127.4844 186.2125,127.4844 C187.4313,127.4844 188.5875,127.1875 189.3375,126.6406 C189.9156,126.2344 190.2438,125.7813 190.2438,125.3906 C190.2438,124.9375 189.8531,124.5469 189.3844,124.5469 C189.1656,124.5469 188.9625,124.625 188.775,124.8125 C188.3219,125.2969 188.3219,125.2969 188.1344,125.3906 C187.7125,125.6563 187.025,125.7813 186.2594,125.7813 C184.2125,125.7813 182.9156,124.6875 182.9156,122.9844 L182.9156,121.8906 C182.9156,120.1094 184.1656,118.7969 185.9,118.7969 C186.4781,118.7969 187.0875,118.9531 187.5563,119.2031 C188.0406,119.4844 188.2125,119.7031 188.3063,120.1094 C188.3688,120.5156 188.4,120.6406 188.5406,120.7656 C188.6813,120.9063 188.9156,121.0156 189.1344,121.0156 C189.4,121.0156 189.6656,120.875 189.8375,120.6563 C189.9469,120.5 189.9781,120.3125 189.9781,119.8906 L189.9781,118.4688 C189.9781,118.0313 189.9625,117.9063 189.8688,117.75 C189.7125,117.4844 189.4313,117.3438 189.1344,117.3438 C188.8375,117.3438 188.6344,117.4375 188.4156,117.75 L188.2438,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="203.1" y="126.8467">Spout</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="157.5" x2="262.5" y1="138" y2="138"/><ellipse cx="167.5" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="176.5" y="154.9951">ingest data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="157.5" x2="262.5" y1="162.2969" y2="162.2969"/></g><g id="elem_Bolt"><rect codeLine="19" fill="#E7B67E" height="64.2969" id="Bolt" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="118" x="151" y="304"/><ellipse cx="191.2" cy="320" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M193.5438,315.6719 C192.6063,315.2344 192.0125,315.0938 191.1375,315.0938 C188.5125,315.0938 186.5125,317.1719 186.5125,319.8906 L186.5125,321.0156 C186.5125,323.5938 188.6219,325.4844 191.5125,325.4844 C192.7313,325.4844 193.8875,325.1875 194.6375,324.6406 C195.2156,324.2344 195.5438,323.7813 195.5438,323.3906 C195.5438,322.9375 195.1531,322.5469 194.6844,322.5469 C194.4656,322.5469 194.2625,322.625 194.075,322.8125 C193.6219,323.2969 193.6219,323.2969 193.4344,323.3906 C193.0125,323.6563 192.325,323.7813 191.5594,323.7813 C189.5125,323.7813 188.2156,322.6875 188.2156,320.9844 L188.2156,319.8906 C188.2156,318.1094 189.4656,316.7969 191.2,316.7969 C191.7781,316.7969 192.3875,316.9531 192.8563,317.2031 C193.3406,317.4844 193.5125,317.7031 193.6063,318.1094 C193.6688,318.5156 193.7,318.6406 193.8406,318.7656 C193.9813,318.9063 194.2156,319.0156 194.4344,319.0156 C194.7,319.0156 194.9656,318.875 195.1375,318.6563 C195.2469,318.5 195.2781,318.3125 195.2781,317.8906 L195.2781,316.4688 C195.2781,316.0313 195.2625,315.9063 195.1688,315.75 C195.0125,315.4844 194.7313,315.3438 194.4344,315.3438 C194.1375,315.3438 193.9344,315.4375 193.7156,315.75 L193.5438,315.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="210.8" y="324.8467">Bolt</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="152" x2="268" y1="336" y2="336"/><ellipse cx="162" cy="349.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="171" y="352.9951">process data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="152" x2="268" y1="360.2969" y2="360.2969"/></g><g id="elem_S"><rect codeLine="23" fill="#E7B67E" height="64.2969" id="S" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="198" x="377.5" y="7"/><ellipse cx="445.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M448.0938,18.6719 C447.1563,18.2344 446.5625,18.0938 445.6875,18.0938 C443.0625,18.0938 441.0625,20.1719 441.0625,22.8906 L441.0625,24.0156 C441.0625,26.5938 443.1719,28.4844 446.0625,28.4844 C447.2813,28.4844 448.4375,28.1875 449.1875,27.6406 C449.7656,27.2344 450.0938,26.7813 450.0938,26.3906 C450.0938,25.9375 449.7031,25.5469 449.2344,25.5469 C449.0156,25.5469 448.8125,25.625 448.625,25.8125 C448.1719,26.2969 448.1719,26.2969 447.9844,26.3906 C447.5625,26.6563 446.875,26.7813 446.1094,26.7813 C444.0625,26.7813 442.7656,25.6875 442.7656,23.9844 L442.7656,22.8906 C442.7656,21.1094 444.0156,19.7969 445.75,19.7969 C446.3281,19.7969 446.9375,19.9531 447.4063,20.2031 C447.8906,20.4844 448.0625,20.7031 448.1563,21.1094 C448.2188,21.5156 448.25,21.6406 448.3906,21.7656 C448.5313,21.9063 448.7656,22.0156 448.9844,22.0156 C449.25,22.0156 449.5156,21.875 449.6875,21.6563 C449.7969,21.5 449.8281,21.3125 449.8281,20.8906 L449.8281,19.4688 C449.8281,19.0313 449.8125,18.9063 449.7188,18.75 C449.5625,18.4844 449.2813,18.3438 448.9844,18.3438 C448.6875,18.3438 448.4844,18.4375 448.2656,18.75 L448.0938,18.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="466.25" y="27.8467">Stream</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="378.5" x2="574.5" y1="39" y2="39"/><ellipse cx="388.5" cy="52.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="397.5" y="55.9951">produce streaming data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="378.5" x2="574.5" y1="63.2969" y2="63.2969"/></g><g id="elem_B"><rect codeLine="27" fill="#E7B67E" height="64.2969" id="B" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="167" x="393" y="106"/><ellipse cx="451.25" cy="122" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M453.5938,117.6719 C452.6563,117.2344 452.0625,117.0938 451.1875,117.0938 C448.5625,117.0938 446.5625,119.1719 446.5625,121.8906 L446.5625,123.0156 C446.5625,125.5938 448.6719,127.4844 451.5625,127.4844 C452.7813,127.4844 453.9375,127.1875 454.6875,126.6406 C455.2656,126.2344 455.5938,125.7813 455.5938,125.3906 C455.5938,124.9375 455.2031,124.5469 454.7344,124.5469 C454.5156,124.5469 454.3125,124.625 454.125,124.8125 C453.6719,125.2969 453.6719,125.2969 453.4844,125.3906 C453.0625,125.6563 452.375,125.7813 451.6094,125.7813 C449.5625,125.7813 448.2656,124.6875 448.2656,122.9844 L448.2656,121.8906 C448.2656,120.1094 449.5156,118.7969 451.25,118.7969 C451.8281,118.7969 452.4375,118.9531 452.9063,119.2031 C453.3906,119.4844 453.5625,119.7031 453.6563,120.1094 C453.7188,120.5156 453.75,120.6406 453.8906,120.7656 C454.0313,120.9063 454.2656,121.0156 454.4844,121.0156 C454.75,121.0156 455.0156,120.875 455.1875,120.6563 C455.2969,120.5 455.3281,120.3125 455.3281,119.8906 L455.3281,118.4688 C455.3281,118.0313 455.3125,117.9063 455.2188,117.75 C455.0625,117.4844 454.7813,117.3438 454.4844,117.3438 C454.1875,117.3438 453.9844,117.4375 453.7656,117.75 L453.5938,117.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="471.75" y="126.8467">Batch</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="394" x2="559" y1="138" y2="138"/><ellipse cx="404" cy="151.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="413" y="154.9951">produce batch data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="394" x2="559" y1="162.2969" y2="162.2969"/></g><g id="elem_SS"><rect codeLine="31" fill="#E7B67E" height="64.2969" id="SS" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="249" x="352" y="205"/><ellipse cx="416.25" cy="221" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M418.5938,216.6719 C417.6563,216.2344 417.0625,216.0938 416.1875,216.0938 C413.5625,216.0938 411.5625,218.1719 411.5625,220.8906 L411.5625,222.0156 C411.5625,224.5938 413.6719,226.4844 416.5625,226.4844 C417.7813,226.4844 418.9375,226.1875 419.6875,225.6406 C420.2656,225.2344 420.5938,224.7813 420.5938,224.3906 C420.5938,223.9375 420.2031,223.5469 419.7344,223.5469 C419.5156,223.5469 419.3125,223.625 419.125,223.8125 C418.6719,224.2969 418.6719,224.2969 418.4844,224.3906 C418.0625,224.6563 417.375,224.7813 416.6094,224.7813 C414.5625,224.7813 413.2656,223.6875 413.2656,221.9844 L413.2656,220.8906 C413.2656,219.1094 414.5156,217.7969 416.25,217.7969 C416.8281,217.7969 417.4375,217.9531 417.9063,218.2031 C418.3906,218.4844 418.5625,218.7031 418.6563,219.1094 C418.7188,219.5156 418.75,219.6406 418.8906,219.7656 C419.0313,219.9063 419.2656,220.0156 419.4844,220.0156 C419.75,220.0156 420.0156,219.875 420.1875,219.6563 C420.2969,219.5 420.3281,219.3125 420.3281,218.8906 L420.3281,217.4688 C420.3281,217.0313 420.3125,216.9063 420.2188,216.75 C420.0625,216.4844 419.7813,216.3438 419.4844,216.3438 C419.1875,216.3438 418.9844,216.4375 418.7656,216.75 L418.5938,216.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="436.75" y="225.8467">Stream-Stream</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="353" x2="600" y1="237" y2="237"/><ellipse cx="363" cy="250.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="223" x="372" y="253.9951">read &amp; produce streaming data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="353" x2="600" y1="261.2969" y2="261.2969"/></g><g id="elem_SB"><rect codeLine="35" fill="#E7B67E" height="64.2969" id="SB" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="295" x="329" y="304"/><ellipse cx="421.75" cy="320" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M424.0938,315.6719 C423.1563,315.2344 422.5625,315.0938 421.6875,315.0938 C419.0625,315.0938 417.0625,317.1719 417.0625,319.8906 L417.0625,321.0156 C417.0625,323.5938 419.1719,325.4844 422.0625,325.4844 C423.2813,325.4844 424.4375,325.1875 425.1875,324.6406 C425.7656,324.2344 426.0938,323.7813 426.0938,323.3906 C426.0938,322.9375 425.7031,322.5469 425.2344,322.5469 C425.0156,322.5469 424.8125,322.625 424.625,322.8125 C424.1719,323.2969 424.1719,323.2969 423.9844,323.3906 C423.5625,323.6563 422.875,323.7813 422.1094,323.7813 C420.0625,323.7813 418.7656,322.6875 418.7656,320.9844 L418.7656,319.8906 C418.7656,318.1094 420.0156,316.7969 421.75,316.7969 C422.3281,316.7969 422.9375,316.9531 423.4063,317.2031 C423.8906,317.4844 424.0625,317.7031 424.1563,318.1094 C424.2188,318.5156 424.25,318.6406 424.3906,318.7656 C424.5313,318.9063 424.7656,319.0156 424.9844,319.0156 C425.25,319.0156 425.5156,318.875 425.6875,318.6563 C425.7969,318.5 425.8281,318.3125 425.8281,317.8906 L425.8281,316.4688 C425.8281,316.0313 425.8125,315.9063 425.7188,315.75 C425.5625,315.4844 425.2813,315.3438 424.9844,315.3438 C424.6875,315.3438 424.4844,315.4375 424.2656,315.75 L424.0938,315.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="442.25" y="324.8467">Stream-Batch</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="330" x2="623" y1="336" y2="336"/><ellipse cx="340" cy="349.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="269" x="349" y="352.9951">read streaming &amp; produce batch data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="330" x2="623" y1="360.2969" y2="360.2969"/></g><g id="elem_BS"><rect codeLine="39" fill="#E7B67E" height="64.2969" id="BS" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="295" x="329" y="403"/><ellipse cx="421.75" cy="419" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M424.0938,414.6719 C423.1563,414.2344 422.5625,414.0938 421.6875,414.0938 C419.0625,414.0938 417.0625,416.1719 417.0625,418.8906 L417.0625,420.0156 C417.0625,422.5938 419.1719,424.4844 422.0625,424.4844 C423.2813,424.4844 424.4375,424.1875 425.1875,423.6406 C425.7656,423.2344 426.0938,422.7813 426.0938,422.3906 C426.0938,421.9375 425.7031,421.5469 425.2344,421.5469 C425.0156,421.5469 424.8125,421.625 424.625,421.8125 C424.1719,422.2969 424.1719,422.2969 423.9844,422.3906 C423.5625,422.6563 422.875,422.7813 422.1094,422.7813 C420.0625,422.7813 418.7656,421.6875 418.7656,419.9844 L418.7656,418.8906 C418.7656,417.1094 420.0156,415.7969 421.75,415.7969 C422.3281,415.7969 422.9375,415.9531 423.4063,416.2031 C423.8906,416.4844 424.0625,416.7031 424.1563,417.1094 C424.2188,417.5156 424.25,417.6406 424.3906,417.7656 C424.5313,417.9063 424.7656,418.0156 424.9844,418.0156 C425.25,418.0156 425.5156,417.875 425.6875,417.6563 C425.7969,417.5 425.8281,417.3125 425.8281,416.8906 L425.8281,415.4688 C425.8281,415.0313 425.8125,414.9063 425.7188,414.75 C425.5625,414.4844 425.2813,414.3438 424.9844,414.3438 C424.6875,414.3438 424.4844,414.4375 424.2656,414.75 L424.0938,414.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="442.25" y="423.8467">Batch-Stream</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="330" x2="623" y1="435" y2="435"/><ellipse cx="340" cy="448.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="269" x="349" y="451.9951">read batch &amp; produce streaming data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="330" x2="623" y1="459.2969" y2="459.2969"/></g><g id="elem_BB"><rect codeLine="43" fill="#E7B67E" height="64.2969" id="BB" rx="3.5" ry="3.5" style="stroke:#268BD2;stroke-width:0.5;" width="218" x="367.5" y="502"/><ellipse cx="427.25" cy="518" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M429.5938,513.6719 C428.6563,513.2344 428.0625,513.0938 427.1875,513.0938 C424.5625,513.0938 422.5625,515.1719 422.5625,517.8906 L422.5625,519.0156 C422.5625,521.5938 424.6719,523.4844 427.5625,523.4844 C428.7813,523.4844 429.9375,523.1875 430.6875,522.6406 C431.2656,522.2344 431.5938,521.7813 431.5938,521.3906 C431.5938,520.9375 431.2031,520.5469 430.7344,520.5469 C430.5156,520.5469 430.3125,520.625 430.125,520.8125 C429.6719,521.2969 429.6719,521.2969 429.4844,521.3906 C429.0625,521.6563 428.375,521.7813 427.6094,521.7813 C425.5625,521.7813 424.2656,520.6875 424.2656,518.9844 L424.2656,517.8906 C424.2656,516.1094 425.5156,514.7969 427.25,514.7969 C427.8281,514.7969 428.4375,514.9531 428.9063,515.2031 C429.3906,515.4844 429.5625,515.7031 429.6563,516.1094 C429.7188,516.5156 429.75,516.6406 429.8906,516.7656 C430.0313,516.9063 430.2656,517.0156 430.4844,517.0156 C430.75,517.0156 431.0156,516.875 431.1875,516.6563 C431.2969,516.5 431.3281,516.3125 431.3281,515.8906 L431.3281,514.4688 C431.3281,514.0313 431.3125,513.9063 431.2188,513.75 C431.0625,513.4844 430.7813,513.3438 430.4844,513.3438 C430.1875,513.3438 429.9844,513.4375 429.7656,513.75 L429.5938,513.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="447.75" y="522.8467">Batch-Batch</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="368.5" x2="584.5" y1="534" y2="534"/><ellipse cx="378.5" cy="547.6484" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="387.5" y="550.9951">read &amp; produce batch data</text><line style="stroke:#268BD2;stroke-width:0.5;" x1="368.5" x2="584.5" y1="558.2969" y2="558.2969"/></g><g id="link_Spout_S"><path codeLine="47" d="M263.511,114.713 C283.826,105.978 307.359,96.19 329,88 C344.551,82.115 344.1379,82.0494 360.3839,76.4734 " fill="none" id="Spout-to-S" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="377.409,70.63,358.4361,70.7984,362.3317,82.1484,377.409,70.63" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Spout_B"><path codeLine="48" d="M263.573,138 C300.484,138 332.596,138 374.824,138 " fill="none" id="Spout-to-B" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="392.824,138,374.824,132,374.824,144,392.824,138" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Bolt_SS"><path codeLine="50" d="M269.155,310.295 C288.11,302.203 309.335,293.442 329,286 C344.175,280.257 343.338,280.3444 359.207,274.8884 " fill="none" id="Bolt-to-SS" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="376.229,269.036,357.2562,269.2144,361.1578,280.5624,376.229,269.036" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Bolt_SB"><path codeLine="51" d="M269.046,336 C286.99,336 289.629,336 310.768,336 " fill="none" id="Bolt-to-SB" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="328.768,336,310.768,330,310.768,342,328.768,336" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Bolt_BS"><path codeLine="52" d="M269.221,361.053 C288.179,368.975 309.391,377.591 329,385 C344.964,391.032 345.0222,391.2303 361.6492,397.0173 " fill="none" id="Bolt-to-BS" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="378.649,402.934,363.6215,391.3507,359.677,402.6838,378.649,402.934" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Bolt_BB"><path codeLine="53" d="M229.062,368.199 C249.336,401.599 285.198,453.17 329,484 C340.648,492.1982 337.2495,491.9568 350.7075,497.8188 " fill="none" id="Bolt-to-BB" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="367.21,505.0069,353.1036,492.318,348.3115,503.3196,367.21,505.0069" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Task_Spout"><path codeLine="55" d="M91.3603,211.247 C111.511,198.701 120.667,193.0003 142.035,179.6953 " fill="none" id="Task-to-Spout" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="157.315,170.181,138.8636,174.6019,145.2064,184.7886,157.315,170.181" style="stroke:#93A1A1;stroke-width:1.0;"/></g><g id="link_Task_Bolt"><path codeLine="56" d="M91.3603,262.753 C111.511,275.299 120.667,280.9997 142.035,294.3047 " fill="none" id="Task-to-Bolt" style="stroke:#93A1A1;stroke-width:1.0;"/><polygon fill="none" points="157.315,303.819,145.2064,289.2114,138.8636,299.3981,157.315,303.819" style="stroke:#93A1A1;stroke-width:1.0;"/></g></g></svg></div>

<h2 id="guides-concepts-runners">Runners<a class="headerlink" href="#guides-concepts-runners" title="Permanent link">&para;</a></h2>
<p>Runners are the backbone of the Geniusrise framework, ensuring that tasks are executed seamlessly across various platforms. They encapsulate the environment and resources required for task execution, abstracting away the underlying complexities. Geniusrise offers a diverse set of runners:</p>
<ol>
<li>Local Runner: Executes tasks directly on a local machine, ideal for development and testing.</li>
<li>Docker Runner: Runs tasks within Docker containers, ensuring a consistent and isolated environment.</li>
<li>Kubernetes Runner: Deploys tasks on Kubernetes clusters, leveraging its scalability and orchestration capabilities.</li>
<li>Airflow Runner: Integrates with Apache Airflow, allowing for complex workflow orchestration and scheduling.</li>
<li>ECS Runner: Executes tasks on AWS ECS, providing a managed container service.</li>
<li>Batch Runner: Optimized for batch computing workloads on platforms like AWS Batch.</li>
</ol>
<h2 id="guides-concepts-tradeoffs">Tradeoffs<a class="headerlink" href="#guides-concepts-tradeoffs" title="Permanent link">&para;</a></h2>
<p>Because of the very loose coupling of the components, though the framework can be used to build very complex networks with independently running nodes, it provides limited orchestration capability, like synchronous pipelines. An external orchestrator like airflow can be used in such cases to orchestrate geniusrise components.</p></section><section class="print-page" id="guides-installation"><h1 id="guides-installation-installation">Installation<a class="headerlink" href="#guides-installation-installation" title="Permanent link">&para;</a></h1>
<p>Geniusrise is composed of the core framework and various plugins that implement specific tasks.
The core has to be installed first, and after that selected plugins can be installed as and when required.</p>
<h2 id="guides-installation-installing-geniusrise-core-framework">Installing Geniusrise Core Framework<a class="headerlink" href="#guides-installation-installing-geniusrise-core-framework" title="Permanent link">&para;</a></h2>
<h3 id="guides-installation-using-pip">Using pip<a class="headerlink" href="#guides-installation-using-pip" title="Permanent link">&para;</a></h3>
<p>To install the core framework using pip in local env, simply run:</p>
<pre><code class="language-bash">pip install geniusrise
</code></pre>
<p>Or if you wish to install at user level:</p>
<pre><code class="language-bash">pip install generiusrise --user
</code></pre>
<p>Or on a global level (might conflict with your OS package manager):</p>
<pre><code class="language-bash">sudo pip install geniusrise
</code></pre>
<p>To verify the installation, you can check whether the geniusrise binary exists in PATH:</p>
<pre><code class="language-bash">which geniusrise

geniusrise --help
</code></pre>
<h2 id="guides-installation-installing-geniusrise-plugins">Installing Geniusrise Plugins<a class="headerlink" href="#guides-installation-installing-geniusrise-plugins" title="Permanent link">&para;</a></h2>
<p>Geniusrise offers a variety of plugins that act as composable lego blocks. To install a specific plugin, use the following format:</p>
<pre><code class="language-bash">pip install geniusrise[plugin-name]
</code></pre>
<p>Replace <code>plugin-name</code> with the name of the desired plugin.</p>
<h2 id="guides-installation-alternative-installation-methods">Alternative Installation Methods<a class="headerlink" href="#guides-installation-alternative-installation-methods" title="Permanent link">&para;</a></h2>
<h3 id="guides-installation-using-conda">Using Conda<a class="headerlink" href="#guides-installation-using-conda" title="Permanent link">&para;</a></h3>
<ol>
<li>Activate the environment:</li>
</ol>
<pre><code class="language-bash">conda activate your-env
</code></pre>
<ol>
<li>Install Geniusrise:</li>
</ol>
<pre><code class="language-bash">pip install geniusrise
</code></pre>
<p>For plugins:</p>
<pre><code class="language-bash">pip install geniusrise[plugin-name]
</code></pre>
<h3 id="guides-installation-using-poetry">Using Poetry<a class="headerlink" href="#guides-installation-using-poetry" title="Permanent link">&para;</a></h3>
<ol>
<li>Add Geniusrise as a dependency:</li>
</ol>
<pre><code class="language-bash">poetry add geniusrise
</code></pre>
<p>For plugins:</p>
<pre><code class="language-bash">poetry add geniusrise[plugin-name]
</code></pre>
<h2 id="guides-installation-development">Development<a class="headerlink" href="#guides-installation-development" title="Permanent link">&para;</a></h2>
<p>For development, you may want to install from the repo:</p>
<pre><code class="language-bash">git clone git@github.com:geniusrise/geniusrise.git
cd geniusrise
virtualenv venv -p `which python3.10`
source venv/bin/activate
pip install -r ./requirements.txt

make install # installs in your local venv directory
</code></pre>
<hr />
<p>That's it! You've successfully installed Geniusrise and its plugins. 🎉</p></section>
                        <h1 class='nav-section-title' id='section-development'>
                            Development <a class='headerlink' href='#section-development' title='Permanent link'>↵</a>
                        </h1>
                        <h1 class='nav-section-title-end'>Ended: Development</h1>
                        <h1 class='nav-section-title' id='section-deployment'>
                            Deployment <a class='headerlink' href='#section-deployment' title='Permanent link'>↵</a>
                        </h1>
                        <h1 class='nav-section-title-end'>Ended: Deployment</h1>
                        <h1 class='nav-section-title' id='section-reference'>
                            Reference <a class='headerlink' href='#section-reference' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="index"><p><img alt="banner" src="../assets/sc2.jpg" /></p>
<h1 id="index-geniusrise-documentation">Geniusrise Documentation<a class="headerlink" href="#index-geniusrise-documentation" title="Permanent link">&para;</a></h1>
<h2 id="index-about">About<a class="headerlink" href="#index-about" title="Permanent link">&para;</a></h2>
<hr />
<p>Geniusrise is a computation framework is designed to support both batch and
streaming data processing asynchronous Directed Acyclic Graphs (DAGs).</p>
<h2 id="index-guides">Guides<a class="headerlink" href="#index-guides" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="index-getting-started">Getting started<a class="headerlink" href="#index-getting-started" title="Permanent link">&para;</a></h3>
<ol>
<li><a href="#guides-index.md">Home</a>: Front page</li>
<li><a href="#guides-cnocepts.md">Concepts</a>: Concepts of the framework</li>
<li><a href="#guides-installation">Installation</a>: Start here, installation and setup</li>
<li><a href="#guides-index.md">Design and Architecture</a>: Design and architecture of the framework</li>
</ol>
<h3 id="index-development">Development<a class="headerlink" href="#index-development" title="Permanent link">&para;</a></h3>
<ol>
<li><a href="#guides-index.md">Local experimentation</a>: Local experimentation workflow</li>
<li><a href="#guides-index.md">Packaging</a>: Packaging your application</li>
<li><a href="#guides-index.md">Staged deployment</a>: Deploying parts or whole of your application</li>
<li><a href="#guides-index.md">Workflow ops</a>: Operations and management of workflows</li>
<li><a href="#guides-index.md">Data ops</a>: Operations and management of data</li>
<li><a href="#guides-index.md">Model ops</a>: Operations and management of models</li>
</ol>
<h3 id="index-deployment">Deployment<a class="headerlink" href="#index-deployment" title="Permanent link">&para;</a></h3>
<ol>
<li><a href="#guides-index.md">Kubernetes</a>: Running geniusrise on kubernetes</li>
<li><a href="#guides-index.md">Apache Airflow</a>: Orchestrating batch jobs on Apache Airflow</li>
<li><a href="#guides-index.md">Apache Spark</a>: Using geniusrise as a spark library</li>
<li><a href="#guides-index.md">Apache Flink</a>: Using geniusrise as a flink library</li>
<li><a href="#guides-index.md">Apache Beam</a>: Using geniusrise as a beam library</li>
<li><a href="#guides-index.md">Apache Storm</a>: Using geniusrise as a storm library</li>
<li><a href="#guides-index.md">AWS ECS</a>: Running geniusrise on AWS ECS</li>
<li><a href="#guides-index.md">AWS Batch</a>: Running geniusrise batch jobs on AWS Batch</li>
</ol>
<h3 id="index-reference">Reference<a class="headerlink" href="#index-reference" title="Permanent link">&para;</a></h3>
<ol>
<li><a href="#guides-index.md">YAML structure</a>: Geniusfile structure and configuration</li>
<li><a href="#guides-plugins.md">Community Plugins</a>: Building and shipping community plugins (spouts and bolts)</li>
<li><a href="#guides-index.md">Project templates</a>: Project templates for community plugins</li>
</ol>
<hr />
<h2 id="index-examples">Examples<a class="headerlink" href="#index-examples" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#examples-index.md">Write a confluence PRD and have jira and github issues created and linked automatically</a></li>
<li><a href="#examples-index.md">Monitor, alert and summarize machinery metrics in a process industry</a></li>
<li><a href="#examples-index.md">Read news and stock market tickers to generate buy and sell alerts</a></li>
<li><a href="#examples-index.md">Read infosec logs generated by various services and decide whether to generate an alert</a></li>
<li><a href="#examples-index.md">Batch or streaming fine-tuning and managing a huggingface-hosted model</a></li>
<li><a href="#examples-index.md">Batch or streaming fine-tuning and managing an openAI model</a></li>
</ol>
<hr />
<h2 id="index-library-reference">Library Reference<a class="headerlink" href="#index-library-reference" title="Permanent link">&para;</a></h2>
<ul>
<li>geniusrise.cli:<ul>
<li><a href="#core-cli_geniusctl">geniusctl</a>: The main command line application</li>
<li><a href="#core-cli_yamlctl">yamlctl</a>: Control spouts and bolts defined in a YAML file</li>
<li><a href="#core-cli_boltctl">boltctl</a>: The main bolt controller</li>
<li><a href="#core-cli_spoutctl">spoutctl</a>: The main spout controller</li>
<li><a href="#core-cli_schema">schema</a>: YAML schema definition as pydantic</li>
<li><a href="#core-cli_discover">discover</a>: Module discovery</li>
</ul>
</li>
<li>geniusrise.core:<ul>
<li><a href="#core-core_bolt">bolt</a>: Core Bolt class</li>
<li><a href="#core-core_spout">spout</a>: Core Spout class</li>
<li>geniusrise.core.data:<ul>
<li><a href="#core-core_data_batch_input">batch_input</a>: Batch input manager</li>
<li><a href="#core-core_data_batch_output">batch_output</a>: Batch output manager</li>
<li><a href="#core-core_data_input">input</a>: Input manager base class</li>
<li><a href="#core-core_data_output">output</a>: Output manager base class</li>
<li><a href="#core-core_data_streaming_input">streaming_input</a>: Streaming input manager</li>
<li><a href="#core-core_data_streaming_output">streaming_output</a>: Streaming output manager</li>
</ul>
</li>
<li>geniusrise.core.state:<ul>
<li><a href="#core-core_state_base">base</a>: Base class for task state mnager</li>
<li><a href="#core-core_state_dynamo">dynamo</a>: State manager using dynamoDB</li>
<li><a href="#core-core_state_memory">memory</a>: State manager using local memory</li>
<li><a href="#core-core_state_postgres">postgres</a>: State manager using postgres database</li>
<li><a href="#core-core_state_redis">redis</a>: State manager using redis</li>
</ul>
</li>
<li>geniusrise.core.task:<ul>
<li><a href="#core-core_task_base">base</a>: Base class for Task</li>
</ul>
</li>
<li>geniusrise.runners:<ul>
<li><a href="#core-core_task_ecs">ecs</a>: Runner class using AWS ECS</li>
<li><a href="#core-core_task_k8s">k8s</a>: Runner class using kubernetes</li>
</ul>
</li>
</ul>
</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Reference</h1>
                        <h1 class='nav-section-title' id='section-core-reference'>
                            Core Reference <a class='headerlink' href='#section-core-reference' title='Permanent link'>↵</a>
                        </h1>
                        
                        <h2 class='nav-section-title' id='section-cli'>
                            cli <a class='headerlink' href='#section-cli' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="core-cli_boltctl"><h1 id="core-cli_boltctl-boltctl">Boltctl<a class="headerlink" href="#core-cli_boltctl-boltctl" title="Permanent link">&para;</a></h1>
<p>The main bolt controller</p>


<div class="doc doc-object doc-module">


<a id="cli.boltctl"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-cli_boltctl-cli.boltctl.BoltCtl" class="doc doc-heading">
          <code>BoltCtl</code>


<a href="#core-cli_boltctl-cli.boltctl.BoltCtl" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Class for managing bolts end-to-end from the command line.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/boltctl.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BoltCtl</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for managing bolts end-to-end from the command line.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discovered_bolt</span><span class="p">:</span> <span class="n">DiscoveredBolt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize BoltCtl with a DiscoveredBolt object.</span>

<span class="sd">        Args:</span>
<span class="sd">            discovered_bolt (DiscoveredBolt): DiscoveredBolt object used to create and manage bolts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span> <span class="o">=</span> <span class="n">discovered_bolt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolt</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add arguments to the command-line parser for managing the bolt.</span>

<span class="sd">        Args:</span>
<span class="sd">            parser (argparse.ArgumentParser): Command-line parser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>

        <span class="c1"># Create subparser for &#39;run&#39; command</span>
        <span class="n">run_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Run a bolt locally.&quot;</span><span class="p">)</span>

        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;input_type&quot;</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">],</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Choose the type of input configuration: batch or streaming.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">],</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Choose the type of output configuration: batch or streaming.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;state_type&quot;</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;redis&quot;</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">],</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select the type of state manager: in_memory, redis, postgres, or dynamodb.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--input_folder&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the directory where output files should be stored temporarily.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--input_kafka_topic&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka output topic for streaming spouts.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--input_kafka_cluster_connection_string&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka connection string for streaming spouts.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost:9092&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--input_s3_bucket&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the S3 bucket for output storage.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--input_s3_folder&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indicate the S3 folder for output storage.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-s3-folder&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_folder&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the directory where output files should be stored temporarily.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_kafka_topic&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka output topic for streaming spouts.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_kafka_cluster_connection_string&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka connection string for streaming spouts.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost:9092&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_s3_bucket&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the S3 bucket for output storage.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_s3_folder&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indicate the S3 folder for output storage.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-s3-folder&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--redis_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--redis_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--redis_db&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the Redis database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_user&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the username for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_password&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the password for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_database&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mydatabase&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_table&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL table to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--dynamodb_table_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the DynamoDB table.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--dynamodb_region_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the AWS region for DynamoDB.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;us-west-2&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;method_name&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The name of the method to execute on the bolt.&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--args&quot;</span><span class="p">,</span>
            <span class="n">nargs</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">REMAINDER</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Additional keyword arguments to pass to the bolt.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Create subparser for &#39;help&#39; command</span>
        <span class="n">help_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print help for the bolt.&quot;</span><span class="p">)</span>
        <span class="n">help_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The method to execute.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run the command-line interface.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running command: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="si">}</span><span class="s2"> :rocket:&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;run&quot;</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;input_type&quot;</span><span class="p">,</span> <span class="s2">&quot;output_type&quot;</span><span class="p">,</span> <span class="s2">&quot;state_type&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="s2">&quot;method_name&quot;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="p">[]</span>
                <span class="n">other_args</span><span class="p">,</span> <span class="n">other_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_args_kwargs</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bolt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_bolt</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input_type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                <span class="c1"># Pass the method_name from args to execute_bolt</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_bolt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bolt</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span><span class="p">,</span> <span class="o">**</span><span class="n">other_kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully executed the bolt method: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">method_name</span><span class="si">}</span><span class="s2"> :thumbs_up:&quot;</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">result</span>

            <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;help&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span><span class="o">.</span><span class="n">klass</span><span class="o">.</span><span class="n">print_help</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span><span class="o">.</span><span class="n">klass</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ve</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value error: </span><span class="si">{</span><span class="n">ve</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">ae</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute error: </span><span class="si">{</span><span class="n">ae</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ke</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing key: </span><span class="si">{</span><span class="n">ke</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_args_kwargs</span><span class="p">(</span><span class="n">args_list</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">value</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">args_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>

    <span class="k">def</span> <span class="nf">create_bolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bolt</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a bolt of a specific type.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_type (str): The type of input config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">            output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">            state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">            **kwargs: Additional keyword arguments for initializing the bolt.</span>
<span class="sd">                Keyword Arguments:</span>
<span class="sd">                    Batch input config:</span>
<span class="sd">                    - input_folder (str): The input folder argument.</span>
<span class="sd">                    - input_s3_bucket (str): The input bucket argument.</span>
<span class="sd">                    - input_s3_folder (str): The input S3 folder argument.</span>
<span class="sd">                    Batch outupt config:</span>
<span class="sd">                    - output_folder (str): The output folder argument.</span>
<span class="sd">                    - output_s3_bucket (str): The output bucket argument.</span>
<span class="sd">                    - output_s3_folder (str): The output S3 folder argument.</span>
<span class="sd">                    Streaming input config:</span>
<span class="sd">                    - input_kafka_cluster_connection_string (str): The input Kafka servers argument.</span>
<span class="sd">                    - input_kafka_topic (str): The input kafka topic argument.</span>
<span class="sd">                    - input_kafka_consumer_group_id (str): The Kafka consumer group id.</span>
<span class="sd">                    Streaming output config:</span>
<span class="sd">                    - output_kafka_cluster_connection_string (str): The output Kafka servers argument.</span>
<span class="sd">                    - output_kafka_topic (str): The output kafka topic argument.</span>
<span class="sd">                    Redis state manager config:</span>
<span class="sd">                    - redis_host (str): The Redis host argument.</span>
<span class="sd">                    - redis_port (str): The Redis port argument.</span>
<span class="sd">                    - redis_db (str): The Redis database argument.</span>
<span class="sd">                    Postgres state manager config:</span>
<span class="sd">                    - postgres_host (str): The PostgreSQL host argument.</span>
<span class="sd">                    - postgres_port (str): The PostgreSQL port argument.</span>
<span class="sd">                    - postgres_user (str): The PostgreSQL user argument.</span>
<span class="sd">                    - postgres_password (str): The PostgreSQL password argument.</span>
<span class="sd">                    - postgres_database (str): The PostgreSQL database argument.</span>
<span class="sd">                    - postgres_table (str): The PostgreSQL table argument.</span>
<span class="sd">                    DynamoDB state manager config:</span>
<span class="sd">                    - dynamodb_table_name (str): The DynamoDB table name argument.</span>
<span class="sd">                    - dynamodb_region_name (str): The DynamoDB region name argument.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Bolt: The created bolt.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Bolt</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">klass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span><span class="o">.</span><span class="n">klass</span><span class="p">,</span>
            <span class="n">input_type</span><span class="o">=</span><span class="n">input_type</span><span class="p">,</span>
            <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span>
            <span class="n">state_type</span><span class="o">=</span><span class="n">state_type</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute_bolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bolt</span><span class="p">:</span> <span class="n">Bolt</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a method of a bolt.</span>

<span class="sd">        Args:</span>
<span class="sd">            bolt (Bolt): The bolt to execute.</span>
<span class="sd">            method_name (str): The name of the method to execute.</span>
<span class="sd">            *args: Positional arguments to pass to the method.</span>
<span class="sd">            **kwargs: Keyword arguments to pass to the method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: The result of the method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">bolt</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-cli_boltctl-cli.boltctl.BoltCtl.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">discovered_bolt</span><span class="p">)</span></code>

<a href="#core-cli_boltctl-cli.boltctl.BoltCtl.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize BoltCtl with a DiscoveredBolt object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>discovered_bolt</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.cli.discover.DiscoveredBolt">DiscoveredBolt</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DiscoveredBolt object used to create and manage bolts.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/boltctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discovered_bolt</span><span class="p">:</span> <span class="n">DiscoveredBolt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize BoltCtl with a DiscoveredBolt object.</span>

<span class="sd">    Args:</span>
<span class="sd">        discovered_bolt (DiscoveredBolt): DiscoveredBolt object used to create and manage bolts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span> <span class="o">=</span> <span class="n">discovered_bolt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bolt</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_boltctl-cli.boltctl.BoltCtl.create_bolt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_bolt</span><span class="p">(</span><span class="n">input_type</span><span class="p">,</span> <span class="n">output_type</span><span class="p">,</span> <span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-cli_boltctl-cli.boltctl.BoltCtl.create_bolt" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a bolt of a specific type.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of input config ("batch" or "streaming").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of output config ("batch" or "streaming").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>state_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of state manager ("in_memory", "redis", "postgres", or "dynamodb").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments for initializing the bolt.
Keyword Arguments:
    Batch input config:
    - input_folder (str): The input folder argument.
    - input_s3_bucket (str): The input bucket argument.
    - input_s3_folder (str): The input S3 folder argument.
    Batch outupt config:
    - output_folder (str): The output folder argument.
    - output_s3_bucket (str): The output bucket argument.
    - output_s3_folder (str): The output S3 folder argument.
    Streaming input config:
    - input_kafka_cluster_connection_string (str): The input Kafka servers argument.
    - input_kafka_topic (str): The input kafka topic argument.
    - input_kafka_consumer_group_id (str): The Kafka consumer group id.
    Streaming output config:
    - output_kafka_cluster_connection_string (str): The output Kafka servers argument.
    - output_kafka_topic (str): The output kafka topic argument.
    Redis state manager config:
    - redis_host (str): The Redis host argument.
    - redis_port (str): The Redis port argument.
    - redis_db (str): The Redis database argument.
    Postgres state manager config:
    - postgres_host (str): The PostgreSQL host argument.
    - postgres_port (str): The PostgreSQL port argument.
    - postgres_user (str): The PostgreSQL user argument.
    - postgres_password (str): The PostgreSQL password argument.
    - postgres_database (str): The PostgreSQL database argument.
    - postgres_table (str): The PostgreSQL table argument.
    DynamoDB state manager config:
    - dynamodb_table_name (str): The DynamoDB table name argument.
    - dynamodb_region_name (str): The DynamoDB region name argument.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Bolt</code></td>          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.Bolt">Bolt</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The created bolt.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/boltctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_bolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bolt</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a bolt of a specific type.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_type (str): The type of input config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">        output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">        state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">        **kwargs: Additional keyword arguments for initializing the bolt.</span>
<span class="sd">            Keyword Arguments:</span>
<span class="sd">                Batch input config:</span>
<span class="sd">                - input_folder (str): The input folder argument.</span>
<span class="sd">                - input_s3_bucket (str): The input bucket argument.</span>
<span class="sd">                - input_s3_folder (str): The input S3 folder argument.</span>
<span class="sd">                Batch outupt config:</span>
<span class="sd">                - output_folder (str): The output folder argument.</span>
<span class="sd">                - output_s3_bucket (str): The output bucket argument.</span>
<span class="sd">                - output_s3_folder (str): The output S3 folder argument.</span>
<span class="sd">                Streaming input config:</span>
<span class="sd">                - input_kafka_cluster_connection_string (str): The input Kafka servers argument.</span>
<span class="sd">                - input_kafka_topic (str): The input kafka topic argument.</span>
<span class="sd">                - input_kafka_consumer_group_id (str): The Kafka consumer group id.</span>
<span class="sd">                Streaming output config:</span>
<span class="sd">                - output_kafka_cluster_connection_string (str): The output Kafka servers argument.</span>
<span class="sd">                - output_kafka_topic (str): The output kafka topic argument.</span>
<span class="sd">                Redis state manager config:</span>
<span class="sd">                - redis_host (str): The Redis host argument.</span>
<span class="sd">                - redis_port (str): The Redis port argument.</span>
<span class="sd">                - redis_db (str): The Redis database argument.</span>
<span class="sd">                Postgres state manager config:</span>
<span class="sd">                - postgres_host (str): The PostgreSQL host argument.</span>
<span class="sd">                - postgres_port (str): The PostgreSQL port argument.</span>
<span class="sd">                - postgres_user (str): The PostgreSQL user argument.</span>
<span class="sd">                - postgres_password (str): The PostgreSQL password argument.</span>
<span class="sd">                - postgres_database (str): The PostgreSQL database argument.</span>
<span class="sd">                - postgres_table (str): The PostgreSQL table argument.</span>
<span class="sd">                DynamoDB state manager config:</span>
<span class="sd">                - dynamodb_table_name (str): The DynamoDB table name argument.</span>
<span class="sd">                - dynamodb_region_name (str): The DynamoDB region name argument.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Bolt: The created bolt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Bolt</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">klass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span><span class="o">.</span><span class="n">klass</span><span class="p">,</span>
        <span class="n">input_type</span><span class="o">=</span><span class="n">input_type</span><span class="p">,</span>
        <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span>
        <span class="n">state_type</span><span class="o">=</span><span class="n">state_type</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_boltctl-cli.boltctl.BoltCtl.create_parser" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span></code>

<a href="#core-cli_boltctl-cli.boltctl.BoltCtl.create_parser" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add arguments to the command-line parser for managing the bolt.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parser</code></td>
          <td>
                <code><span data-autorefs-optional="argparse">argparse</span>.<span data-autorefs-optional-hover="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Command-line parser.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/boltctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add arguments to the command-line parser for managing the bolt.</span>

<span class="sd">    Args:</span>
<span class="sd">        parser (argparse.ArgumentParser): Command-line parser.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>

    <span class="c1"># Create subparser for &#39;run&#39; command</span>
    <span class="n">run_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Run a bolt locally.&quot;</span><span class="p">)</span>

    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;input_type&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Choose the type of input configuration: batch or streaming.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Choose the type of output configuration: batch or streaming.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;state_type&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;redis&quot;</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select the type of state manager: in_memory, redis, postgres, or dynamodb.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--input_folder&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the directory where output files should be stored temporarily.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--input_kafka_topic&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka output topic for streaming spouts.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--input_kafka_cluster_connection_string&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka connection string for streaming spouts.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost:9092&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--input_s3_bucket&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the S3 bucket for output storage.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--input_s3_folder&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indicate the S3 folder for output storage.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-s3-folder&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_folder&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the directory where output files should be stored temporarily.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_kafka_topic&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka output topic for streaming spouts.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_kafka_cluster_connection_string&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka connection string for streaming spouts.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost:9092&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_s3_bucket&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the S3 bucket for output storage.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_s3_folder&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indicate the S3 folder for output storage.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-s3-folder&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--redis_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--redis_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--redis_db&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the Redis database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_user&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the username for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_password&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the password for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_database&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mydatabase&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_table&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL table to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--dynamodb_table_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the DynamoDB table.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--dynamodb_region_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the AWS region for DynamoDB.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;us-west-2&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;method_name&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The name of the method to execute on the bolt.&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">run_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--args&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">REMAINDER</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Additional keyword arguments to pass to the bolt.&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Create subparser for &#39;help&#39; command</span>
    <span class="n">help_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print help for the bolt.&quot;</span><span class="p">)</span>
    <span class="n">help_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The method to execute.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_boltctl-cli.boltctl.BoltCtl.execute_bolt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">execute_bolt</span><span class="p">(</span><span class="n">bolt</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-cli_boltctl-cli.boltctl.BoltCtl.execute_bolt" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Execute a method of a bolt.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bolt</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.Bolt">Bolt</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The bolt to execute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the method to execute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positional arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the method.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/boltctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">execute_bolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bolt</span><span class="p">:</span> <span class="n">Bolt</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute a method of a bolt.</span>

<span class="sd">    Args:</span>
<span class="sd">        bolt (Bolt): The bolt to execute.</span>
<span class="sd">        method_name (str): The name of the method to execute.</span>
<span class="sd">        *args: Positional arguments to pass to the method.</span>
<span class="sd">        **kwargs: Keyword arguments to pass to the method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The result of the method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bolt</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_boltctl-cli.boltctl.BoltCtl.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

<a href="#core-cli_boltctl-cli.boltctl.BoltCtl.run" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run the command-line interface.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code><span data-autorefs-optional="argparse">argparse</span>.<span data-autorefs-optional-hover="argparse.Namespace">Namespace</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parsed command-line arguments.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/boltctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the command-line interface.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running command: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="si">}</span><span class="s2"> :rocket:&quot;</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;run&quot;</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;input_type&quot;</span><span class="p">,</span> <span class="s2">&quot;output_type&quot;</span><span class="p">,</span> <span class="s2">&quot;state_type&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="s2">&quot;method_name&quot;</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="p">[]</span>
            <span class="n">other_args</span><span class="p">,</span> <span class="n">other_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_args_kwargs</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bolt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_bolt</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input_type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># Pass the method_name from args to execute_bolt</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_bolt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bolt</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span><span class="p">,</span> <span class="o">**</span><span class="n">other_kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully executed the bolt method: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">method_name</span><span class="si">}</span><span class="s2"> :thumbs_up:&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;help&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span><span class="o">.</span><span class="n">klass</span><span class="o">.</span><span class="n">print_help</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_bolt</span><span class="o">.</span><span class="n">klass</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ve</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value error: </span><span class="si">{</span><span class="n">ve</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">ae</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute error: </span><span class="si">{</span><span class="n">ae</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ke</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing key: </span><span class="si">{</span><span class="n">ke</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-cli_discover"><h1 id="core-cli_discover-discover">Discover<a class="headerlink" href="#core-cli_discover-discover" title="Permanent link">&para;</a></h1>
<p>Module discovery</p>


<div class="doc doc-object doc-module">


<a id="cli.discover"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-cli_discover-cli.discover.Discover" class="doc doc-heading">
          <code>Discover</code>


<a href="#core-cli_discover-cli.discover.Discover" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/discover.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Discover</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Discover class.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>

    <span class="k">def</span> <span class="nf">scan_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scan for spouts/bolts in installed extensions and user&#39;s codebase.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory (Optional[str]): Directory to scan for user-defined spouts/bolts.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Any]: Discovered spouts/bolts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span> <span class="k">if</span> <span class="n">directory</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;🔍 Starting discovery...&quot;</span><span class="p">))</span>

        <span class="c1"># Discover installed extensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discover_installed_extensions</span><span class="p">()</span>

        <span class="c1"># Discover user-defined spouts/bolts</span>
        <span class="k">if</span> <span class="n">directory</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;__init__.py&quot;</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                    <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">find_classes</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span>

    <span class="k">def</span> <span class="nf">discover_installed_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Discover installed geniusrise extensions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;🔎 Discovering installed extensions...&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">entry_point</span> <span class="ow">in</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">iter_entry_points</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;geniusrise.extensions&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">entry_point</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_classes</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Error discovering classes in </span><span class="si">{</span><span class="n">entry_point</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">import_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Import a module given its path.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): Path to the module.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: Imported module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">,</span> <span class="s2">&quot;../../../../&quot;</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
        <span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">project_root</span><span class="p">)</span>
        <span class="n">module_path</span> <span class="o">=</span> <span class="n">relative_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">module_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;__init__&quot;</span><span class="p">):</span>
            <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="p">[:</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span>  <span class="c1"># remove trailing &#39;__init__&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📦 Importing module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">))</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">module</span>

    <span class="k">def</span> <span class="nf">find_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Discover spout/bolt classes in a module.</span>

<span class="sd">        Args:</span>
<span class="sd">            module (Any): Module to scan for spout/bolt classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
            <span class="n">discovered</span><span class="p">:</span> <span class="n">DiscoveredSpout</span> <span class="o">|</span> <span class="n">DiscoveredBolt</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Spout</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span> <span class="o">!=</span> <span class="n">Spout</span><span class="p">:</span>
                <span class="n">discovered</span> <span class="o">=</span> <span class="n">DiscoveredSpout</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">init_args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_init_args</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚀 Discovered Spout </span><span class="si">{</span><span class="n">discovered</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">discovered</span>
            <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Bolt</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span> <span class="o">!=</span> <span class="n">Bolt</span><span class="p">:</span>
                <span class="n">discovered</span> <span class="o">=</span> <span class="n">DiscoveredBolt</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">init_args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_init_args</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚡ Discovered Bolt </span><span class="si">{</span><span class="n">discovered</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">discovered</span>

    <span class="k">def</span> <span class="nf">get_init_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract initialization arguments of a class.</span>

<span class="sd">        Args:</span>
<span class="sd">            cls (type): Class to extract initialization arguments from.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Any]: Initialization arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">init_signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">init_params</span> <span class="o">=</span> <span class="n">init_signature</span><span class="o">.</span><span class="n">parameters</span>
        <span class="n">init_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">kind</span> <span class="ow">in</span> <span class="n">init_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;kwargs&quot;</span> <span class="ow">or</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span>
                <span class="n">init_args</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Any</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kind</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="n">ABCMeta</span><span class="p">):</span>
                <span class="n">init_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_init_args</span><span class="p">(</span><span class="n">kind</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span><span class="o">.</span><span class="n">annotation</span> <span class="o">==</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">init_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;No type hint provided 😢&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">init_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kind</span><span class="o">.</span><span class="n">annotation</span>
        <span class="k">return</span> <span class="n">init_args</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-cli_discover-cli.discover.Discover.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#core-cli_discover-cli.discover.Discover.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the Discover class.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/discover.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Discover class.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_discover-cli.discover.Discover.discover_installed_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">discover_installed_extensions</span><span class="p">()</span></code>

<a href="#core-cli_discover-cli.discover.Discover.discover_installed_extensions" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Discover installed geniusrise extensions.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/discover.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">discover_installed_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Discover installed geniusrise extensions.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;🔎 Discovering installed extensions...&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">entry_point</span> <span class="ow">in</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">iter_entry_points</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;geniusrise.extensions&quot;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">module</span> <span class="o">=</span> <span class="n">entry_point</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_classes</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Error discovering classes in </span><span class="si">{</span><span class="n">entry_point</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_discover-cli.discover.Discover.find_classes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_classes</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>

<a href="#core-cli_discover-cli.discover.Discover.find_classes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Discover spout/bolt classes in a module.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>module</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Module to scan for spout/bolt classes.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/discover.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Discover spout/bolt classes in a module.</span>

<span class="sd">    Args:</span>
<span class="sd">        module (Any): Module to scan for spout/bolt classes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
        <span class="n">discovered</span><span class="p">:</span> <span class="n">DiscoveredSpout</span> <span class="o">|</span> <span class="n">DiscoveredBolt</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Spout</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span> <span class="o">!=</span> <span class="n">Spout</span><span class="p">:</span>
            <span class="n">discovered</span> <span class="o">=</span> <span class="n">DiscoveredSpout</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">init_args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_init_args</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚀 Discovered Spout </span><span class="si">{</span><span class="n">discovered</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">discovered</span>
        <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Bolt</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span> <span class="o">!=</span> <span class="n">Bolt</span><span class="p">:</span>
            <span class="n">discovered</span> <span class="o">=</span> <span class="n">DiscoveredBolt</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">klass</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">init_args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_init_args</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚡ Discovered Bolt </span><span class="si">{</span><span class="n">discovered</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">discovered</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_discover-cli.discover.Discover.get_init_args" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_init_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span></code>

<a href="#core-cli_discover-cli.discover.Discover.get_init_args" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extract initialization arguments of a class.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cls</code></td>
          <td>
                <code><span data-autorefs-optional="type">type</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Class to extract initialization arguments from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dict[str, Any]: Initialization arguments.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/discover.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_init_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract initialization arguments of a class.</span>

<span class="sd">    Args:</span>
<span class="sd">        cls (type): Class to extract initialization arguments from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Any]: Initialization arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">init_signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="n">init_params</span> <span class="o">=</span> <span class="n">init_signature</span><span class="o">.</span><span class="n">parameters</span>
    <span class="n">init_args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">kind</span> <span class="ow">in</span> <span class="n">init_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;kwargs&quot;</span> <span class="ow">or</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span>
            <span class="n">init_args</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Any</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kind</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="n">ABCMeta</span><span class="p">):</span>
            <span class="n">init_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_init_args</span><span class="p">(</span><span class="n">kind</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">kind</span><span class="o">.</span><span class="n">annotation</span> <span class="o">==</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">init_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;No type hint provided 😢&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">init_args</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kind</span><span class="o">.</span><span class="n">annotation</span>
    <span class="k">return</span> <span class="n">init_args</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_discover-cli.discover.Discover.import_module" class="doc doc-heading">
<code class="highlight language-python"><span class="n">import_module</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#core-cli_discover-cli.discover.Discover.import_module" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Import a module given its path.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the module.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Imported module.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/discover.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">import_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Import a module given its path.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): Path to the module.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: Imported module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">project_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">,</span> <span class="s2">&quot;../../../../&quot;</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
    <span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">project_root</span><span class="p">)</span>
    <span class="n">module_path</span> <span class="o">=</span> <span class="n">relative_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">module_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;__init__&quot;</span><span class="p">):</span>
        <span class="n">module_path</span> <span class="o">=</span> <span class="n">module_path</span><span class="p">[:</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span>  <span class="c1"># remove trailing &#39;__init__&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📦 Importing module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">))</span>
    <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">module</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_discover-cli.discover.Discover.scan_directory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scan_directory</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#core-cli_discover-cli.discover.Discover.scan_directory" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Scan for spouts/bolts in installed extensions and user's codebase.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>directory</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Directory to scan for user-defined spouts/bolts.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dict[str, Any]: Discovered spouts/bolts.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/discover.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">scan_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scan for spouts/bolts in installed extensions and user&#39;s codebase.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory (Optional[str]): Directory to scan for user-defined spouts/bolts.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Any]: Discovered spouts/bolts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span> <span class="k">if</span> <span class="n">directory</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;🔍 Starting discovery...&quot;</span><span class="p">))</span>

    <span class="c1"># Discover installed extensions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">discover_installed_extensions</span><span class="p">()</span>

    <span class="c1"># Discover user-defined spouts/bolts</span>
    <span class="k">if</span> <span class="n">directory</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;__init__.py&quot;</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_classes</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-cli_geniusctl"><h1 id="core-cli_geniusctl-geniusctl">Geniusctl<a class="headerlink" href="#core-cli_geniusctl-geniusctl" title="Permanent link">&para;</a></h1>
<p>The main command line application</p>


<div class="doc doc-object doc-module">


<a id="cli.geniusctl"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-cli_geniusctl-cli.geniusctl.GeniusCtl" class="doc doc-heading">
          <code>GeniusCtl</code>


<a href="#core-cli_geniusctl-cli.geniusctl.GeniusCtl" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Main class for managing the geniusrise CLI application.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/geniusctl.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GeniusCtl</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main class for managing the geniusrise CLI application.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize GeniusCtl.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory (str): The directory to scan for spouts and bolts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discover</span> <span class="o">=</span> <span class="n">Discover</span><span class="p">()</span>
        <span class="n">discovered_components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discover</span><span class="o">.</span><span class="n">scan_directory</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GENIUS_COMPONENTS_DIR&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>

        <span class="c1"># Segregate the discovered components based on their type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="n">component</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">discovered_components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">DiscoveredSpout</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span><span class="p">:</span> <span class="n">component</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">discovered_components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">DiscoveredBolt</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SpoutCtl</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BoltCtl</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a command-line parser with arguments for managing the application.</span>

<span class="sd">        Returns:</span>
<span class="sd">            argparse.ArgumentParser: Command-line parser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Manage the geniusrise application.&quot;</span><span class="p">)</span>
        <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>

        <span class="c1"># Create subparser for each discovered spout</span>
        <span class="k">for</span> <span class="n">spout_name</span><span class="p">,</span> <span class="n">discovered_spout</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">spout_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="n">spout_name</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Manage </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">spout_ctl</span> <span class="o">=</span> <span class="n">SpoutCtl</span><span class="p">(</span><span class="n">discovered_spout</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">spout_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">spout_ctl</span>
            <span class="n">spout_ctl</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">spout_parser</span><span class="p">)</span>

        <span class="c1"># Create subparser for each discovered bolt</span>
        <span class="k">for</span> <span class="n">bolt_name</span><span class="p">,</span> <span class="n">discovered_bolt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">bolt_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Manage </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">bolt_ctl</span> <span class="o">=</span> <span class="n">BoltCtl</span><span class="p">(</span><span class="n">discovered_bolt</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">bolt_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bolt_ctl</span>
            <span class="n">bolt_ctl</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">bolt_parser</span><span class="p">)</span>

        <span class="c1"># Create subparser for YAML operations</span>
        <span class="n">yaml_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;yaml&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Control spouts and bolts with a YAML file.&quot;</span><span class="p">)</span>
        <span class="c1"># Initialize YamlCtl with both spout_ctls and bolt_ctls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaml_ctl</span> <span class="o">=</span> <span class="n">YamlCtl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaml_ctl</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">yaml_parser</span><span class="p">)</span>

        <span class="c1"># Add a &#39;help&#39; command to print help for all spouts and bolts</span>
        <span class="n">help_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print help for all spouts and bolts.&quot;</span><span class="p">)</span>
        <span class="n">help_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;spout_or_bolt&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The spout or bolt to print help for.&quot;</span><span class="p">)</span>

        <span class="c1"># Add a &#39;list&#39; command to list all discovered spouts and bolts</span>
        <span class="n">list_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List all discovered spouts and bolts.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run the command-line interface.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running command: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;yaml&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yaml_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;help&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spout_ctl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">spout_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">bolt_ctl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">bolt_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spout</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No spouts or bolts discovered.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_spouts_and_bolts</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_spouts_and_bolts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all discovered spouts and bolts in a table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">(</span>
            <span class="p">[</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">),</span> <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">),</span> <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Methods&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">)],</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;l&quot;</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">spout_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="p">[</span><span class="n">spout_name</span><span class="p">]</span><span class="o">.</span><span class="n">klass</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">colored</span><span class="p">(</span><span class="n">spout_name</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">),</span>
                    <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Spout&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;fetch_&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]),</span>
                <span class="p">],</span>
                <span class="n">divider</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">bolt_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="p">[</span><span class="n">bolt_name</span><span class="p">]</span><span class="o">.</span><span class="n">klass</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">colored</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">),</span>
                    <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Bolt&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]),</span>
                <span class="p">],</span>
                <span class="n">divider</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cli</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Main function to be called when geniusrise is run from the command line.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_parser</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-cli_geniusctl-cli.geniusctl.GeniusCtl.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#core-cli_geniusctl-cli.geniusctl.GeniusCtl.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize GeniusCtl.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>directory</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The directory to scan for spouts and bolts.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/geniusctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize GeniusCtl.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory (str): The directory to scan for spouts and bolts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">discover</span> <span class="o">=</span> <span class="n">Discover</span><span class="p">()</span>
    <span class="n">discovered_components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discover</span><span class="o">.</span><span class="n">scan_directory</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GENIUS_COMPONENTS_DIR&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>

    <span class="c1"># Segregate the discovered components based on their type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">component</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">discovered_components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">DiscoveredSpout</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">component</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">discovered_components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">DiscoveredBolt</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SpoutCtl</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BoltCtl</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_geniusctl-cli.geniusctl.GeniusCtl.cli" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cli</span><span class="p">()</span></code>

<a href="#core-cli_geniusctl-cli.geniusctl.GeniusCtl.cli" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Main function to be called when geniusrise is run from the command line.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/geniusctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cli</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to be called when geniusrise is run from the command line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_parser</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_geniusctl-cli.geniusctl.GeniusCtl.create_parser" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_parser</span><span class="p">()</span></code>

<a href="#core-cli_geniusctl-cli.geniusctl.GeniusCtl.create_parser" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a command-line parser with arguments for managing the application.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>argparse.ArgumentParser: Command-line parser.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/geniusctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a command-line parser with arguments for managing the application.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: Command-line parser.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Manage the geniusrise application.&quot;</span><span class="p">)</span>
    <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>

    <span class="c1"># Create subparser for each discovered spout</span>
    <span class="k">for</span> <span class="n">spout_name</span><span class="p">,</span> <span class="n">discovered_spout</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">spout_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="n">spout_name</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Manage </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">spout_ctl</span> <span class="o">=</span> <span class="n">SpoutCtl</span><span class="p">(</span><span class="n">discovered_spout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">spout_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">spout_ctl</span>
        <span class="n">spout_ctl</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">spout_parser</span><span class="p">)</span>

    <span class="c1"># Create subparser for each discovered bolt</span>
    <span class="k">for</span> <span class="n">bolt_name</span><span class="p">,</span> <span class="n">discovered_bolt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">bolt_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Manage </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">bolt_ctl</span> <span class="o">=</span> <span class="n">BoltCtl</span><span class="p">(</span><span class="n">discovered_bolt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">bolt_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bolt_ctl</span>
        <span class="n">bolt_ctl</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">bolt_parser</span><span class="p">)</span>

    <span class="c1"># Create subparser for YAML operations</span>
    <span class="n">yaml_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;yaml&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Control spouts and bolts with a YAML file.&quot;</span><span class="p">)</span>
    <span class="c1"># Initialize YamlCtl with both spout_ctls and bolt_ctls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">yaml_ctl</span> <span class="o">=</span> <span class="n">YamlCtl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">yaml_ctl</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">yaml_parser</span><span class="p">)</span>

    <span class="c1"># Add a &#39;help&#39; command to print help for all spouts and bolts</span>
    <span class="n">help_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print help for all spouts and bolts.&quot;</span><span class="p">)</span>
    <span class="n">help_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;spout_or_bolt&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The spout or bolt to print help for.&quot;</span><span class="p">)</span>

    <span class="c1"># Add a &#39;list&#39; command to list all discovered spouts and bolts</span>
    <span class="n">list_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List all discovered spouts and bolts.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_geniusctl-cli.geniusctl.GeniusCtl.list_spouts_and_bolts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">list_spouts_and_bolts</span><span class="p">()</span></code>

<a href="#core-cli_geniusctl-cli.geniusctl.GeniusCtl.list_spouts_and_bolts" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List all discovered spouts and bolts in a table.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/geniusctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_spouts_and_bolts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List all discovered spouts and bolts in a table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">(</span>
        <span class="p">[</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">),</span> <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">),</span> <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Methods&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">)],</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;l&quot;</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">spout_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="p">[</span><span class="n">spout_name</span><span class="p">]</span><span class="o">.</span><span class="n">klass</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">colored</span><span class="p">(</span><span class="n">spout_name</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">),</span>
                <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Spout&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;fetch_&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]),</span>
            <span class="p">],</span>
            <span class="n">divider</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">bolt_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="p">[</span><span class="n">bolt_name</span><span class="p">]</span><span class="o">.</span><span class="n">klass</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">colored</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">),</span>
                <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Bolt&quot;</span><span class="p">,</span> <span class="s2">&quot;magenta&quot;</span><span class="p">),</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]),</span>
            <span class="p">],</span>
            <span class="n">divider</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_geniusctl-cli.geniusctl.GeniusCtl.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

<a href="#core-cli_geniusctl-cli.geniusctl.GeniusCtl.run" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run the command-line interface.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code><span data-autorefs-optional="argparse">argparse</span>.<span data-autorefs-optional-hover="argparse.Namespace">Namespace</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parsed command-line arguments.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/geniusctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the command-line interface.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running command: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;yaml&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaml_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;help&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spouts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">spout_or_bolt</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">spout_ctl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">spout_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">bolt_ctl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">bolt_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spout</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No spouts or bolts discovered.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_spouts_and_bolts</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-cli_schema"><h1 id="core-cli_schema-yaml-schema">YAML schema<a class="headerlink" href="#core-cli_schema-yaml-schema" title="Permanent link">&para;</a></h1>
<p>YAML schema definition as pydantic</p>


<div class="doc doc-object doc-module">


<a id="cli.schema"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.Bolt" class="doc doc-heading">
          <code>Bolt</code>


<a href="#core-cli_schema-cli.schema.Bolt" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines a bolt. A bolt has a name, method, optional arguments, input, output, state, and deployment.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Bolt</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines a bolt. A bolt has a name, method, optional arguments, input, output, state, and deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ExtraKwargs</span><span class="p">]</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">Input</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Output</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">State</span>
    <span class="n">deploy</span><span class="p">:</span> <span class="n">Deploy</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.Deploy" class="doc doc-heading">
          <code>Deploy</code>


<a href="#core-cli_schema-cli.schema.Deploy" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the deployment of the spout or bolt. The deployment can be of type k8s or ecs.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Deploy</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the deployment of the spout or bolt. The deployment can be of type k8s or ecs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DeployArgs</span><span class="p">]</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;k8s&quot;</span><span class="p">,</span> <span class="s2">&quot;ecs&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid deploy type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ecs&quot;</span><span class="p">:</span>
                <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;namespace&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;image&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;replicas&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;account_id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;cluster&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;subnet_ids&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;security_group_ids&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;log_group&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;memory&quot;</span><span class="p">,</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="n">field</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; for ecs deploy type&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;k8s&quot;</span><span class="p">:</span>
                <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;namespace&quot;</span><span class="p">,</span> <span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="s2">&quot;replicas&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">v</span><span class="p">[</span><span class="n">field</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required field &#39;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#39; for k8s deploy type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.DeployArgs" class="doc doc-heading">
          <code>DeployArgs</code>


<a href="#core-cli_schema-cli.schema.DeployArgs" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the arguments for the deployment. Depending on the type of deployment (k8s, ecs),
different arguments are required.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DeployArgs</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the arguments for the deployment. Depending on the type of deployment (k8s, ecs),</span>
<span class="sd">    different arguments are required.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">replicas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">account_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">cluster</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">subnet_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">security_group_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">log_group</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">cpu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">memory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">allow</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.ExtraKwargs" class="doc doc-heading">
          <code>ExtraKwargs</code>


<a href="#core-cli_schema-cli.schema.ExtraKwargs" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class is used to handle any extra arguments that are not explicitly defined in the schema.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ExtraKwargs</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is used to handle any extra arguments that are not explicitly defined in the schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">allow</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.Geniusfile" class="doc doc-heading">
          <code>Geniusfile</code>


<a href="#core-cli_schema-cli.schema.Geniusfile" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the overall structure of the YAML file. It includes a version, spouts, and bolts.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Geniusfile</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the overall structure of the YAML file. It includes a version, spouts, and bolts.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">spouts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Spout</span><span class="p">]</span>
    <span class="n">bolts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Bolt</span><span class="p">]</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_version</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid version&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.Input" class="doc doc-heading">
          <code>Input</code>


<a href="#core-cli_schema-cli.schema.Input" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the input of the bolt. The input can be of type batch, streaming, spout, or bolt.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Input</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the input of the bolt. The input can be of type batch, streaming, spout, or bolt.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InputArgs</span><span class="p">]</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">,</span> <span class="s2">&quot;spout&quot;</span><span class="p">,</span> <span class="s2">&quot;bolt&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid input type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;bucket&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;folder&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing required fields for batch input type&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;input_topic&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;kafka_servers&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing required fields for streaming input type&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;spout&quot;</span><span class="p">,</span> <span class="s2">&quot;bolt&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required fields for </span><span class="si">{</span><span class="n">values</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> input type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.InputArgs" class="doc doc-heading">
          <code>InputArgs</code>


<a href="#core-cli_schema-cli.schema.InputArgs" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the arguments for the input. Depending on the type of input (batch, streaming, spout, bolt),
different arguments are required.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InputArgs</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the arguments for the input. Depending on the type of input (batch, streaming, spout, bolt),</span>
<span class="sd">    different arguments are required.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">input_topic</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">kafka_servers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">output_folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">allow</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.Output" class="doc doc-heading">
          <code>Output</code>


<a href="#core-cli_schema-cli.schema.Output" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the output of the spout or bolt. The output can be of type batch or streaming.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Output</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the output of the spout or bolt. The output can be of type batch or streaming.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">OutputArgs</span><span class="p">]</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid output type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;bucket&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;folder&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing required fields for batch output type&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;output_topic&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;kafka_servers&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing required fields for streaming output type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.OutputArgs" class="doc doc-heading">
          <code>OutputArgs</code>


<a href="#core-cli_schema-cli.schema.OutputArgs" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the arguments for the output. Depending on the type of output (batch, streaming),
different arguments are required.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OutputArgs</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the arguments for the output. Depending on the type of output (batch, streaming),</span>
<span class="sd">    different arguments are required.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bucket</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">folder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">output_topic</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">kafka_servers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">allow</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.Spout" class="doc doc-heading">
          <code>Spout</code>


<a href="#core-cli_schema-cli.schema.Spout" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines a spout. A spout has a name, method, optional arguments, output, state, and deployment.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Spout</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines a spout. A spout has a name, method, optional arguments, output, state, and deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ExtraKwargs</span><span class="p">]</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Output</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">State</span>
    <span class="n">deploy</span><span class="p">:</span> <span class="n">Deploy</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.State" class="doc doc-heading">
          <code>State</code>


<a href="#core-cli_schema-cli.schema.State" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the state of the spout or bolt. The state can be of type in_memory, redis, postgres, or dynamodb.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">State</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the state of the spout or bolt. The state can be of type in_memory, redis, postgres, or dynamodb.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StateArgs</span><span class="p">]</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;redis&quot;</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid state type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;redis&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;redis_host&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;redis_port&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;redis_db&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing required fields for redis state type&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postgres&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">v</span>
                    <span class="ow">or</span> <span class="s2">&quot;postgres_host&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span>
                    <span class="ow">or</span> <span class="s2">&quot;postgres_port&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span>
                    <span class="ow">or</span> <span class="s2">&quot;postgres_user&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span>
                    <span class="ow">or</span> <span class="s2">&quot;postgres_password&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span>
                    <span class="ow">or</span> <span class="s2">&quot;postgres_database&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span>
                    <span class="ow">or</span> <span class="s2">&quot;postgres_table&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span>
                <span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing required fields for postgres state type&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;dynamodb_table_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;dynamodb_region_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing required fields for dynamodb state type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="core-cli_schema-cli.schema.StateArgs" class="doc doc-heading">
          <code>StateArgs</code>


<a href="#core-cli_schema-cli.schema.StateArgs" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>This class defines the arguments for the state. Depending on the type of state (in_memory, redis, postgres, dynamodb),
different arguments are required.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StateArgs</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class defines the arguments for the state. Depending on the type of state (in_memory, redis, postgres, dynamodb),</span>
<span class="sd">    different arguments are required.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">redis_host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">redis_port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">redis_db</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">postgres_host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">postgres_port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">postgres_user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">postgres_password</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">postgres_database</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">postgres_table</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">dynamodb_table_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">dynamodb_region_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="n">Extra</span><span class="o">.</span><span class="n">allow</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-cli_spoutctl"><h1 id="core-cli_spoutctl-spoutctl">Spoutctl<a class="headerlink" href="#core-cli_spoutctl-spoutctl" title="Permanent link">&para;</a></h1>
<p>The main spout controller</p>


<div class="doc doc-object doc-module">


<a id="cli.spoutctl"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-cli_spoutctl-cli.spoutctl.SpoutCtl" class="doc doc-heading">
          <code>SpoutCtl</code>


<a href="#core-cli_spoutctl-cli.spoutctl.SpoutCtl" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Class for managing spouts end-to-end from the command line.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/spoutctl.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SpoutCtl</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for managing spouts end-to-end from the command line.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discovered_spout</span><span class="p">:</span> <span class="n">DiscoveredSpout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize SpoutCtl with a DiscoveredSpout object.</span>

<span class="sd">        Args:</span>
<span class="sd">            discovered_spout (DiscoveredSpout): DiscoveredSpout object used to create and manage spouts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span> <span class="o">=</span> <span class="n">discovered_spout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add arguments to the command-line parser for managing the spout.</span>

<span class="sd">        Args:</span>
<span class="sd">            parser (argparse.ArgumentParser): Command-line parser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>

        <span class="c1"># Create subparser for &#39;create&#39; command</span>
        <span class="n">create_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Run a spout locally.&quot;</span><span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">],</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Choose the type of output configuration: batch or streaming.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;state_type&quot;</span><span class="p">,</span>
            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;redis&quot;</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">],</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select the type of state manager: in_memory, redis, postgres, or dynamodb.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_folder&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the directory where output files should be stored temporarily.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_kafka_topic&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka output topic for streaming spouts.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_kafka_cluster_connection_string&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka connection string for streaming spouts.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost:9092&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_s3_bucket&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the S3 bucket for output storage.&quot;</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--output_s3_folder&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indicate the S3 folder for output storage.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-s3-folder&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--redis_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--redis_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--redis_db&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the Redis database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_user&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the username for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_password&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the password for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_database&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mydatabase&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--postgres_table&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL table to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--dynamodb_table_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the DynamoDB table.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--dynamodb_region_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the AWS region for DynamoDB.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;us-west-2&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;method_name&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The name of the method to execute on the spout.&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--args&quot;</span><span class="p">,</span>
            <span class="n">nargs</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">REMAINDER</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Additional keyword arguments to pass to the spout.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Create subparser for &#39;help&#39; command</span>
        <span class="n">execute_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print help for the spout.&quot;</span><span class="p">)</span>
        <span class="n">execute_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The method to execute.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run the command-line interface.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running command: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="si">}</span><span class="s2"> :rocket:&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;run&quot;</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;output_type&quot;</span><span class="p">,</span> <span class="s2">&quot;state_type&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="s2">&quot;method_name&quot;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="p">[]</span>
                <span class="n">other_args</span><span class="p">,</span> <span class="n">other_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_args_kwargs</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_spout</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output_type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                <span class="c1"># Pass the method_name from args to execute_spout</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_spout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spout</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span><span class="p">,</span> <span class="o">**</span><span class="n">other_kwargs</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>

            <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;help&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span><span class="o">.</span><span class="n">klass</span><span class="o">.</span><span class="n">print_help</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span><span class="o">.</span><span class="n">klass</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ve</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value error: </span><span class="si">{</span><span class="n">ve</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">ae</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute error: </span><span class="si">{</span><span class="n">ae</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_args_kwargs</span><span class="p">(</span><span class="n">args_list</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">value</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">args_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>

    <span class="k">def</span> <span class="nf">create_spout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Spout</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a spout of a specific type.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">            state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">            **kwargs: Additional keyword arguments for initializing the spout.</span>
<span class="sd">                Keyword Arguments:</span>
<span class="sd">                    Batch output config:</span>
<span class="sd">                    - output_folder (str): The directory where output files should be stored temporarily.</span>
<span class="sd">                    - output_s3_bucket (str): The name of the S3 bucket for output storage.</span>
<span class="sd">                    - output_s3_folder (str): The S3 folder for output storage.</span>
<span class="sd">                    Streaming output config:</span>
<span class="sd">                    - output_kafka_topic (str): Kafka output topic for streaming spouts.</span>
<span class="sd">                    - output_kafka_cluster_connection_string (str): Kafka connection string for streaming spouts.</span>
<span class="sd">                    Redis state manager config:</span>
<span class="sd">                    - redis_host (str): The Redis host argument.</span>
<span class="sd">                    - redis_port (str): The Redis port argument.</span>
<span class="sd">                    - redis_db (str): The Redis database argument.</span>
<span class="sd">                    Postgres state manager config:</span>
<span class="sd">                    - postgres_host (str): The PostgreSQL host argument.</span>
<span class="sd">                    - postgres_port (str): The PostgreSQL port argument.</span>
<span class="sd">                    - postgres_user (str): The PostgreSQL user argument.</span>
<span class="sd">                    - postgres_password (str): The PostgreSQL password argument.</span>
<span class="sd">                    - postgres_database (str): The PostgreSQL database argument.</span>
<span class="sd">                    - postgres_table (str): The PostgreSQL table argument.</span>
<span class="sd">                    DynamoDB state manager config:</span>
<span class="sd">                    - dynamodb_table_name (str): The DynamoDB table name argument.</span>
<span class="sd">                    - dynamodb_region_name (str): The DynamoDB region name argument.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spout: The created spout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Spout</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">klass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span><span class="o">.</span><span class="n">klass</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span> <span class="n">state_type</span><span class="o">=</span><span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute_spout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spout</span><span class="p">:</span> <span class="n">Spout</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a method of a spout.</span>

<span class="sd">        Args:</span>
<span class="sd">            spout (Spout): The spout to execute.</span>
<span class="sd">            method_name (str): The name of the method to execute.</span>
<span class="sd">            *args: Positional arguments to pass to the method.</span>
<span class="sd">            **kwargs: Keyword arguments to pass to the method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: The result of the method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">spout</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-cli_spoutctl-cli.spoutctl.SpoutCtl.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">discovered_spout</span><span class="p">)</span></code>

<a href="#core-cli_spoutctl-cli.spoutctl.SpoutCtl.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize SpoutCtl with a DiscoveredSpout object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>discovered_spout</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.cli.discover.DiscoveredSpout">DiscoveredSpout</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DiscoveredSpout object used to create and manage spouts.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/spoutctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discovered_spout</span><span class="p">:</span> <span class="n">DiscoveredSpout</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize SpoutCtl with a DiscoveredSpout object.</span>

<span class="sd">    Args:</span>
<span class="sd">        discovered_spout (DiscoveredSpout): DiscoveredSpout object used to create and manage spouts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span> <span class="o">=</span> <span class="n">discovered_spout</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spout</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_spoutctl-cli.spoutctl.SpoutCtl.create_parser" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span></code>

<a href="#core-cli_spoutctl-cli.spoutctl.SpoutCtl.create_parser" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add arguments to the command-line parser for managing the spout.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parser</code></td>
          <td>
                <code><span data-autorefs-optional="argparse">argparse</span>.<span data-autorefs-optional-hover="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Command-line parser.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/spoutctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add arguments to the command-line parser for managing the spout.</span>

<span class="sd">    Args:</span>
<span class="sd">        parser (argparse.ArgumentParser): Command-line parser.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s2">&quot;command&quot;</span><span class="p">)</span>

    <span class="c1"># Create subparser for &#39;create&#39; command</span>
    <span class="n">create_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Run a spout locally.&quot;</span><span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;output_type&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;streaming&quot;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Choose the type of output configuration: batch or streaming.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;state_type&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;redis&quot;</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select the type of state manager: in_memory, redis, postgres, or dynamodb.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;in_memory&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_folder&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the directory where output files should be stored temporarily.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_kafka_topic&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka output topic for streaming spouts.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_kafka_cluster_connection_string&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Kafka connection string for streaming spouts.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost:9092&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_s3_bucket&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the S3 bucket for output storage.&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_s3_folder&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Indicate the S3 folder for output storage.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;my-s3-folder&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--redis_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--redis_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the Redis server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--redis_db&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the Redis database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_host&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the host address for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_port&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enter the port number for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_user&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the username for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_password&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the password for the PostgreSQL server.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_database&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL database to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mydatabase&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--postgres_table&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the PostgreSQL table to be used.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--dynamodb_table_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Provide the name of the DynamoDB table.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mytable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--dynamodb_region_name&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Specify the AWS region for DynamoDB.&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;us-west-2&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;method_name&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The name of the method to execute on the spout.&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">create_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--args&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">REMAINDER</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Additional keyword arguments to pass to the spout.&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Create subparser for &#39;help&#39; command</span>
    <span class="n">execute_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print help for the spout.&quot;</span><span class="p">)</span>
    <span class="n">execute_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The method to execute.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_spoutctl-cli.spoutctl.SpoutCtl.create_spout" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_spout</span><span class="p">(</span><span class="n">output_type</span><span class="p">,</span> <span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-cli_spoutctl-cli.spoutctl.SpoutCtl.create_spout" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a spout of a specific type.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of output config ("batch" or "streaming").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>state_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of state manager ("in_memory", "redis", "postgres", or "dynamodb").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments for initializing the spout.
Keyword Arguments:
    Batch output config:
    - output_folder (str): The directory where output files should be stored temporarily.
    - output_s3_bucket (str): The name of the S3 bucket for output storage.
    - output_s3_folder (str): The S3 folder for output storage.
    Streaming output config:
    - output_kafka_topic (str): Kafka output topic for streaming spouts.
    - output_kafka_cluster_connection_string (str): Kafka connection string for streaming spouts.
    Redis state manager config:
    - redis_host (str): The Redis host argument.
    - redis_port (str): The Redis port argument.
    - redis_db (str): The Redis database argument.
    Postgres state manager config:
    - postgres_host (str): The PostgreSQL host argument.
    - postgres_port (str): The PostgreSQL port argument.
    - postgres_user (str): The PostgreSQL user argument.
    - postgres_password (str): The PostgreSQL password argument.
    - postgres_database (str): The PostgreSQL database argument.
    - postgres_table (str): The PostgreSQL table argument.
    DynamoDB state manager config:
    - dynamodb_table_name (str): The DynamoDB table name argument.
    - dynamodb_region_name (str): The DynamoDB region name argument.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Spout</code></td>          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.Spout">Spout</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The created spout.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/spoutctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_spout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Spout</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a spout of a specific type.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">        state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">        **kwargs: Additional keyword arguments for initializing the spout.</span>
<span class="sd">            Keyword Arguments:</span>
<span class="sd">                Batch output config:</span>
<span class="sd">                - output_folder (str): The directory where output files should be stored temporarily.</span>
<span class="sd">                - output_s3_bucket (str): The name of the S3 bucket for output storage.</span>
<span class="sd">                - output_s3_folder (str): The S3 folder for output storage.</span>
<span class="sd">                Streaming output config:</span>
<span class="sd">                - output_kafka_topic (str): Kafka output topic for streaming spouts.</span>
<span class="sd">                - output_kafka_cluster_connection_string (str): Kafka connection string for streaming spouts.</span>
<span class="sd">                Redis state manager config:</span>
<span class="sd">                - redis_host (str): The Redis host argument.</span>
<span class="sd">                - redis_port (str): The Redis port argument.</span>
<span class="sd">                - redis_db (str): The Redis database argument.</span>
<span class="sd">                Postgres state manager config:</span>
<span class="sd">                - postgres_host (str): The PostgreSQL host argument.</span>
<span class="sd">                - postgres_port (str): The PostgreSQL port argument.</span>
<span class="sd">                - postgres_user (str): The PostgreSQL user argument.</span>
<span class="sd">                - postgres_password (str): The PostgreSQL password argument.</span>
<span class="sd">                - postgres_database (str): The PostgreSQL database argument.</span>
<span class="sd">                - postgres_table (str): The PostgreSQL table argument.</span>
<span class="sd">                DynamoDB state manager config:</span>
<span class="sd">                - dynamodb_table_name (str): The DynamoDB table name argument.</span>
<span class="sd">                - dynamodb_region_name (str): The DynamoDB region name argument.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Spout: The created spout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Spout</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">klass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span><span class="o">.</span><span class="n">klass</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span> <span class="n">state_type</span><span class="o">=</span><span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_spoutctl-cli.spoutctl.SpoutCtl.execute_spout" class="doc doc-heading">
<code class="highlight language-python"><span class="n">execute_spout</span><span class="p">(</span><span class="n">spout</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-cli_spoutctl-cli.spoutctl.SpoutCtl.execute_spout" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Execute a method of a spout.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spout</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.Spout">Spout</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spout to execute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the method to execute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positional arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the method.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/spoutctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">execute_spout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spout</span><span class="p">:</span> <span class="n">Spout</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute a method of a spout.</span>

<span class="sd">    Args:</span>
<span class="sd">        spout (Spout): The spout to execute.</span>
<span class="sd">        method_name (str): The name of the method to execute.</span>
<span class="sd">        *args: Positional arguments to pass to the method.</span>
<span class="sd">        **kwargs: Keyword arguments to pass to the method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The result of the method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">spout</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_spoutctl-cli.spoutctl.SpoutCtl.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

<a href="#core-cli_spoutctl-cli.spoutctl.SpoutCtl.run" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run the command-line interface.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code><span data-autorefs-optional="argparse">argparse</span>.<span data-autorefs-optional-hover="argparse.Namespace">Namespace</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parsed command-line arguments.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/spoutctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the command-line interface.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running command: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="si">}</span><span class="s2"> :rocket:&quot;</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;run&quot;</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;output_type&quot;</span><span class="p">,</span> <span class="s2">&quot;state_type&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="s2">&quot;method_name&quot;</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="p">[]</span>
            <span class="n">other_args</span><span class="p">,</span> <span class="n">other_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_args_kwargs</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_spout</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output_type</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># Pass the method_name from args to execute_spout</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_spout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spout</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span><span class="p">,</span> <span class="o">**</span><span class="n">other_kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s2">&quot;help&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span><span class="o">.</span><span class="n">klass</span><span class="o">.</span><span class="n">print_help</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discovered_spout</span><span class="o">.</span><span class="n">klass</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">ve</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value error: </span><span class="si">{</span><span class="n">ve</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">ae</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute error: </span><span class="si">{</span><span class="n">ae</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-cli_yamlctl"><h1 id="core-cli_yamlctl-yamlctl">YamlCtl<a class="headerlink" href="#core-cli_yamlctl-yamlctl" title="Permanent link">&para;</a></h1>
<p>Control spouts and bolts defined in a YAML file</p>


<div class="doc doc-object doc-module">


<a id="cli.yamlctl"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-cli_yamlctl-cli.yamlctl.YamlCtl" class="doc doc-heading">
          <code>YamlCtl</code>


<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Command-line interface for managing spouts and bolts based on a YAML configuration.</p>
<p>The YamlCtl class provides methods to run specific or all spouts and bolts defined in a YAML file.
The YAML file's structure is defined by the Geniusfile schema.</p>
<p>Example YAML structure:</p>
<pre><code>version: &quot;1&quot;
spouts:
  spout_name1:
    name: &quot;spout1&quot;
    method: &quot;method_name&quot;
    ...
bolts:
  bolt_name1:
    name: &quot;bolt1&quot;
    method: &quot;method_name&quot;
    ...
</code></pre>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>geniusfile</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.cli.schema.Geniusfile">Geniusfile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parsed YAML configuration.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>spout_ctls</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="geniusrise.cli.spoutctl.SpoutCtl">SpoutCtl</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of SpoutCtl instances.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>bolt_ctls</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="geniusrise.cli.boltctl.BoltCtl">BoltCtl</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of BoltCtl instances.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">YamlCtl</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Command-line interface for managing spouts and bolts based on a YAML configuration.</span>

<span class="sd">    The YamlCtl class provides methods to run specific or all spouts and bolts defined in a YAML file.</span>
<span class="sd">    The YAML file&#39;s structure is defined by the Geniusfile schema.</span>

<span class="sd">    Example YAML structure:</span>
<span class="sd">    ```</span>
<span class="sd">    version: &quot;1&quot;</span>
<span class="sd">    spouts:</span>
<span class="sd">      spout_name1:</span>
<span class="sd">        name: &quot;spout1&quot;</span>
<span class="sd">        method: &quot;method_name&quot;</span>
<span class="sd">        ...</span>
<span class="sd">    bolts:</span>
<span class="sd">      bolt_name1:</span>
<span class="sd">        name: &quot;bolt1&quot;</span>
<span class="sd">        method: &quot;method_name&quot;</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    Attributes:</span>
<span class="sd">        geniusfile (Geniusfile): Parsed YAML configuration.</span>
<span class="sd">        spout_ctls (Dict[str, SpoutCtl]): Dictionary of SpoutCtl instances.</span>
<span class="sd">        bolt_ctls (Dict[str, BoltCtl]): Dictionary of BoltCtl instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spout_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SpoutCtl</span><span class="p">],</span> <span class="n">bolt_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BoltCtl</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize YamlCtl with the path to the YAML file and control instances for spouts and bolts.</span>

<span class="sd">        Args:</span>
<span class="sd">            spout_ctls (Dict[str, SpoutCtl]): Dictionary of SpoutCtl instances.</span>
<span class="sd">            bolt_ctls (Dict[str, BoltCtl]): Dictionary of BoltCtl instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span> <span class="o">=</span> <span class="n">spout_ctls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span> <span class="o">=</span> <span class="n">bolt_ctls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and return the command-line parser for managing spouts and bolts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--spout&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of the specific spout to run.&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--bolt&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of the specific bolt to run.&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path of the genius.yml file, default to .&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run the command-line interface for managing spouts and bolts based on provided arguments.</span>
<span class="sd">        Please note that there is no ordering of the spouts and bolts in the YAML configuration.</span>
<span class="sd">        Each spout and bolt is an independent entity even when connected together.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span> <span class="o">=</span> <span class="n">Geniusfile</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">spout</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_spouts</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">bolt</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bolts</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">spout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_spout</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">spout</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">bolt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bolt</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">bolt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_spouts</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bolts</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">run_spouts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all spouts defined in the YAML configuration.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;:rocket: Running all spouts...&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">spout_name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_spout</span><span class="p">(</span><span class="n">spout_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_bolts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all bolts defined in the YAML configuration.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;:rocket: Running all bolts...&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">bolt_name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_bolt</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_spout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spout_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a specific spout based on its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            spout_name (str): Name of the spout to run.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">spout_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Spout </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="n">spout_ctl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">spout_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spout_ctl</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: SpoutCtl for </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:rocket: Running spout </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">))</span>
        <span class="n">flat_args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">spout</span><span class="o">.</span><span class="n">method</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_spout</span><span class="p">(</span><span class="n">spout</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">spout_name</span><span class="p">]</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
        <span class="n">namespace_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">flat_args</span><span class="p">)</span>
        <span class="n">spout_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">namespace_args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_bolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bolt_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a specific bolt based on its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            bolt_name (str): Name of the bolt to run.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bolt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Bolt </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="c1"># Resolve reference if input type is &quot;spout&quot; or &quot;bolt&quot;</span>
        <span class="k">if</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;spout&quot;</span><span class="p">,</span> <span class="s2">&quot;bolt&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Need referenced spouts or bolt to be mentioned here </span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="n">ref_name</span> <span class="o">=</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">name</span>
            <span class="n">resolved_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_reference</span><span class="p">(</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ref_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">resolved_output</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Failed to resolve reference for bolt </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">))</span>
                <span class="k">return</span>
            <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">resolved_output</span><span class="o">.</span><span class="n">type</span>  <span class="c1"># Set the resolved output type as the bolt&#39;s input type</span>
            <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">resolved_output</span><span class="o">.</span><span class="n">args</span>  <span class="c1"># Set the resolved output args as the bolt&#39;s input args</span>

        <span class="n">bolt_ctl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt_ctl</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: BoltCtl for </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:rocket: Running bolt </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">))</span>
        <span class="n">flat_args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">method</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_bolt</span><span class="p">(</span><span class="n">bolt</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">bolt_name</span><span class="p">]</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
        <span class="n">namespace_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">flat_args</span><span class="p">)</span>
        <span class="n">bolt_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">namespace_args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolve the reference of a bolt&#39;s input based on the input type (spout or bolt).</span>

<span class="sd">        Args:</span>
<span class="sd">            input_type (str): Type of the input (&quot;spout&quot; or &quot;bolt&quot;).</span>
<span class="sd">            ref_name (str): Name of the spout or bolt to refer to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Output: The output configuration of the referred spout or bolt.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;spout&quot;</span><span class="p">:</span>
            <span class="n">referred_spout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">referred_spout</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Referred spout </span><span class="si">{</span><span class="n">ref_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">referred_spout</span><span class="o">.</span><span class="n">output</span>
        <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;bolt&quot;</span><span class="p">:</span>
            <span class="n">referred_bolt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">referred_bolt</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Referred bolt </span><span class="si">{</span><span class="n">ref_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">referred_bolt</span><span class="o">.</span><span class="n">output</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Invalid reference type </span><span class="si">{</span><span class="n">input_type</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">no_type_check</span>
    <span class="k">def</span> <span class="nf">_convert_spout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spout</span><span class="p">:</span> <span class="n">Spout</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">spout_args</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Convert output</span>
        <span class="k">if</span> <span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_folder=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_s3_bucket=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">bucket</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_s3_folder=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_kafka_topic=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_kafka_cluster_connection_string=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kafka_servers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Convert state</span>
        <span class="k">if</span> <span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;redis&quot;</span><span class="p">:</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--redis_host=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">redis_host</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--redis_port=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">redis_port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--redis_db=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">redis_db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;postgres&quot;</span><span class="p">:</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_host=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_host</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_port=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_user=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_user</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_password=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_password</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_database=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_database</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_table=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--dynamodb_table_name=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dynamodb_table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">spout_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--dynamodb_region_name=</span><span class="si">{</span><span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dynamodb_region_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">spout_args</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">no_type_check</span>
    <span class="k">def</span> <span class="nf">_convert_bolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bolt</span><span class="p">:</span> <span class="n">Bolt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">bolt_args</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Convert input</span>
        <span class="k">if</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--input_folder=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--input_s3_bucket=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">bucket</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--input_s3_folder=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--input_kafka_topic=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">input_topic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--input_kafka_cluster_connection_string=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kafka_servers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Convert output</span>
        <span class="k">if</span> <span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_folder=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_s3_bucket=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">bucket</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_s3_folder=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_kafka_topic=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--output_kafka_cluster_connection_string=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">kafka_servers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Convert state</span>
        <span class="k">if</span> <span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;redis&quot;</span><span class="p">:</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--redis_host=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">redis_host</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--redis_port=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">redis_port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--redis_db=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">redis_db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;postgres&quot;</span><span class="p">:</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_host=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_host</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_port=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_user=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_user</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_password=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_password</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_database=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_database</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--postgres_table=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">postgres_table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--dynamodb_table_name=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dynamodb_table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">bolt_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--dynamodb_region_name=</span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">dynamodb_region_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bolt_args</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">spout_ctls</span><span class="p">,</span> <span class="n">bolt_ctls</span><span class="p">)</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize YamlCtl with the path to the YAML file and control instances for spouts and bolts.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spout_ctls</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="geniusrise.cli.spoutctl.SpoutCtl">SpoutCtl</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of SpoutCtl instances.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bolt_ctls</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="geniusrise.cli.boltctl.BoltCtl">BoltCtl</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of BoltCtl instances.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spout_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SpoutCtl</span><span class="p">],</span> <span class="n">bolt_ctls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BoltCtl</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize YamlCtl with the path to the YAML file and control instances for spouts and bolts.</span>

<span class="sd">    Args:</span>
<span class="sd">        spout_ctls (Dict[str, SpoutCtl]): Dictionary of SpoutCtl instances.</span>
<span class="sd">        bolt_ctls (Dict[str, BoltCtl]): Dictionary of BoltCtl instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span> <span class="o">=</span> <span class="n">spout_ctls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span> <span class="o">=</span> <span class="n">bolt_ctls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.create_parser" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.create_parser" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create and return the command-line parser for managing spouts and bolts.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create and return the command-line parser for managing spouts and bolts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--spout&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of the specific spout to run.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--bolt&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of the specific bolt to run.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--file&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path of the genius.yml file, default to .&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.resolve_reference" class="doc doc-heading">
<code class="highlight language-python"><span class="n">resolve_reference</span><span class="p">(</span><span class="n">input_type</span><span class="p">,</span> <span class="n">ref_name</span><span class="p">)</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.resolve_reference" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Resolve the reference of a bolt's input based on the input type (spout or bolt).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of the input ("spout" or "bolt").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ref_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the spout or bolt to refer to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Output</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output configuration of the referred spout or bolt.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resolve_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resolve the reference of a bolt&#39;s input based on the input type (spout or bolt).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_type (str): Type of the input (&quot;spout&quot; or &quot;bolt&quot;).</span>
<span class="sd">        ref_name (str): Name of the spout or bolt to refer to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Output: The output configuration of the referred spout or bolt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;spout&quot;</span><span class="p">:</span>
        <span class="n">referred_spout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">referred_spout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Referred spout </span><span class="si">{</span><span class="n">ref_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">referred_spout</span><span class="o">.</span><span class="n">output</span>
    <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;bolt&quot;</span><span class="p">:</span>
        <span class="n">referred_bolt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">referred_bolt</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Referred bolt </span><span class="si">{</span><span class="n">ref_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">referred_bolt</span><span class="o">.</span><span class="n">output</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Invalid reference type </span><span class="si">{</span><span class="n">input_type</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.run" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run the command-line interface for managing spouts and bolts based on provided arguments.
Please note that there is no ordering of the spouts and bolts in the YAML configuration.
Each spout and bolt is an independent entity even when connected together.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code><span data-autorefs-optional="argparse">argparse</span>.<span data-autorefs-optional-hover="argparse.Namespace">Namespace</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parsed command-line arguments.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the command-line interface for managing spouts and bolts based on provided arguments.</span>
<span class="sd">    Please note that there is no ordering of the spouts and bolts in the YAML configuration.</span>
<span class="sd">    Each spout and bolt is an independent entity even when connected together.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.Namespace): Parsed command-line arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span> <span class="o">=</span> <span class="n">Geniusfile</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">spout</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_spouts</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">bolt</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_bolts</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">spout</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_spout</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">spout</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">bolt</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_bolt</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">bolt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_spouts</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_bolts</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.run_bolt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_bolt</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">)</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.run_bolt" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run a specific bolt based on its name.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bolt_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the bolt to run.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_bolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bolt_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run a specific bolt based on its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        bolt_name (str): Name of the bolt to run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bolt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Bolt </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="c1"># Resolve reference if input type is &quot;spout&quot; or &quot;bolt&quot;</span>
    <span class="k">if</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;spout&quot;</span><span class="p">,</span> <span class="s2">&quot;bolt&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Need referenced spouts or bolt to be mentioned here </span><span class="si">{</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="n">ref_name</span> <span class="o">=</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">name</span>
        <span class="n">resolved_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_reference</span><span class="p">(</span><span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ref_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">resolved_output</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Failed to resolve reference for bolt </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">resolved_output</span><span class="o">.</span><span class="n">type</span>  <span class="c1"># Set the resolved output type as the bolt&#39;s input type</span>
        <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">resolved_output</span><span class="o">.</span><span class="n">args</span>  <span class="c1"># Set the resolved output args as the bolt&#39;s input args</span>

    <span class="n">bolt_ctl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">bolt_ctl</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: BoltCtl for </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:rocket: Running bolt </span><span class="si">{</span><span class="n">bolt_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">))</span>
    <span class="n">flat_args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">bolt</span><span class="o">.</span><span class="n">method</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_bolt</span><span class="p">(</span><span class="n">bolt</span><span class="p">)</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bolt_ctls</span><span class="p">[</span><span class="n">bolt_name</span><span class="p">]</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
    <span class="n">namespace_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">flat_args</span><span class="p">)</span>
    <span class="n">bolt_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">namespace_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.run_bolts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_bolts</span><span class="p">()</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.run_bolts" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run all bolts defined in the YAML configuration.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_bolts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all bolts defined in the YAML configuration.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;:rocket: Running all bolts...&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">bolt_name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">bolts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_bolt</span><span class="p">(</span><span class="n">bolt_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.run_spout" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_spout</span><span class="p">(</span><span class="n">spout_name</span><span class="p">)</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.run_spout" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run a specific spout based on its name.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spout_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the spout to run.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_spout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spout_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run a specific spout based on its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        spout_name (str): Name of the spout to run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">spout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">spout_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">spout</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: Spout </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="n">spout_ctl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">spout_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">spout_ctl</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:x: SpoutCtl for </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">))</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;:rocket: Running spout </span><span class="si">{</span><span class="n">spout_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">))</span>
    <span class="n">flat_args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">spout</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">spout</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">spout</span><span class="o">.</span><span class="n">method</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_spout</span><span class="p">(</span><span class="n">spout</span><span class="p">)</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spout_ctls</span><span class="p">[</span><span class="n">spout_name</span><span class="p">]</span><span class="o">.</span><span class="n">create_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
    <span class="n">namespace_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">flat_args</span><span class="p">)</span>
    <span class="n">spout_ctl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">namespace_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-cli_yamlctl-cli.yamlctl.YamlCtl.run_spouts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_spouts</span><span class="p">()</span></code>

<a href="#core-cli_yamlctl-cli.yamlctl.YamlCtl.run_spouts" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run all spouts defined in the YAML configuration.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/cli/yamlctl.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_spouts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all spouts defined in the YAML configuration.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">emoji</span><span class="o">.</span><span class="n">emojize</span><span class="p">(</span><span class="s2">&quot;:rocket: Running all spouts...&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">spout_name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">geniusfile</span><span class="o">.</span><span class="n">spouts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_spout</span><span class="p">(</span><span class="n">spout_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><h1 class='nav-section-title-end'>Ended: cli</h1>
                        <h2 class='nav-section-title' id='section-core'>
                            core <a class='headerlink' href='#section-core' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="core-core_bolt"><h1 id="core-core_bolt-bolt">Bolt<a class="headerlink" href="#core-core_bolt-bolt" title="Permanent link">&para;</a></h1>
<p>Core Bolt class</p>


<div class="doc doc-object doc-module">


<a id="core.bolt"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_bolt-core.bolt.Bolt" class="doc doc-heading">
          <code>Bolt</code>


<a href="#core-core_bolt-core.bolt.Bolt" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="core.task.Task">Task</span></code></p>

  
      <p>Base class for all bolts.</p>
<p>A bolt is a component that consumes streams of data, processes them, and possibly emits new data streams.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/bolt.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Bolt</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for all bolts.</span>

<span class="sd">    A bolt is a component that consumes streams of data, processes them, and possibly emits new data streams.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_config</span><span class="p">:</span> <span class="n">InputConfig</span><span class="p">,</span>
        <span class="n">output_config</span><span class="p">:</span> <span class="n">OutputConfig</span><span class="p">,</span>
        <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `Bolt` class is a base class for all bolts in the given context.</span>
<span class="sd">        It inherits from the `Task` class and provides methods for executing tasks</span>
<span class="sd">        both locally and remotely, as well as managing their state, with state management</span>
<span class="sd">        options including in-memory, Redis, PostgreSQL, and DynamoDB,</span>
<span class="sd">        and input and output configurations for batch or streaming data.</span>

<span class="sd">        The `Bolt` class uses the `InputConfig`, `OutputConfig` and `StateManager` classes, which are abstract base</span>
<span class="sd">        classes for managing input configurations, output configurations and states, respectively. The `InputConfig` and</span>
<span class="sd">        `OutputConfig` classes each have two subclasses: `StreamingInputConfig`, `BatchInputConfig`, `StreamingOutputConfig`</span>
<span class="sd">        and `BatchOutputConfig`, which manage streaming and batch input and output configurations, respectively.</span>
<span class="sd">        The `StateManager` class is used to get and set state, and it has several subclasses for different types of state managers.</span>

<span class="sd">        The `Bolt` class also uses the `ECSManager` and `K8sManager` classes in the `execute_remote` method,</span>
<span class="sd">        which are used to manage tasks on Amazon ECS and Kubernetes, respectively.</span>

<span class="sd">        Usage:</span>
<span class="sd">            - Create an instance of the Bolt class by providing an InputConfig object, an OutputConfig object and a StateManager object.</span>
<span class="sd">            - The InputConfig object specifies the input configuration for the bolt.</span>
<span class="sd">            - The OutputConfig object specifies the output configuration for the bolt.</span>
<span class="sd">            - The StateManager object handles the management of the bolt&#39;s state.</span>

<span class="sd">        Example:</span>
<span class="sd">            input_config = InputConfig(...)</span>
<span class="sd">            output_config = OutputConfig(...)</span>
<span class="sd">            state_manager = StateManager(...)</span>
<span class="sd">            bolt = Bolt(input_config, output_config, state_manager)</span>

<span class="sd">        Args:</span>
<span class="sd">            input_config (InputConfig): The input configuration.</span>
<span class="sd">            output_config (OutputConfig): The output configuration.</span>
<span class="sd">            state_manager (StateManager): The state manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span> <span class="o">=</span> <span class="n">input_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span> <span class="o">=</span> <span class="n">output_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span> <span class="o">=</span> <span class="n">state_manager</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a method locally and manage the state.</span>

<span class="sd">        Args:</span>
<span class="sd">            method_name (str): The name of the method to execute.</span>
<span class="sd">            *args: Positional arguments to pass to the method.</span>
<span class="sd">            **kwargs: Keyword arguments to pass to the method.</span>
<span class="sd">                Keyword Arguments:</span>
<span class="sd">                    - Additional keyword arguments specific to the method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: The result of the method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get the type of state manager</span>
            <span class="n">state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

            <span class="c1"># Save the current set of class variables to the state manager</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">{})</span>

            <span class="c1"># Copy input data to local or connect to kafka and pass on the details</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="p">)</span> <span class="ow">is</span> <span class="n">BatchInputConfig</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="o">.</span><span class="n">copy_from_remote</span><span class="p">()</span>
                <span class="n">input_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_folder</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="p">)</span> <span class="ow">is</span> <span class="n">StreamingInputConfig</span><span class="p">:</span>
                <span class="n">kafka_consumer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;kafka_consumer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kafka_consumer</span>

            <span class="c1"># Execute the task&#39;s method</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># Flush the output config</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

            <span class="c1"># Store the state as successful in the state manager</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;failed&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to execute method &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">klass</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">input_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Bolt&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a bolt of a specific type.</span>

<span class="sd">        This static method is used to create a bolt of a specific type. It takes in an input type,</span>
<span class="sd">        an output type, a state type, and additional keyword arguments for initializing the bolt.</span>

<span class="sd">        The method creates the input config, output config, and state manager based on the provided types,</span>
<span class="sd">        and then creates and returns a bolt using these configurations.</span>

<span class="sd">        Args:</span>
<span class="sd">            klass (type): The Bolt class to create.</span>
<span class="sd">            input_type (str): The type of input config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">            output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">            state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">            **kwargs: Additional keyword arguments for initializing the bolt.</span>
<span class="sd">                Keyword Arguments:</span>
<span class="sd">                    Batch input config:</span>
<span class="sd">                    - input_folder (str): The input folder argument.</span>
<span class="sd">                    - input_s3_bucket (str): The input bucket argument.</span>
<span class="sd">                    - input_s3_folder (str): The input S3 folder argument.</span>
<span class="sd">                    Batch outupt config:</span>
<span class="sd">                    - output_folder (str): The output folder argument.</span>
<span class="sd">                    - output_s3_bucket (str): The output bucket argument.</span>
<span class="sd">                    - output_s3_folder (str): The output S3 folder argument.</span>
<span class="sd">                    Streaming input config:</span>
<span class="sd">                    - input_kafka_cluster_connection_string (str): The input Kafka servers argument.</span>
<span class="sd">                    - input_kafka_topic (str): The input kafka topic argument.</span>
<span class="sd">                    - input_kafka_consumer_group_id (str): The Kafka consumer group id.</span>
<span class="sd">                    Streaming output config:</span>
<span class="sd">                    - output_kafka_cluster_connection_string (str): The output Kafka servers argument.</span>
<span class="sd">                    - output_kafka_topic (str): The output kafka topic argument.</span>
<span class="sd">                    Redis state manager config:</span>
<span class="sd">                    - redis_host (str): The Redis host argument.</span>
<span class="sd">                    - redis_port (str): The Redis port argument.</span>
<span class="sd">                    - redis_db (str): The Redis database argument.</span>
<span class="sd">                    Postgres state manager config:</span>
<span class="sd">                    - postgres_host (str): The PostgreSQL host argument.</span>
<span class="sd">                    - postgres_port (str): The PostgreSQL port argument.</span>
<span class="sd">                    - postgres_user (str): The PostgreSQL user argument.</span>
<span class="sd">                    - postgres_password (str): The PostgreSQL password argument.</span>
<span class="sd">                    - postgres_database (str): The PostgreSQL database argument.</span>
<span class="sd">                    - postgres_table (str): The PostgreSQL table argument.</span>
<span class="sd">                    DynamoDB state manager config:</span>
<span class="sd">                    - dynamodb_table_name (str): The DynamoDB table name argument.</span>
<span class="sd">                    - dynamodb_region_name (str): The DynamoDB region name argument.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Bolt: The created bolt.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If an invalid input type, output type, or state type is provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create the input config</span>
        <span class="n">input_config</span><span class="p">:</span> <span class="n">BatchInputConfig</span> <span class="o">|</span> <span class="n">StreamingInputConfig</span>
        <span class="k">if</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
            <span class="n">input_config</span> <span class="o">=</span> <span class="n">BatchInputConfig</span><span class="p">(</span>
                <span class="n">input_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
                <span class="n">bucket</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_s3_bucket&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_s3_bucket&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">s3_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_s3_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_s3_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
            <span class="n">input_config</span> <span class="o">=</span> <span class="n">StreamingInputConfig</span><span class="p">(</span>
                <span class="n">input_topic</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_kafka_topic&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_kafka_topic&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">kafka_cluster_connection_string</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_kafka_cluster_connection_string&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;input_kafka_cluster_connection_string&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
                <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">group_id</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_kafka_consumer_group_id&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_kafka_consumer_group_id&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid input type: </span><span class="si">{</span><span class="n">input_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Create the output config</span>
        <span class="n">output_config</span><span class="p">:</span> <span class="n">BatchOutputConfig</span> <span class="o">|</span> <span class="n">StreamingOutputConfig</span>
        <span class="k">if</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
            <span class="n">output_config</span> <span class="o">=</span> <span class="n">BatchOutputConfig</span><span class="p">(</span>
                <span class="n">output_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
                <span class="n">bucket</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_s3_bucket&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_s3_bucket&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
                <span class="n">s3_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_s3_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_s3_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
            <span class="n">output_config</span> <span class="o">=</span> <span class="n">StreamingOutputConfig</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_kafka_topic&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_kafka_topic&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_kafka_cluster_connection_string&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;output_kafka_cluster_connection_string&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
                <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid output type: </span><span class="si">{</span><span class="n">output_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Create the state manager</span>
        <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span>
        <span class="k">if</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;in_memory&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">InMemoryStateManager</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;redis&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">RedisStateManager</span><span class="p">(</span>
                <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">db</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_db&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_db&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;postgres&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">PostgresStateManager</span><span class="p">(</span>
                <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">user</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_user&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_user&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">password</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_password&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_password&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">database</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_database&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_database&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">table</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_table&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_table&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">DynamoDBStateManager</span><span class="p">(</span>
                <span class="n">table_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_table_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_table_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">region_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_region_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_region_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid state type: </span><span class="si">{</span><span class="n">state_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Create the bolt</span>
        <span class="n">bolt</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span>
            <span class="n">input_config</span><span class="o">=</span><span class="n">input_config</span><span class="p">,</span>
            <span class="n">output_config</span><span class="o">=</span><span class="n">output_config</span><span class="p">,</span>
            <span class="n">state_manager</span><span class="o">=</span><span class="n">state_manager</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">bolt</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_bolt-core.bolt.Bolt.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-core_bolt-core.bolt.Bolt.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Execute a method locally and manage the state.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>method_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the method to execute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positional arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments to pass to the method.
Keyword Arguments:
    - Additional keyword arguments specific to the method.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the method.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/bolt.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute a method locally and manage the state.</span>

<span class="sd">    Args:</span>
<span class="sd">        method_name (str): The name of the method to execute.</span>
<span class="sd">        *args: Positional arguments to pass to the method.</span>
<span class="sd">        **kwargs: Keyword arguments to pass to the method.</span>
<span class="sd">            Keyword Arguments:</span>
<span class="sd">                - Additional keyword arguments specific to the method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The result of the method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the type of state manager</span>
        <span class="n">state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Save the current set of class variables to the state manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Copy input data to local or connect to kafka and pass on the details</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="p">)</span> <span class="ow">is</span> <span class="n">BatchInputConfig</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="o">.</span><span class="n">copy_from_remote</span><span class="p">()</span>
            <span class="n">input_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_folder</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="p">)</span> <span class="ow">is</span> <span class="n">StreamingInputConfig</span><span class="p">:</span>
            <span class="n">kafka_consumer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;kafka_consumer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kafka_consumer</span>

        <span class="c1"># Execute the task&#39;s method</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Flush the output config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="c1"># Store the state as successful in the state manager</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;failed&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to execute method &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_bolt-core.bolt.Bolt.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_config</span><span class="p">,</span> <span class="n">output_config</span><span class="p">,</span> <span class="n">state_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-core_bolt-core.bolt.Bolt.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The <code>Bolt</code> class is a base class for all bolts in the given context.
It inherits from the <code>Task</code> class and provides methods for executing tasks
both locally and remotely, as well as managing their state, with state management
options including in-memory, Redis, PostgreSQL, and DynamoDB,
and input and output configurations for batch or streaming data.</p>
<p>The <code>Bolt</code> class uses the <code>InputConfig</code>, <code>OutputConfig</code> and <code>StateManager</code> classes, which are abstract base
classes for managing input configurations, output configurations and states, respectively. The <code>InputConfig</code> and
<code>OutputConfig</code> classes each have two subclasses: <code>StreamingInputConfig</code>, <code>BatchInputConfig</code>, <code>StreamingOutputConfig</code>
and <code>BatchOutputConfig</code>, which manage streaming and batch input and output configurations, respectively.
The <code>StateManager</code> class is used to get and set state, and it has several subclasses for different types of state managers.</p>
<p>The <code>Bolt</code> class also uses the <code>ECSManager</code> and <code>K8sManager</code> classes in the <code>execute_remote</code> method,
which are used to manage tasks on Amazon ECS and Kubernetes, respectively.</p>

<details class="usage" open>
  <summary>Usage</summary>
  <ul>
<li>Create an instance of the Bolt class by providing an InputConfig object, an OutputConfig object and a StateManager object.</li>
<li>The InputConfig object specifies the input configuration for the bolt.</li>
<li>The OutputConfig object specifies the output configuration for the bolt.</li>
<li>The StateManager object handles the management of the bolt's state.</li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <p>input_config = InputConfig(...)
output_config = OutputConfig(...)
state_manager = StateManager(...)
bolt = Bolt(input_config, output_config, state_manager)</p>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_config</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.data.InputConfig">InputConfig</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input configuration.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_config</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.data.OutputConfig">OutputConfig</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output configuration.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>state_manager</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.state.StateManager">StateManager</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state manager.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/bolt.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">input_config</span><span class="p">:</span> <span class="n">InputConfig</span><span class="p">,</span>
    <span class="n">output_config</span><span class="p">:</span> <span class="n">OutputConfig</span><span class="p">,</span>
    <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `Bolt` class is a base class for all bolts in the given context.</span>
<span class="sd">    It inherits from the `Task` class and provides methods for executing tasks</span>
<span class="sd">    both locally and remotely, as well as managing their state, with state management</span>
<span class="sd">    options including in-memory, Redis, PostgreSQL, and DynamoDB,</span>
<span class="sd">    and input and output configurations for batch or streaming data.</span>

<span class="sd">    The `Bolt` class uses the `InputConfig`, `OutputConfig` and `StateManager` classes, which are abstract base</span>
<span class="sd">    classes for managing input configurations, output configurations and states, respectively. The `InputConfig` and</span>
<span class="sd">    `OutputConfig` classes each have two subclasses: `StreamingInputConfig`, `BatchInputConfig`, `StreamingOutputConfig`</span>
<span class="sd">    and `BatchOutputConfig`, which manage streaming and batch input and output configurations, respectively.</span>
<span class="sd">    The `StateManager` class is used to get and set state, and it has several subclasses for different types of state managers.</span>

<span class="sd">    The `Bolt` class also uses the `ECSManager` and `K8sManager` classes in the `execute_remote` method,</span>
<span class="sd">    which are used to manage tasks on Amazon ECS and Kubernetes, respectively.</span>

<span class="sd">    Usage:</span>
<span class="sd">        - Create an instance of the Bolt class by providing an InputConfig object, an OutputConfig object and a StateManager object.</span>
<span class="sd">        - The InputConfig object specifies the input configuration for the bolt.</span>
<span class="sd">        - The OutputConfig object specifies the output configuration for the bolt.</span>
<span class="sd">        - The StateManager object handles the management of the bolt&#39;s state.</span>

<span class="sd">    Example:</span>
<span class="sd">        input_config = InputConfig(...)</span>
<span class="sd">        output_config = OutputConfig(...)</span>
<span class="sd">        state_manager = StateManager(...)</span>
<span class="sd">        bolt = Bolt(input_config, output_config, state_manager)</span>

<span class="sd">    Args:</span>
<span class="sd">        input_config (InputConfig): The input configuration.</span>
<span class="sd">        output_config (OutputConfig): The output configuration.</span>
<span class="sd">        state_manager (StateManager): The state manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_config</span> <span class="o">=</span> <span class="n">input_config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span> <span class="o">=</span> <span class="n">output_config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span> <span class="o">=</span> <span class="n">state_manager</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_bolt-core.bolt.Bolt.create" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="n">input_type</span><span class="p">,</span> <span class="n">output_type</span><span class="p">,</span> <span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#core-core_bolt-core.bolt.Bolt.create" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a bolt of a specific type.</p>
<p>This static method is used to create a bolt of a specific type. It takes in an input type,
an output type, a state type, and additional keyword arguments for initializing the bolt.</p>
<p>The method creates the input config, output config, and state manager based on the provided types,
and then creates and returns a bolt using these configurations.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>klass</code></td>
          <td>
                <code><span data-autorefs-optional="type">type</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Bolt class to create.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of input config ("batch" or "streaming").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of output config ("batch" or "streaming").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>state_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of state manager ("in_memory", "redis", "postgres", or "dynamodb").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments for initializing the bolt.
Keyword Arguments:
    Batch input config:
    - input_folder (str): The input folder argument.
    - input_s3_bucket (str): The input bucket argument.
    - input_s3_folder (str): The input S3 folder argument.
    Batch outupt config:
    - output_folder (str): The output folder argument.
    - output_s3_bucket (str): The output bucket argument.
    - output_s3_folder (str): The output S3 folder argument.
    Streaming input config:
    - input_kafka_cluster_connection_string (str): The input Kafka servers argument.
    - input_kafka_topic (str): The input kafka topic argument.
    - input_kafka_consumer_group_id (str): The Kafka consumer group id.
    Streaming output config:
    - output_kafka_cluster_connection_string (str): The output Kafka servers argument.
    - output_kafka_topic (str): The output kafka topic argument.
    Redis state manager config:
    - redis_host (str): The Redis host argument.
    - redis_port (str): The Redis port argument.
    - redis_db (str): The Redis database argument.
    Postgres state manager config:
    - postgres_host (str): The PostgreSQL host argument.
    - postgres_port (str): The PostgreSQL port argument.
    - postgres_user (str): The PostgreSQL user argument.
    - postgres_password (str): The PostgreSQL password argument.
    - postgres_database (str): The PostgreSQL database argument.
    - postgres_table (str): The PostgreSQL table argument.
    DynamoDB state manager config:
    - dynamodb_table_name (str): The DynamoDB table name argument.
    - dynamodb_region_name (str): The DynamoDB region name argument.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Bolt</code></td>          <td>
                <code><span data-autorefs-optional-hover="core.bolt.Bolt">Bolt</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The created bolt.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If an invalid input type, output type, or state type is provided.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/bolt.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">klass</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">input_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Bolt&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a bolt of a specific type.</span>

<span class="sd">    This static method is used to create a bolt of a specific type. It takes in an input type,</span>
<span class="sd">    an output type, a state type, and additional keyword arguments for initializing the bolt.</span>

<span class="sd">    The method creates the input config, output config, and state manager based on the provided types,</span>
<span class="sd">    and then creates and returns a bolt using these configurations.</span>

<span class="sd">    Args:</span>
<span class="sd">        klass (type): The Bolt class to create.</span>
<span class="sd">        input_type (str): The type of input config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">        output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">        state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">        **kwargs: Additional keyword arguments for initializing the bolt.</span>
<span class="sd">            Keyword Arguments:</span>
<span class="sd">                Batch input config:</span>
<span class="sd">                - input_folder (str): The input folder argument.</span>
<span class="sd">                - input_s3_bucket (str): The input bucket argument.</span>
<span class="sd">                - input_s3_folder (str): The input S3 folder argument.</span>
<span class="sd">                Batch outupt config:</span>
<span class="sd">                - output_folder (str): The output folder argument.</span>
<span class="sd">                - output_s3_bucket (str): The output bucket argument.</span>
<span class="sd">                - output_s3_folder (str): The output S3 folder argument.</span>
<span class="sd">                Streaming input config:</span>
<span class="sd">                - input_kafka_cluster_connection_string (str): The input Kafka servers argument.</span>
<span class="sd">                - input_kafka_topic (str): The input kafka topic argument.</span>
<span class="sd">                - input_kafka_consumer_group_id (str): The Kafka consumer group id.</span>
<span class="sd">                Streaming output config:</span>
<span class="sd">                - output_kafka_cluster_connection_string (str): The output Kafka servers argument.</span>
<span class="sd">                - output_kafka_topic (str): The output kafka topic argument.</span>
<span class="sd">                Redis state manager config:</span>
<span class="sd">                - redis_host (str): The Redis host argument.</span>
<span class="sd">                - redis_port (str): The Redis port argument.</span>
<span class="sd">                - redis_db (str): The Redis database argument.</span>
<span class="sd">                Postgres state manager config:</span>
<span class="sd">                - postgres_host (str): The PostgreSQL host argument.</span>
<span class="sd">                - postgres_port (str): The PostgreSQL port argument.</span>
<span class="sd">                - postgres_user (str): The PostgreSQL user argument.</span>
<span class="sd">                - postgres_password (str): The PostgreSQL password argument.</span>
<span class="sd">                - postgres_database (str): The PostgreSQL database argument.</span>
<span class="sd">                - postgres_table (str): The PostgreSQL table argument.</span>
<span class="sd">                DynamoDB state manager config:</span>
<span class="sd">                - dynamodb_table_name (str): The DynamoDB table name argument.</span>
<span class="sd">                - dynamodb_region_name (str): The DynamoDB region name argument.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Bolt: The created bolt.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If an invalid input type, output type, or state type is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create the input config</span>
    <span class="n">input_config</span><span class="p">:</span> <span class="n">BatchInputConfig</span> <span class="o">|</span> <span class="n">StreamingInputConfig</span>
    <span class="k">if</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
        <span class="n">input_config</span> <span class="o">=</span> <span class="n">BatchInputConfig</span><span class="p">(</span>
            <span class="n">input_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
            <span class="n">bucket</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_s3_bucket&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_s3_bucket&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">s3_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_s3_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_s3_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
        <span class="n">input_config</span> <span class="o">=</span> <span class="n">StreamingInputConfig</span><span class="p">(</span>
            <span class="n">input_topic</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_kafka_topic&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_kafka_topic&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">kafka_cluster_connection_string</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_kafka_cluster_connection_string&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;input_kafka_cluster_connection_string&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">group_id</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;input_kafka_consumer_group_id&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;input_kafka_consumer_group_id&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid input type: </span><span class="si">{</span><span class="n">input_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create the output config</span>
    <span class="n">output_config</span><span class="p">:</span> <span class="n">BatchOutputConfig</span> <span class="o">|</span> <span class="n">StreamingOutputConfig</span>
    <span class="k">if</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
        <span class="n">output_config</span> <span class="o">=</span> <span class="n">BatchOutputConfig</span><span class="p">(</span>
            <span class="n">output_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
            <span class="n">bucket</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_s3_bucket&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_s3_bucket&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
            <span class="n">s3_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_s3_folder&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_s3_folder&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
        <span class="n">output_config</span> <span class="o">=</span> <span class="n">StreamingOutputConfig</span><span class="p">(</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_kafka_topic&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;output_kafka_topic&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;output_kafka_cluster_connection_string&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;output_kafka_cluster_connection_string&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid output type: </span><span class="si">{</span><span class="n">output_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create the state manager</span>
    <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span>
    <span class="k">if</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;in_memory&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">InMemoryStateManager</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;redis&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">RedisStateManager</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">db</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_db&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_db&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;postgres&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">PostgresStateManager</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">user</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_user&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_user&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_password&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_password&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_database&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_database&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">table</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_table&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_table&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">DynamoDBStateManager</span><span class="p">(</span>
            <span class="n">table_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_table_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_table_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">region_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_region_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_region_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid state type: </span><span class="si">{</span><span class="n">state_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create the bolt</span>
    <span class="n">bolt</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span>
        <span class="n">input_config</span><span class="o">=</span><span class="n">input_config</span><span class="p">,</span>
        <span class="n">output_config</span><span class="o">=</span><span class="n">output_config</span><span class="p">,</span>
        <span class="n">state_manager</span><span class="o">=</span><span class="n">state_manager</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">bolt</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_spout"><h1 id="core-core_spout-spout">Spout<a class="headerlink" href="#core-core_spout-spout" title="Permanent link">&para;</a></h1>
<p>Core Spout class</p>


<div class="doc doc-object doc-module">


<a id="core.spout"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_spout-core.spout.Spout" class="doc doc-heading">
          <code>Spout</code>


<a href="#core-core_spout-core.spout.Spout" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="geniusrise.core.task.Task">Task</span></code></p>

  
      <p>Base class for all spouts.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/spout.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Spout</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for all spouts.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_config</span><span class="p">:</span> <span class="n">OutputConfig</span><span class="p">,</span> <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `Spout` class is a base class for all spouts in the given context.</span>
<span class="sd">        It inherits from the `Task` class and provides methods for executing tasks</span>
<span class="sd">        both locally and remotely, as well as managing their state, with state management</span>
<span class="sd">        options including in-memory, Redis, PostgreSQL, and DynamoDB,</span>
<span class="sd">        and output configurations for batch or streaming data.</span>

<span class="sd">        The `Spout` class uses the `OutputConfig` and `StateManager` classes, which are abstract base</span>
<span class="sd">         classes for managing output configurations and states, respectively. The `OutputConfig` class</span>
<span class="sd">         has two subclasses: `StreamingOutputConfig` and `BatchOutputConfig`, which manage streaming and</span>
<span class="sd">         batch output configurations, respectively. The `StateManager` class is used to get and set state,</span>
<span class="sd">         and it has several subclasses for different types of state managers.</span>

<span class="sd">        The `Spout` class also uses the `ECSManager` and `K8sManager` classes in the `execute_remote` method,</span>
<span class="sd">        which are used to manage tasks on Amazon ECS and Kubernetes, respectively.</span>

<span class="sd">        Usage:</span>
<span class="sd">            - Create an instance of the Spout class by providing an OutputConfig object and a StateManager object.</span>
<span class="sd">            - The OutputConfig object specifies the output configuration for the spout.</span>
<span class="sd">            - The StateManager object handles the management of the spout&#39;s state.</span>

<span class="sd">        Example:</span>
<span class="sd">            output_config = OutputConfig(...)</span>
<span class="sd">            state_manager = StateManager(...)</span>
<span class="sd">            spout = Spout(output_config, state_manager)</span>

<span class="sd">        Args:</span>
<span class="sd">            output_config (OutputConfig): The output configuration.</span>
<span class="sd">            state_manager (StateManager): The state manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span> <span class="o">=</span> <span class="n">output_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span> <span class="o">=</span> <span class="n">state_manager</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a method locally and manage the state.</span>

<span class="sd">        Args:</span>
<span class="sd">            method_name (str): The name of the method to execute.</span>
<span class="sd">            *args: Positional arguments to pass to the method.</span>
<span class="sd">            **kwargs: Keyword arguments to pass to the method.</span>
<span class="sd">                Keyword Arguments:</span>
<span class="sd">                    - Additional keyword arguments specific to the method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: The result of the method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get the type of state manager</span>
            <span class="n">state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

            <span class="c1"># Save the current set of class variables to the state manager</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">{})</span>

            <span class="c1"># Execute the task&#39;s method</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># Flush the output config</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

            <span class="c1"># Store the state as successful in the state manager</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;failed&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to execute method &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">klass</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Spout&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a spout of a specific type.</span>

<span class="sd">        Args:</span>
<span class="sd">            klass (type): The Spout class to create.</span>
<span class="sd">            output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">            state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">            **kwargs: Additional keyword arguments for initializing the spout.</span>
<span class="sd">                Keyword Arguments:</span>
<span class="sd">                    Batch output config:</span>
<span class="sd">                    - output_folder (str): The directory where output files should be stored temporarily.</span>
<span class="sd">                    - output_s3_bucket (str): The name of the S3 bucket for output storage.</span>
<span class="sd">                    - output_s3_folder (str): The S3 folder for output storage.</span>
<span class="sd">                    Streaming output config:</span>
<span class="sd">                    - output_kafka_topic (str): Kafka output topic for streaming spouts.</span>
<span class="sd">                    - output_kafka_cluster_connection_string (str): Kafka connection string for streaming spouts.</span>
<span class="sd">                    Redis state manager config:</span>
<span class="sd">                    - redis_host (str): The host address for the Redis server.</span>
<span class="sd">                    - redis_port (int): The port number for the Redis server.</span>
<span class="sd">                    - redis_db (int): The Redis database to be used.</span>
<span class="sd">                    Postgres state manager config:</span>
<span class="sd">                    - postgres_host (str): The host address for the PostgreSQL server.</span>
<span class="sd">                    - postgres_port (int): The port number for the PostgreSQL server.</span>
<span class="sd">                    - postgres_user (str): The username for the PostgreSQL server.</span>
<span class="sd">                    - postgres_password (str): The password for the PostgreSQL server.</span>
<span class="sd">                    - postgres_database (str): The PostgreSQL database to be used.</span>
<span class="sd">                    - postgres_table (str): The PostgreSQL table to be used.</span>
<span class="sd">                    DynamoDB state manager config:</span>
<span class="sd">                    - dynamodb_table_name (str): The name of the DynamoDB table.</span>
<span class="sd">                    - dynamodb_region_name (str): The AWS region for DynamoDB.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Spout: The created spout.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If an invalid output type or state type is provided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create the output config</span>
        <span class="n">output_config</span><span class="p">:</span> <span class="n">BatchOutputConfig</span> <span class="o">|</span> <span class="n">StreamingOutputConfig</span>
        <span class="k">if</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
            <span class="n">output_config</span> <span class="o">=</span> <span class="n">BatchOutputConfig</span><span class="p">(</span>
                <span class="n">output_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_folder&quot;</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()),</span>
                <span class="n">bucket</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_s3_bucket&quot;</span><span class="p">,</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">),</span>
                <span class="n">s3_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_s3_folder&quot;</span><span class="p">,</span> <span class="n">klass</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
            <span class="n">output_config</span> <span class="o">=</span> <span class="n">StreamingOutputConfig</span><span class="p">(</span>
                <span class="n">output_topic</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_kafka_topic&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="n">kafka_servers</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_kafka_cluster_connection_string&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid output type: </span><span class="si">{</span><span class="n">output_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Create the state manager</span>
        <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span>
        <span class="k">if</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;in_memory&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">InMemoryStateManager</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;redis&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">RedisStateManager</span><span class="p">(</span>
                <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">db</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_db&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_db&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;postgres&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">PostgresStateManager</span><span class="p">(</span>
                <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">user</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_user&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_user&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">password</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_password&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_password&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">database</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_database&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_database&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">table</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_table&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_table&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span>
            <span class="n">state_manager</span> <span class="o">=</span> <span class="n">DynamoDBStateManager</span><span class="p">(</span>
                <span class="n">table_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_table_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_table_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">region_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_region_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_region_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid state type: </span><span class="si">{</span><span class="n">state_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Create the spout</span>
        <span class="n">spout</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span><span class="n">output_config</span><span class="o">=</span><span class="n">output_config</span><span class="p">,</span> <span class="n">state_manager</span><span class="o">=</span><span class="n">state_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spout</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_spout-core.spout.Spout.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-core_spout-core.spout.Spout.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Execute a method locally and manage the state.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>method_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the method to execute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positional arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments to pass to the method.
Keyword Arguments:
    - Additional keyword arguments specific to the method.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the method.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/spout.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute a method locally and manage the state.</span>

<span class="sd">    Args:</span>
<span class="sd">        method_name (str): The name of the method to execute.</span>
<span class="sd">        *args: Positional arguments to pass to the method.</span>
<span class="sd">        **kwargs: Keyword arguments to pass to the method.</span>
<span class="sd">            Keyword Arguments:</span>
<span class="sd">                - Additional keyword arguments specific to the method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The result of the method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the type of state manager</span>
        <span class="n">state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="c1"># Save the current set of class variables to the state manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Execute the task&#39;s method</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Flush the output config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="c1"># Store the state as successful in the state manager</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;failed&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to execute method &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_spout-core.spout.Spout.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">output_config</span><span class="p">,</span> <span class="n">state_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-core_spout-core.spout.Spout.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The <code>Spout</code> class is a base class for all spouts in the given context.
It inherits from the <code>Task</code> class and provides methods for executing tasks
both locally and remotely, as well as managing their state, with state management
options including in-memory, Redis, PostgreSQL, and DynamoDB,
and output configurations for batch or streaming data.</p>
<p>The <code>Spout</code> class uses the <code>OutputConfig</code> and <code>StateManager</code> classes, which are abstract base
 classes for managing output configurations and states, respectively. The <code>OutputConfig</code> class
 has two subclasses: <code>StreamingOutputConfig</code> and <code>BatchOutputConfig</code>, which manage streaming and
 batch output configurations, respectively. The <code>StateManager</code> class is used to get and set state,
 and it has several subclasses for different types of state managers.</p>
<p>The <code>Spout</code> class also uses the <code>ECSManager</code> and <code>K8sManager</code> classes in the <code>execute_remote</code> method,
which are used to manage tasks on Amazon ECS and Kubernetes, respectively.</p>

<details class="usage" open>
  <summary>Usage</summary>
  <ul>
<li>Create an instance of the Spout class by providing an OutputConfig object and a StateManager object.</li>
<li>The OutputConfig object specifies the output configuration for the spout.</li>
<li>The StateManager object handles the management of the spout's state.</li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <p>output_config = OutputConfig(...)
state_manager = StateManager(...)
spout = Spout(output_config, state_manager)</p>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_config</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.data.OutputConfig">OutputConfig</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output configuration.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>state_manager</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.state.StateManager">StateManager</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state manager.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/spout.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_config</span><span class="p">:</span> <span class="n">OutputConfig</span><span class="p">,</span> <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `Spout` class is a base class for all spouts in the given context.</span>
<span class="sd">    It inherits from the `Task` class and provides methods for executing tasks</span>
<span class="sd">    both locally and remotely, as well as managing their state, with state management</span>
<span class="sd">    options including in-memory, Redis, PostgreSQL, and DynamoDB,</span>
<span class="sd">    and output configurations for batch or streaming data.</span>

<span class="sd">    The `Spout` class uses the `OutputConfig` and `StateManager` classes, which are abstract base</span>
<span class="sd">     classes for managing output configurations and states, respectively. The `OutputConfig` class</span>
<span class="sd">     has two subclasses: `StreamingOutputConfig` and `BatchOutputConfig`, which manage streaming and</span>
<span class="sd">     batch output configurations, respectively. The `StateManager` class is used to get and set state,</span>
<span class="sd">     and it has several subclasses for different types of state managers.</span>

<span class="sd">    The `Spout` class also uses the `ECSManager` and `K8sManager` classes in the `execute_remote` method,</span>
<span class="sd">    which are used to manage tasks on Amazon ECS and Kubernetes, respectively.</span>

<span class="sd">    Usage:</span>
<span class="sd">        - Create an instance of the Spout class by providing an OutputConfig object and a StateManager object.</span>
<span class="sd">        - The OutputConfig object specifies the output configuration for the spout.</span>
<span class="sd">        - The StateManager object handles the management of the spout&#39;s state.</span>

<span class="sd">    Example:</span>
<span class="sd">        output_config = OutputConfig(...)</span>
<span class="sd">        state_manager = StateManager(...)</span>
<span class="sd">        spout = Spout(output_config, state_manager)</span>

<span class="sd">    Args:</span>
<span class="sd">        output_config (OutputConfig): The output configuration.</span>
<span class="sd">        state_manager (StateManager): The state manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span> <span class="o">=</span> <span class="n">output_config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_manager</span> <span class="o">=</span> <span class="n">state_manager</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_spout-core.spout.Spout.create" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">klass</span><span class="p">,</span> <span class="n">output_type</span><span class="p">,</span> <span class="n">state_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#core-core_spout-core.spout.Spout.create" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a spout of a specific type.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>klass</code></td>
          <td>
                <code><span data-autorefs-optional="type">type</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Spout class to create.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of output config ("batch" or "streaming").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>state_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of state manager ("in_memory", "redis", "postgres", or "dynamodb").</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments for initializing the spout.
Keyword Arguments:
    Batch output config:
    - output_folder (str): The directory where output files should be stored temporarily.
    - output_s3_bucket (str): The name of the S3 bucket for output storage.
    - output_s3_folder (str): The S3 folder for output storage.
    Streaming output config:
    - output_kafka_topic (str): Kafka output topic for streaming spouts.
    - output_kafka_cluster_connection_string (str): Kafka connection string for streaming spouts.
    Redis state manager config:
    - redis_host (str): The host address for the Redis server.
    - redis_port (int): The port number for the Redis server.
    - redis_db (int): The Redis database to be used.
    Postgres state manager config:
    - postgres_host (str): The host address for the PostgreSQL server.
    - postgres_port (int): The port number for the PostgreSQL server.
    - postgres_user (str): The username for the PostgreSQL server.
    - postgres_password (str): The password for the PostgreSQL server.
    - postgres_database (str): The PostgreSQL database to be used.
    - postgres_table (str): The PostgreSQL table to be used.
    DynamoDB state manager config:
    - dynamodb_table_name (str): The name of the DynamoDB table.
    - dynamodb_region_name (str): The AWS region for DynamoDB.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Spout</code></td>          <td>
                <code><span data-autorefs-optional-hover="core.spout.Spout">Spout</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The created spout.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If an invalid output type or state type is provided.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/spout.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">klass</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Spout&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a spout of a specific type.</span>

<span class="sd">    Args:</span>
<span class="sd">        klass (type): The Spout class to create.</span>
<span class="sd">        output_type (str): The type of output config (&quot;batch&quot; or &quot;streaming&quot;).</span>
<span class="sd">        state_type (str): The type of state manager (&quot;in_memory&quot;, &quot;redis&quot;, &quot;postgres&quot;, or &quot;dynamodb&quot;).</span>
<span class="sd">        **kwargs: Additional keyword arguments for initializing the spout.</span>
<span class="sd">            Keyword Arguments:</span>
<span class="sd">                Batch output config:</span>
<span class="sd">                - output_folder (str): The directory where output files should be stored temporarily.</span>
<span class="sd">                - output_s3_bucket (str): The name of the S3 bucket for output storage.</span>
<span class="sd">                - output_s3_folder (str): The S3 folder for output storage.</span>
<span class="sd">                Streaming output config:</span>
<span class="sd">                - output_kafka_topic (str): Kafka output topic for streaming spouts.</span>
<span class="sd">                - output_kafka_cluster_connection_string (str): Kafka connection string for streaming spouts.</span>
<span class="sd">                Redis state manager config:</span>
<span class="sd">                - redis_host (str): The host address for the Redis server.</span>
<span class="sd">                - redis_port (int): The port number for the Redis server.</span>
<span class="sd">                - redis_db (int): The Redis database to be used.</span>
<span class="sd">                Postgres state manager config:</span>
<span class="sd">                - postgres_host (str): The host address for the PostgreSQL server.</span>
<span class="sd">                - postgres_port (int): The port number for the PostgreSQL server.</span>
<span class="sd">                - postgres_user (str): The username for the PostgreSQL server.</span>
<span class="sd">                - postgres_password (str): The password for the PostgreSQL server.</span>
<span class="sd">                - postgres_database (str): The PostgreSQL database to be used.</span>
<span class="sd">                - postgres_table (str): The PostgreSQL table to be used.</span>
<span class="sd">                DynamoDB state manager config:</span>
<span class="sd">                - dynamodb_table_name (str): The name of the DynamoDB table.</span>
<span class="sd">                - dynamodb_region_name (str): The AWS region for DynamoDB.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Spout: The created spout.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If an invalid output type or state type is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create the output config</span>
    <span class="n">output_config</span><span class="p">:</span> <span class="n">BatchOutputConfig</span> <span class="o">|</span> <span class="n">StreamingOutputConfig</span>
    <span class="k">if</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;batch&quot;</span><span class="p">:</span>
        <span class="n">output_config</span> <span class="o">=</span> <span class="n">BatchOutputConfig</span><span class="p">(</span>
            <span class="n">output_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_folder&quot;</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()),</span>
            <span class="n">bucket</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_s3_bucket&quot;</span><span class="p">,</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">),</span>
            <span class="n">s3_folder</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_s3_folder&quot;</span><span class="p">,</span> <span class="n">klass</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;streaming&quot;</span><span class="p">:</span>
        <span class="n">output_config</span> <span class="o">=</span> <span class="n">StreamingOutputConfig</span><span class="p">(</span>
            <span class="n">output_topic</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_kafka_topic&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">kafka_servers</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_kafka_cluster_connection_string&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid output type: </span><span class="si">{</span><span class="n">output_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create the state manager</span>
    <span class="n">state_manager</span><span class="p">:</span> <span class="n">StateManager</span>
    <span class="k">if</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;in_memory&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">InMemoryStateManager</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;redis&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">RedisStateManager</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">db</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;redis_db&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;redis_db&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;postgres&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">PostgresStateManager</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_host&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_port&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">user</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_user&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_user&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_password&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_password&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_database&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_database&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">table</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;postgres_table&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;postgres_table&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">state_type</span> <span class="o">==</span> <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span>
        <span class="n">state_manager</span> <span class="o">=</span> <span class="n">DynamoDBStateManager</span><span class="p">(</span>
            <span class="n">table_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_table_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_table_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">region_name</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dynamodb_region_name&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;dynamodb_region_name&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid state type: </span><span class="si">{</span><span class="n">state_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create the spout</span>
    <span class="n">spout</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span><span class="n">output_config</span><span class="o">=</span><span class="n">output_config</span><span class="p">,</span> <span class="n">state_manager</span><span class="o">=</span><span class="n">state_manager</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spout</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section>
                        <h3 class='nav-section-title' id='section-data'>
                            data <a class='headerlink' href='#section-data' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="core-core_data_batch_input"><h1 id="core-core_data_batch_input-batch-data-input">Batch data input<a class="headerlink" href="#core-core_data_batch_input-batch-data-input" title="Permanent link">&para;</a></h1>
<p>Batch input manager</p>


<div class="doc doc-object doc-module">


<a id="core.data.batch_input"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig" class="doc doc-heading">
          <code>BatchInputConfig</code>


<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="core.data.input.InputConfig">InputConfig</span></code></p>

  
      <p>📁 BatchInputConfig: Manages batch input configurations.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder to read input files.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>bucket</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>S3 bucket name.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>s3_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder within the S3 bucket.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Usage:</p>
<pre><code class="language-python">config = BatchInputConfig(&quot;/path/to/input&quot;, &quot;my_bucket&quot;, &quot;s3/folder&quot;)
files = config.list_files()
content = config.read_file(&quot;example.txt&quot;)
</code></pre>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BatchInputConfig</span><span class="p">(</span><span class="n">InputConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📁 BatchInputConfig: Manages batch input configurations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        input_folder (str): Folder to read input files.</span>
<span class="sd">        bucket (str): S3 bucket name.</span>
<span class="sd">        s3_folder (str): Folder within the S3 bucket.</span>

<span class="sd">    Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    config = BatchInputConfig(&quot;/path/to/input&quot;, &quot;my_bucket&quot;, &quot;s3/folder&quot;)</span>
<span class="sd">    files = config.list_files()</span>
<span class="sd">    content = config.read_file(&quot;example.txt&quot;)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new batch input configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_folder (str): Folder to read input files.</span>
<span class="sd">            bucket (str): S3 bucket name.</span>
<span class="sd">            s3_folder (str): Folder within the S3 bucket.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">=</span> <span class="n">input_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span> <span class="o">=</span> <span class="n">bucket</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="o">=</span> <span class="n">s3_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📍 Get the input folder location.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The input folder location.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no input folder is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy_from_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🔄 Copy contents from a given S3 bucket and location to the input folder.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no input folder is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
            <span class="n">_bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket</span><span class="p">)</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">_bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
                <span class="n">_bucket</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📜 List all files in the input folder.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of file paths.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no input folder is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📖 Read a file from the input folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): The name of the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The contents of the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no input folder is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🗑️ Delete a file from the input folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): The name of the file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no input folder is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy_to_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ☁️ Copy a file from the input folder to an S3 bucket.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): The name of the file.</span>
<span class="sd">            bucket (str): The name of the S3 bucket.</span>
<span class="sd">            s3_folder (str): The folder in the S3 bucket.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no input folder is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
            <span class="n">s3</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
                <span class="n">bucket</span><span class="p">,</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s3_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">)</span></code>

<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new batch input configuration.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder to read input files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bucket</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>S3 bucket name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>s3_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder within the S3 bucket.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new batch input configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_folder (str): Folder to read input files.</span>
<span class="sd">        bucket (str): S3 bucket name.</span>
<span class="sd">        s3_folder (str): Folder within the S3 bucket.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span> <span class="o">=</span> <span class="n">input_folder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span> <span class="o">=</span> <span class="n">bucket</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="o">=</span> <span class="n">s3_folder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig.copy_from_remote" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_from_remote</span><span class="p">()</span></code>

<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig.copy_from_remote" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🔄 Copy contents from a given S3 bucket and location to the input folder.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no input folder is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_from_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🔄 Copy contents from a given S3 bucket and location to the input folder.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no input folder is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
        <span class="n">_bucket</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket</span><span class="p">)</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">_bucket</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="n">_bucket</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig.copy_to_remote" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_to_remote</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">)</span></code>

<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig.copy_to_remote" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>☁️ Copy a file from the input folder to an S3 bucket.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bucket</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the S3 bucket.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>s3_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The folder in the S3 bucket.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no input folder is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_to_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ☁️ Copy a file from the input folder to an S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The name of the file.</span>
<span class="sd">        bucket (str): The name of the S3 bucket.</span>
<span class="sd">        s3_folder (str): The folder in the S3 bucket.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no input folder is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
        <span class="n">s3</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
            <span class="n">bucket</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s3_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig.delete_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig.delete_file" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🗑️ Delete a file from the input folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no input folder is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🗑️ Delete a file from the input folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The name of the file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no input folder is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig.get" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get</span><span class="p">()</span></code>

<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📍 Get the input folder location.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input folder location.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no input folder is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📍 Get the input folder location.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The input folder location.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no input folder is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig.list_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">list_files</span><span class="p">()</span></code>

<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig.list_files" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📜 List all files in the input folder.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code><span data-autorefs-optional="list">list</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of file paths.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no input folder is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📜 List all files in the input folder.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of file paths.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no input folder is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_input-core.data.batch_input.BatchInputConfig.read_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#core-core_data_batch_input-core.data.batch_input.BatchInputConfig.read_file" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📖 Read a file from the input folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The contents of the file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no input folder is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📖 Read a file from the input folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The name of the file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The contents of the file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no input folder is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input folder specified.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input folder not specified.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_data_batch_output"><h1 id="core-core_data_batch_output-batch-data-output">Batch data output<a class="headerlink" href="#core-core_data_batch_output-batch-data-output" title="Permanent link">&para;</a></h1>
<p>Batch output manager</p>


<div class="doc doc-object doc-module">


<a id="core.data.batch_output"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig" class="doc doc-heading">
          <code>BatchOutputConfig</code>


<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="core.data.output.OutputConfig">OutputConfig</span></code></p>

  
      <p>📁 BatchOutputConfig: Manages batch output configurations.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder to save output files.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>bucket</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>S3 bucket name.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>s3_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder within the S3 bucket.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Usage:</p>
<pre><code class="language-python">config = BatchOutputConfig(&quot;/path/to/output&quot;, &quot;my_bucket&quot;, &quot;s3/folder&quot;)
config.save({&quot;key&quot;: &quot;value&quot;}, &quot;example.json&quot;)
files = config.list_files()
content = config.read_file(&quot;example.json&quot;)
</code></pre>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BatchOutputConfig</span><span class="p">(</span><span class="n">OutputConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📁 BatchOutputConfig: Manages batch output configurations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        output_folder (str): Folder to save output files.</span>
<span class="sd">        bucket (str): S3 bucket name.</span>
<span class="sd">        s3_folder (str): Folder within the S3 bucket.</span>

<span class="sd">    Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    config = BatchOutputConfig(&quot;/path/to/output&quot;, &quot;my_bucket&quot;, &quot;s3/folder&quot;)</span>
<span class="sd">    config.save({&quot;key&quot;: &quot;value&quot;}, &quot;example.json&quot;)</span>
<span class="sd">    files = config.list_files()</span>
<span class="sd">    content = config.read_file(&quot;example.json&quot;)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new batch output configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_folder (str): Folder to save output files.</span>
<span class="sd">            bucket (str): S3 bucket name.</span>
<span class="sd">            s3_folder (str): Folder within the S3 bucket.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span> <span class="o">=</span> <span class="n">output_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span> <span class="o">=</span> <span class="n">bucket</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="o">=</span> <span class="n">s3_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        💾 Save data to a file in the output folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Any): The data to save.</span>
<span class="sd">            filename (str): The filename to use when saving the data to a file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Wrote the data into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to write data to file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">copy_to_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ☁️ Recursively copy all files and directories from the output folder to a given S3 bucket and folder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                    <span class="n">local_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                    <span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span>
                    <span class="n">s3_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span><span class="p">,</span> <span class="n">relative_path</span><span class="p">)</span>
                    <span class="n">s3</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to copy files to S3: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🔄 Flush the output by copying all files and directories from the output folder to a given S3 bucket and folder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copy_to_remote</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📜 List all files in the output folder.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: The list of files in the output folder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📖 Read a file from the output folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): The name of the file to read.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The contents of the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🗑️ Delete a file from the output folder.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): The name of the file to delete.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">copy_file_to_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ☁️ Copy a specific file from the output folder to the S3 bucket.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): The name of the file to copy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">s3</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span><span class="p">,</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to copy file to S3: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">bucket</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">)</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new batch output configuration.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder to save output files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bucket</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>S3 bucket name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>s3_folder</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Folder within the S3 bucket.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bucket</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s3_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new batch output configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_folder (str): Folder to save output files.</span>
<span class="sd">        bucket (str): S3 bucket name.</span>
<span class="sd">        s3_folder (str): Folder within the S3 bucket.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span> <span class="o">=</span> <span class="n">output_folder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span> <span class="o">=</span> <span class="n">bucket</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span> <span class="o">=</span> <span class="n">s3_folder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.copy_file_to_remote" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_file_to_remote</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.copy_file_to_remote" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>☁️ Copy a specific file from the output folder to the S3 bucket.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file to copy.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_file_to_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ☁️ Copy a specific file from the output folder to the S3 bucket.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The name of the file to copy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s3</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to copy file to S3: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.copy_to_remote" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_to_remote</span><span class="p">()</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.copy_to_remote" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>☁️ Recursively copy all files and directories from the output folder to a given S3 bucket and folder.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_to_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ☁️ Recursively copy all files and directories from the output folder to a given S3 bucket and folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">local_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span>
                <span class="n">s3_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3_folder</span><span class="p">,</span> <span class="n">relative_path</span><span class="p">)</span>
                <span class="n">s3</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bucket</span><span class="p">,</span> <span class="n">s3_key</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to copy files to S3: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.delete_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.delete_file" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🗑️ Delete a file from the output folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file to delete.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🗑️ Delete a file from the output folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The name of the file to delete.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.flush" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flush</span><span class="p">()</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.flush" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🔄 Flush the output by copying all files and directories from the output folder to a given S3 bucket and folder.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🔄 Flush the output by copying all files and directories from the output folder to a given S3 bucket and folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copy_to_remote</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.list_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">list_files</span><span class="p">()</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.list_files" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📜 List all files in the output folder.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The list of files in the output folder.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📜 List all files in the output folder.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The list of files in the output folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.read_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.read_file" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📖 Read a file from the output folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file to read.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The contents of the file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📖 Read a file from the output folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The name of the file to read.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The contents of the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>

<a href="#core-core_data_batch_output-core.data.batch_output.BatchOutputConfig.save" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>💾 Save data to a file in the output folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data to save.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The filename to use when saving the data to a file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/batch_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    💾 Save data to a file in the output folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Any): The data to save.</span>
<span class="sd">        filename (str): The filename to use when saving the data to a file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Wrote the data into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to write data to file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_data_input"><h1 id="core-core_data_input-data-input">Data input<a class="headerlink" href="#core-core_data_input-data-input" title="Permanent link">&para;</a></h1>
<p>Input manager base class</p>


<div class="doc doc-object doc-module">


<a id="core.data.input"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_data_input-core.data.input.InputConfig" class="doc doc-heading">
          <code>InputConfig</code>


<a href="#core-core_data_input-core.data.input.InputConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="abc.ABC">ABC</span></code></p>

  
      <p>Abstract class for managing input configurations.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/input.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InputConfig</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract class for managing input configurations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract method to get data from the input source.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The data from the input source.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_data_input-core.data.input.InputConfig.get" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#core-core_data_input-core.data.input.InputConfig.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Abstract method to get data from the input source.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data from the input source.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract method to get data from the input source.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The data from the input source.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_data_output"><h1 id="core-core_data_output-data-output">Data output<a class="headerlink" href="#core-core_data_output-data-output" title="Permanent link">&para;</a></h1>
<p>Output manager base class</p>


<div class="doc doc-object doc-module">


<a id="core.data.output"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_data_output-core.data.output.OutputConfig" class="doc doc-heading">
          <code>OutputConfig</code>


<a href="#core-core_data_output-core.data.output.OutputConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="abc.ABC">ABC</span></code></p>

  
      <p>Abstract base class for managing output configurations.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OutputConfig</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for managing output configurations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save data to a file or ingest it into a Kafka topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Any): The data to save or ingest.</span>
<span class="sd">            filename (str): The filename to use when saving the data to a file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flush the output. This method should be implemented by subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_data_output-core.data.output.OutputConfig.flush" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flush</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#core-core_data_output-core.data.output.OutputConfig.flush" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Flush the output. This method should be implemented by subclasses.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Flush the output. This method should be implemented by subclasses.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_output-core.data.output.OutputConfig.save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#core-core_data_output-core.data.output.OutputConfig.save" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Save data to a file or ingest it into a Kafka topic.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data to save or ingest.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The filename to use when saving the data to a file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save data to a file or ingest it into a Kafka topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Any): The data to save or ingest.</span>
<span class="sd">        filename (str): The filename to use when saving the data to a file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_data_streaming_input"><h1 id="core-core_data_streaming_input-streaming-data-input">Streaming data input<a class="headerlink" href="#core-core_data_streaming_input-streaming-data-input" title="Permanent link">&para;</a></h1>
<p>Streaming input manager</p>


<div class="doc doc-object doc-module">


<a id="core.data.streaming_input"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig" class="doc doc-heading">
          <code>StreamingInputConfig</code>


<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="core.data.input.InputConfig">InputConfig</span></code></p>

  
      <p>📡 <strong>StreamingInputConfig</strong>: Manages streaming input configurations.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_topic</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka topic to consume data.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>consumer</code></td>
          <td>
                <code><span data-autorefs-optional-hover="kafka.KafkaConsumer">KafkaConsumer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka consumer for consuming data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Usage:</p>
<pre><code class="language-python">config = StreamingInputConfig(&quot;my_topic&quot;, &quot;localhost:9092&quot;)
for message in config.iterator():
    print(message.value)
</code></pre>
<p>Note:
- Ensure the Kafka cluster is running and accessible.
- Adjust the <code>group_id</code> if needed.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StreamingInputConfig</span><span class="p">(</span><span class="n">InputConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📡 **StreamingInputConfig**: Manages streaming input configurations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        input_topic (str): Kafka topic to consume data.</span>
<span class="sd">        consumer (KafkaConsumer): Kafka consumer for consuming data.</span>

<span class="sd">    Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    config = StreamingInputConfig(&quot;my_topic&quot;, &quot;localhost:9092&quot;)</span>
<span class="sd">    for message in config.iterator():</span>
<span class="sd">        print(message.value)</span>
<span class="sd">    ```</span>

<span class="sd">    Note:</span>
<span class="sd">    - Ensure the Kafka cluster is running and accessible.</span>
<span class="sd">    - Adjust the `group_id` if needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">kafka_cluster_connection_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new streaming input configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_topic (str): Kafka topic to consume data.</span>
<span class="sd">            kafka_cluster_connection_string (str): Kafka cluster connection string.</span>
<span class="sd">            group_id (str, optional): Kafka consumer group id. Defaults to &quot;geniusrise&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span> <span class="o">=</span> <span class="n">input_topic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span> <span class="o">=</span> <span class="n">KafkaConsumer</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span><span class="p">,</span>
                <span class="n">bootstrap_servers</span><span class="o">=</span><span class="n">kafka_cluster_connection_string</span><span class="p">,</span>
                <span class="n">group_id</span><span class="o">=</span><span class="n">group_id</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to create Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KafkaConsumer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📥 Get data from the input topic.</span>

<span class="sd">        Returns:</span>
<span class="sd">            KafkaConsumer: The Kafka consumer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no input source or consumer is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to consume from Kafka topic </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input source specified.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🔄 Iterator method for yielding data from the Kafka consumer.</span>

<span class="sd">        Yields:</span>
<span class="sd">            Kafka message: The next message from the Kafka consumer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka consumer is available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">message</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to iterate over Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka consumer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make the class iterable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the next message from the Kafka consumer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka consumer is available or an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to get next message from Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka consumer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🚪 Close the Kafka consumer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If an error occurs while closing the consumer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to close Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partition</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🔍 Change the position from which the Kafka consumer reads.</span>

<span class="sd">        Args:</span>
<span class="sd">            partition (int): The partition to seek.</span>
<span class="sd">            offset (int): The offset to seek to.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If an error occurs while seeking.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to seek Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ✅ Manually commit offsets.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If an error occurs while committing offsets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to commit offsets: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">filter_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🔍 Filter messages from the Kafka consumer based on a filter function.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_func (callable): A function that takes a Kafka message and returns a boolean.</span>

<span class="sd">        Yields:</span>
<span class="sd">            Kafka message: The next message from the Kafka consumer that passes the filter.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka consumer is available or an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
                        <span class="k">yield</span> <span class="n">message</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to filter messages from Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka consumer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_topic</span><span class="p">,</span> <span class="n">kafka_cluster_connection_string</span><span class="p">,</span> <span class="n">group_id</span><span class="o">=</span><span class="s1">&#39;geniusrise&#39;</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new streaming input configuration.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_topic</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka topic to consume data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kafka_cluster_connection_string</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka cluster connection string.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>group_id</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka consumer group id. Defaults to "geniusrise".</p>
            </div>
          </td>
          <td>
                <code>&#39;geniusrise&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">input_topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">kafka_cluster_connection_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new streaming input configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_topic (str): Kafka topic to consume data.</span>
<span class="sd">        kafka_cluster_connection_string (str): Kafka cluster connection string.</span>
<span class="sd">        group_id (str, optional): Kafka consumer group id. Defaults to &quot;geniusrise&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span> <span class="o">=</span> <span class="n">input_topic</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span> <span class="o">=</span> <span class="n">KafkaConsumer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span><span class="p">,</span>
            <span class="n">bootstrap_servers</span><span class="o">=</span><span class="n">kafka_cluster_connection_string</span><span class="p">,</span>
            <span class="n">group_id</span><span class="o">=</span><span class="n">group_id</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to create Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.__iter__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Make the class iterable.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make the class iterable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.__next__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__next__</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.__next__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get the next message from the Kafka consumer.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka consumer is available or an error occurs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the next message from the Kafka consumer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka consumer is available or an error occurs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to get next message from Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka consumer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.close" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🚪 Close the Kafka consumer.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If an error occurs while closing the consumer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🚪 Close the Kafka consumer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If an error occurs while closing the consumer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to close Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.commit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">commit</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.commit" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>✅ Manually commit offsets.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If an error occurs while committing offsets.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ✅ Manually commit offsets.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If an error occurs while committing offsets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to commit offsets: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.filter_messages" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_messages</span><span class="p">(</span><span class="n">filter_func</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.filter_messages" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🔍 Filter messages from the Kafka consumer based on a filter function.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filter_func</code></td>
          <td>
                <code><span data-autorefs-optional="callable">callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A function that takes a Kafka message and returns a boolean.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Yields:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Iterator">Iterator</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka message: The next message from the Kafka consumer that passes the filter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka consumer is available or an error occurs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filter_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🔍 Filter messages from the Kafka consumer based on a filter function.</span>

<span class="sd">    Args:</span>
<span class="sd">        filter_func (callable): A function that takes a Kafka message and returns a boolean.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Kafka message: The next message from the Kafka consumer that passes the filter.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka consumer is available or an error occurs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">message</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to filter messages from Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka consumer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.get" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📥 Get data from the input topic.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>KafkaConsumer</code></td>          <td>
                <code><span data-autorefs-optional-hover="kafka.KafkaConsumer">KafkaConsumer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Kafka consumer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no input source or consumer is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KafkaConsumer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📥 Get data from the input topic.</span>

<span class="sd">    Returns:</span>
<span class="sd">        KafkaConsumer: The Kafka consumer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no input source or consumer is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to consume from Kafka topic </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_topic</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No input source specified.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.iterator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iterator</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.iterator" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🔄 Iterator method for yielding data from the Kafka consumer.</p>



  <p><strong>Yields:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Iterator">Iterator</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka message: The next message from the Kafka consumer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka consumer is available.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🔄 Iterator method for yielding data from the Kafka consumer.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Kafka message: The next message from the Kafka consumer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka consumer is available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">message</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to iterate over Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka consumer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.seek" class="doc doc-heading">
<code class="highlight language-python"><span class="n">seek</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_input-core.data.streaming_input.StreamingInputConfig.seek" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🔍 Change the position from which the Kafka consumer reads.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The partition to seek.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>offset</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The offset to seek to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If an error occurs while seeking.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_input.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partition</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🔍 Change the position from which the Kafka consumer reads.</span>

<span class="sd">    Args:</span>
<span class="sd">        partition (int): The partition to seek.</span>
<span class="sd">        offset (int): The offset to seek to.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If an error occurs while seeking.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to seek Kafka consumer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_data_streaming_output"><h1 id="core-core_data_streaming_output-streaming-data-output">Streaming data output<a class="headerlink" href="#core-core_data_streaming_output-streaming-data-output" title="Permanent link">&para;</a></h1>
<p>Streaming output manager</p>


<div class="doc doc-object doc-module">


<a id="core.data.streaming_output"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig" class="doc doc-heading">
          <code>StreamingOutputConfig</code>


<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="core.data.output.OutputConfig">OutputConfig</span></code></p>

  
      <p>📡 <strong>StreamingOutputConfig</strong>: Manages streaming output configurations.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_topic</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka topic to ingest data.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>producer</code></td>
          <td>
                <code><span data-autorefs-optional-hover="kafka.KafkaProducer">KafkaProducer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka producer for ingesting data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Usage:</p>
<pre><code class="language-python">config = StreamingOutputConfig(&quot;my_topic&quot;, &quot;localhost:9092&quot;)
config.save({&quot;key&quot;: &quot;value&quot;}, &quot;ignored_filename&quot;)
config.flush()
</code></pre>
<p>Note:
- Ensure the Kafka cluster is running and accessible.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StreamingOutputConfig</span><span class="p">(</span><span class="n">OutputConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📡 **StreamingOutputConfig**: Manages streaming output configurations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        output_topic (str): Kafka topic to ingest data.</span>
<span class="sd">        producer (KafkaProducer): Kafka producer for ingesting data.</span>

<span class="sd">    Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    config = StreamingOutputConfig(&quot;my_topic&quot;, &quot;localhost:9092&quot;)</span>
<span class="sd">    config.save({&quot;key&quot;: &quot;value&quot;}, &quot;ignored_filename&quot;)</span>
<span class="sd">    config.flush()</span>
<span class="sd">    ```</span>

<span class="sd">    Note:</span>
<span class="sd">    - Ensure the Kafka cluster is running and accessible.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">kafka_servers</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new streaming output configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_topic (str): Kafka topic to ingest data.</span>
<span class="sd">            kafka_servers (str): Kafka bootstrap servers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span> <span class="o">=</span> <span class="n">output_topic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">(</span><span class="n">bootstrap_servers</span><span class="o">=</span><span class="n">kafka_servers</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to create Kafka producer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📤 Ingest data into the Kafka topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Any): The data to ingest.</span>
<span class="sd">            filename (str): This argument is ignored for streaming outputs.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted the data into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send data to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🔄 Flush the output by flushing the Kafka producer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka producer is available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">send_key_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🔑 Send a message with a key to the Kafka topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (Any): The key of the message.</span>
<span class="sd">            value (Any): The value of the message.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span>
                    <span class="n">key</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span>
                    <span class="n">value</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted the key-value pair into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send key-value pair to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🚪 Close the Kafka producer.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka producer is available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">partition_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partition</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🧐 Check if a partition is available in the Kafka topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            partition (int): The partition to check.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the partition is available, False otherwise.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka producer is available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partition</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">partitions_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">save_to_partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">partition</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🎯 Send a message to a specific partition in the Kafka topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            value (Any): The value of the message.</span>
<span class="sd">            partition (int): The partition to send the message to.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span>
                    <span class="n">value</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span>
                    <span class="n">partition</span><span class="o">=</span><span class="n">partition</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted the message into partition </span><span class="si">{</span><span class="n">partition</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send message to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">save_bulk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📦 Send multiple messages at once to the Kafka topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            messages (list): The messages to send.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span><span class="si">}</span><span class="s2"> messages into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send messages to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">output_topic</span><span class="p">,</span> <span class="n">kafka_servers</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new streaming output configuration.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_topic</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka topic to ingest data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kafka_servers</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kafka bootstrap servers.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">kafka_servers</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new streaming output configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_topic (str): Kafka topic to ingest data.</span>
<span class="sd">        kafka_servers (str): Kafka bootstrap servers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span> <span class="o">=</span> <span class="n">output_topic</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">producer</span> <span class="o">=</span> <span class="n">KafkaProducer</span><span class="p">(</span><span class="n">bootstrap_servers</span><span class="o">=</span><span class="n">kafka_servers</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to create Kafka producer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">producer</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.close" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🚪 Close the Kafka producer.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka producer is available.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🚪 Close the Kafka producer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka producer is available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">producer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.flush" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flush</span><span class="p">()</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.flush" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🔄 Flush the output by flushing the Kafka producer.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka producer is available.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🔄 Flush the output by flushing the Kafka producer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka producer is available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.partition_available" class="doc doc-heading">
<code class="highlight language-python"><span class="n">partition_available</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.partition_available" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🧐 Check if a partition is available in the Kafka topic.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The partition to check.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the partition is available, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka producer is available.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">partition_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partition</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🧐 Check if a partition is available in the Kafka topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        partition (int): The partition to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the partition is available, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka producer is available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">partition</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">partitions_for</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.save" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📤 Ingest data into the Kafka topic.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data to ingest.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This argument is ignored for streaming outputs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka producer is available or an error occurs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📤 Ingest data into the Kafka topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Any): The data to ingest.</span>
<span class="sd">        filename (str): This argument is ignored for streaming outputs.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted the data into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send data to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.save_bulk" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_bulk</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.save_bulk" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📦 Send multiple messages at once to the Kafka topic.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>messages</code></td>
          <td>
                <code><span data-autorefs-optional="list">list</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The messages to send.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka producer is available or an error occurs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_bulk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📦 Send multiple messages at once to the Kafka topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        messages (list): The messages to send.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span><span class="si">}</span><span class="s2"> messages into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send messages to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.save_to_partition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_to_partition</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">partition</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.save_to_partition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🎯 Send a message to a specific partition in the Kafka topic.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value of the message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>partition</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The partition to send the message to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka producer is available or an error occurs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_to_partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">partition</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🎯 Send a message to a specific partition in the Kafka topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        value (Any): The value of the message.</span>
<span class="sd">        partition (int): The partition to send the message to.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span>
                <span class="n">value</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span>
                <span class="n">partition</span><span class="o">=</span><span class="n">partition</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted the message into partition </span><span class="si">{</span><span class="n">partition</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send message to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.send_key_value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">send_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#core-core_data_streaming_output-core.data.streaming_output.StreamingOutputConfig.send_key_value" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🔑 Send a message with a key to the Kafka topic.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key of the message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value of the message.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If no Kafka producer is available or an error occurs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/data/streaming_output.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">send_key_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🔑 Send a message with a key to the Kafka topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (Any): The key of the message.</span>
<span class="sd">        value (Any): The value of the message.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If no Kafka producer is available or an error occurs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="p">,</span>
                <span class="n">key</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span>
                <span class="n">value</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Inserted the key-value pair into </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_topic</span><span class="si">}</span><span class="s2"> topic.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to send key-value pair to Kafka topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No Kafka producer available.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><h1 class='nav-section-title-end'>Ended: data</h1>
                        <h3 class='nav-section-title' id='section-state'>
                            state <a class='headerlink' href='#section-state' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="core-core_state_base"><h1 id="core-core_state_base-state">State<a class="headerlink" href="#core-core_state_base-state" title="Permanent link">&para;</a></h1>
<p>Base class for task state mnager</p>


<div class="doc doc-object doc-module">


<a id="core.state.base"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_state_base-core.state.base.StateManager" class="doc doc-heading">
          <code>StateManager</code>


<a href="#core-core_state_base-core.state.base.StateManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="abc.ABC">ABC</span></code></p>

  
      <p>Abstract base class for a state manager.</p>
<p>A state manager is responsible for getting and setting state.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">StateManager</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for a state manager.</span>

<span class="sd">    A state manager is responsible for getting and setting state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to get the state for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict: The state associated with the key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to set the state for.</span>
<span class="sd">            value (Dict): The state to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_state_base-core.state.base.StateManager.get_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_state</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#core-core_state_base-core.state.base.StateManager.get_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to get the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Dict</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state associated with the key.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to get the state for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: The state associated with the key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_base-core.state.base.StateManager.set_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#core-core_state_base-core.state.base.StateManager.set_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to set the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state to set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to set the state for.</span>
<span class="sd">        value (Dict): The state to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_state_dynamo"><h1 id="core-core_state_dynamo-dynamodb-state">DynamoDB State<a class="headerlink" href="#core-core_state_dynamo-dynamodb-state" title="Permanent link">&para;</a></h1>
<p>State manager using dynamoDB</p>


<div class="doc doc-object doc-module">


<a id="core.state.dynamo"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager" class="doc doc-heading">
          <code>DynamoDBStateManager</code>


<a href="#core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="geniusrise.core.state.StateManager">StateManager</span></code></p>

  
      <p>🗄️ <strong>DynamoDBStateManager</strong>: A state manager that stores state in DynamoDB.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dynamodb</code></td>
          <td>
                <code><span data-autorefs-optional="boto3">boto3</span>.<span data-autorefs-optional-hover="boto3.resources">resources</span>.<span data-autorefs-optional-hover="boto3.resources.factory">factory</span>.<span data-autorefs-optional-hover="boto3.resources.factory.dynamodb">dynamodb</span>.<span data-autorefs-optional-hover="boto3.resources.factory.dynamodb.ServiceResource">ServiceResource</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The DynamoDB service resource.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>table</code></td>
          <td>
                <code><span data-autorefs-optional="boto3">boto3</span>.<span data-autorefs-optional-hover="boto3.resources">resources</span>.<span data-autorefs-optional-hover="boto3.resources.factory">factory</span>.<span data-autorefs-optional-hover="boto3.resources.factory.dynamodb">dynamodb</span>.<span data-autorefs-optional-hover="boto3.resources.factory.dynamodb.Table">Table</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The DynamoDB table.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Usage:</p>
<pre><code class="language-python">manager = DynamoDBStateManager(&quot;my_table&quot;, &quot;us-west-1&quot;)
manager.set_state(&quot;key123&quot;, {&quot;status&quot;: &quot;active&quot;})
state = manager.get_state(&quot;key123&quot;)
print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}
</code></pre>
<p>Note:
- Ensure DynamoDB is accessible and the table exists.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/dynamo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DynamoDBStateManager</span><span class="p">(</span><span class="n">StateManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🗄️ **DynamoDBStateManager**: A state manager that stores state in DynamoDB.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dynamodb (boto3.resources.factory.dynamodb.ServiceResource): The DynamoDB service resource.</span>
<span class="sd">        table (boto3.resources.factory.dynamodb.Table): The DynamoDB table.</span>

<span class="sd">    Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    manager = DynamoDBStateManager(&quot;my_table&quot;, &quot;us-west-1&quot;)</span>
<span class="sd">    manager.set_state(&quot;key123&quot;, {&quot;status&quot;: &quot;active&quot;})</span>
<span class="sd">    state = manager.get_state(&quot;key123&quot;)</span>
<span class="sd">    print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}</span>
<span class="sd">    ```</span>

<span class="sd">    Note:</span>
<span class="sd">    - Ensure DynamoDB is accessible and the table exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new DynamoDB state manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            table_name (str): The name of the DynamoDB table.</span>
<span class="sd">            region_name (str): The name of the AWS region.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;dynamodb&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to connect to DynamoDB: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📖 Get the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to get the state for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict: The state associated with the key, or None if not found.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there&#39;s an error accessing DynamoDB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="n">Key</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">})</span>
                <span class="k">return</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Item&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;Item&quot;</span> <span class="ow">in</span> <span class="n">response</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to get state from DynamoDB: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No DynamoDB table.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📝 Set the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to set the state for.</span>
<span class="sd">            value (Dict): The state to set.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there&#39;s an error accessing DynamoDB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">put_item</span><span class="p">(</span><span class="n">Item</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">)})</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to set state in DynamoDB: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No DynamoDB table.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">region_name</span><span class="p">)</span></code>

<a href="#core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new DynamoDB state manager.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>table_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the DynamoDB table.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>region_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the AWS region.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/dynamo.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new DynamoDB state manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        table_name (str): The name of the DynamoDB table.</span>
<span class="sd">        region_name (str): The name of the AWS region.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;dynamodb&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to connect to DynamoDB: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager.get_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_state</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager.get_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📖 Get the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to get the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Dict</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state associated with the key, or None if not found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there's an error accessing DynamoDB.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/dynamo.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📖 Get the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to get the state for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: The state associated with the key, or None if not found.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If there&#39;s an error accessing DynamoDB.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="n">Key</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">})</span>
            <span class="k">return</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Item&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;Item&quot;</span> <span class="ow">in</span> <span class="n">response</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to get state from DynamoDB: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No DynamoDB table.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager.set_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#core-core_state_dynamo-core.state.dynamo.DynamoDBStateManager.set_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📝 Set the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to set the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state to set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there's an error accessing DynamoDB.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/dynamo.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📝 Set the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to set the state for.</span>
<span class="sd">        value (Dict): The state to set.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If there&#39;s an error accessing DynamoDB.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">put_item</span><span class="p">(</span><span class="n">Item</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">)})</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to set state in DynamoDB: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No DynamoDB table.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_state_memory"><h1 id="core-core_state_memory-in-memory-state">In-memory State<a class="headerlink" href="#core-core_state_memory-in-memory-state" title="Permanent link">&para;</a></h1>
<p>State manager using local memory</p>


<div class="doc doc-object doc-module">


<a id="core.state.memory"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_state_memory-core.state.memory.InMemoryStateManager" class="doc doc-heading">
          <code>InMemoryStateManager</code>


<a href="#core-core_state_memory-core.state.memory.InMemoryStateManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="geniusrise.core.state.StateManager">StateManager</span></code></p>

  
      <p>🧠 <strong>InMemoryStateManager</strong>: A state manager that stores state in memory.</p>
<p>This manager is useful for temporary storage or testing purposes. Since it's in-memory, the data will be lost once the application stops.</p>
<h4 id="core-core_state_memory-core.state.memory.InMemoryStateManager--attributes">Attributes:<a class="headerlink" href="#core-core_state_memory-core.state.memory.InMemoryStateManager--attributes" title="Permanent link">&para;</a></h4>
<ul>
<li><code>store</code> (Dict[str, Dict]): The in-memory store for states.</li>
</ul>
<h4 id="core-core_state_memory-core.state.memory.InMemoryStateManager--usage">Usage:<a class="headerlink" href="#core-core_state_memory-core.state.memory.InMemoryStateManager--usage" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">manager = InMemoryStateManager()
manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})
state = manager.get_state(&quot;user123&quot;)
print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}
</code></pre>
<p>!!! warning
    Remember, this is an in-memory store. Do not use it for persistent storage!</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/memory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InMemoryStateManager</span><span class="p">(</span><span class="n">StateManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🧠 **InMemoryStateManager**: A state manager that stores state in memory.</span>

<span class="sd">    This manager is useful for temporary storage or testing purposes. Since it&#39;s in-memory, the data will be lost once the application stops.</span>

<span class="sd">    ## Attributes:</span>
<span class="sd">    - `store` (Dict[str, Dict]): The in-memory store for states.</span>

<span class="sd">    ## Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    manager = InMemoryStateManager()</span>
<span class="sd">    manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})</span>
<span class="sd">    state = manager.get_state(&quot;user123&quot;)</span>
<span class="sd">    print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}</span>
<span class="sd">    ```</span>

<span class="sd">    !!! warning</span>
<span class="sd">        Remember, this is an in-memory store. Do not use it for persistent storage!</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">store</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new in-memory state manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📖 Get the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to get the state for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict: The state associated with the key, or None if not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Retrieved state for key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 No state found for key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📝 Set the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to set the state for.</span>
<span class="sd">            value (Dict): The state to set.</span>

<span class="sd">        Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Set state for key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_state_memory-core.state.memory.InMemoryStateManager.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#core-core_state_memory-core.state.memory.InMemoryStateManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new in-memory state manager.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/memory.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new in-memory state manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_memory-core.state.memory.InMemoryStateManager.get_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_state</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#core-core_state_memory-core.state.memory.InMemoryStateManager.get_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📖 Get the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to get the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Dict</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state associated with the key, or None if not found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/memory.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📖 Get the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to get the state for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: The state associated with the key, or None if not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">state</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Retrieved state for key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 No state found for key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_memory-core.state.memory.InMemoryStateManager.set_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#core-core_state_memory-core.state.memory.InMemoryStateManager.set_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📝 Set the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to set the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state to set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:</p>
<pre><code class="language-python">manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})
</code></pre>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/memory.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📝 Set the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to set the state for.</span>
<span class="sd">        value (Dict): The state to set.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```python</span>
<span class="sd">    manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ Set state for key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_state_postgres"><h1 id="core-core_state_postgres-postgres-state">Postgres State<a class="headerlink" href="#core-core_state_postgres-postgres-state" title="Permanent link">&para;</a></h1>
<p>State manager using postgres database</p>


<div class="doc doc-object doc-module">


<a id="core.state.postgres"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_state_postgres-core.state.postgres.PostgresStateManager" class="doc doc-heading">
          <code>PostgresStateManager</code>


<a href="#core-core_state_postgres-core.state.postgres.PostgresStateManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="geniusrise.core.state.StateManager">StateManager</span></code></p>

  
      <p>🗄️ <strong>PostgresStateManager</strong>: A state manager that stores state in a PostgreSQL database.</p>
<p>This manager provides a persistent storage solution using a PostgreSQL database.</p>
<h4 id="core-core_state_postgres-core.state.postgres.PostgresStateManager--attributes">Attributes:<a class="headerlink" href="#core-core_state_postgres-core.state.postgres.PostgresStateManager--attributes" title="Permanent link">&para;</a></h4>
<ul>
<li><code>conn</code> (psycopg2.extensions.connection): The PostgreSQL connection.</li>
</ul>
<h4 id="core-core_state_postgres-core.state.postgres.PostgresStateManager--usage">Usage:<a class="headerlink" href="#core-core_state_postgres-core.state.postgres.PostgresStateManager--usage" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">manager = PostgresStateManager(host=&quot;localhost&quot;, port=5432, user=&quot;admin&quot;, password=&quot;password&quot;, database=&quot;mydb&quot;)
manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})
state = manager.get_state(&quot;user123&quot;)
print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}
</code></pre>
<p>!!! warning
    Ensure PostgreSQL is accessible and the table exists.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/postgres.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PostgresStateManager</span><span class="p">(</span><span class="n">StateManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🗄️ **PostgresStateManager**: A state manager that stores state in a PostgreSQL database.</span>

<span class="sd">    This manager provides a persistent storage solution using a PostgreSQL database.</span>

<span class="sd">    ## Attributes:</span>
<span class="sd">    - `conn` (psycopg2.extensions.connection): The PostgreSQL connection.</span>

<span class="sd">    ## Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    manager = PostgresStateManager(host=&quot;localhost&quot;, port=5432, user=&quot;admin&quot;, password=&quot;password&quot;, database=&quot;mydb&quot;)</span>
<span class="sd">    manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})</span>
<span class="sd">    state = manager.get_state(&quot;user123&quot;)</span>
<span class="sd">    print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}</span>
<span class="sd">    ```</span>

<span class="sd">    !!! warning</span>
<span class="sd">        Ensure PostgreSQL is accessible and the table exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise_state&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new PostgreSQL state manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            host (str): The host of the PostgreSQL server.</span>
<span class="sd">            port (int): The port of the PostgreSQL server.</span>
<span class="sd">            user (str): The user to connect as.</span>
<span class="sd">            password (str): The user&#39;s password.</span>
<span class="sd">            database (str): The database to connect to.</span>
<span class="sd">            table (str, optional): The table to use. Defaults to &quot;geniusrise_state&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to connect to PostgreSQL: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📖 Get the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to get the state for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict: The state associated with the key, or None if not found.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there&#39;s an error accessing PostgreSQL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
                    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT value FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s2"> WHERE key = %s&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">key</span><span class="p">,))</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
                    <span class="k">return</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;data&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">result</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to get state from PostgreSQL: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No PostgreSQL connection.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📝 Set the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to set the state for.</span>
<span class="sd">            value (Dict): The state to set.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there&#39;s an error accessing PostgreSQL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">)}</span>
                    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                        INSERT INTO </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s2"> (key, value)</span>
<span class="s2">                        VALUES (%s, %s)</span>
<span class="s2">                        ON CONFLICT (key)</span>
<span class="s2">                        DO UPDATE SET value = EXCLUDED.value;</span>
<span class="s2">                        &quot;&quot;&quot;</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to set state in PostgreSQL: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;🚫 No PostgreSQL connection.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_state_postgres-core.state.postgres.PostgresStateManager.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s1">&#39;geniusrise_state&#39;</span><span class="p">)</span></code>

<a href="#core-core_state_postgres-core.state.postgres.PostgresStateManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new PostgreSQL state manager.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The host of the PostgreSQL server.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The port of the PostgreSQL server.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>user</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The user to connect as.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>password</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The user's password.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>database</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The database to connect to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>table</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The table to use. Defaults to "geniusrise_state".</p>
            </div>
          </td>
          <td>
                <code>&#39;geniusrise_state&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/postgres.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise_state&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new PostgreSQL state manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        host (str): The host of the PostgreSQL server.</span>
<span class="sd">        port (int): The port of the PostgreSQL server.</span>
<span class="sd">        user (str): The user to connect as.</span>
<span class="sd">        password (str): The user&#39;s password.</span>
<span class="sd">        database (str): The database to connect to.</span>
<span class="sd">        table (str, optional): The table to use. Defaults to &quot;geniusrise_state&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to connect to PostgreSQL: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_postgres-core.state.postgres.PostgresStateManager.get_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_state</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#core-core_state_postgres-core.state.postgres.PostgresStateManager.get_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📖 Get the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to get the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Dict</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state associated with the key, or None if not found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there's an error accessing PostgreSQL.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/postgres.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📖 Get the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to get the state for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: The state associated with the key, or None if not found.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If there&#39;s an error accessing PostgreSQL.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
                <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT value FROM </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s2"> WHERE key = %s&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">key</span><span class="p">,))</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;data&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">result</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to get state from PostgreSQL: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;🚫 No PostgreSQL connection.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_postgres-core.state.postgres.PostgresStateManager.set_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#core-core_state_postgres-core.state.postgres.PostgresStateManager.set_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📝 Set the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to set the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state to set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there's an error accessing PostgreSQL.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/postgres.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📝 Set the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to set the state for.</span>
<span class="sd">        value (Dict): The state to set.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If there&#39;s an error accessing PostgreSQL.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">)}</span>
                <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    INSERT INTO </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s2"> (key, value)</span>
<span class="s2">                    VALUES (%s, %s)</span>
<span class="s2">                    ON CONFLICT (key)</span>
<span class="s2">                    DO UPDATE SET value = EXCLUDED.value;</span>
<span class="s2">                    &quot;&quot;&quot;</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to set state in PostgreSQL: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;🚫 No PostgreSQL connection.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_state_redis"><h1 id="core-core_state_redis-redis-state">Redis State<a class="headerlink" href="#core-core_state_redis-redis-state" title="Permanent link">&para;</a></h1>
<p>State manager using redis</p>


<div class="doc doc-object doc-module">


<a id="core.state.redis"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_state_redis-core.state.redis.RedisStateManager" class="doc doc-heading">
          <code>RedisStateManager</code>


<a href="#core-core_state_redis-core.state.redis.RedisStateManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="geniusrise.core.state.StateManager">StateManager</span></code></p>

  
      <p>🗄️ <strong>RedisStateManager</strong>: A state manager that stores state in Redis.</p>
<p>This manager provides a fast, in-memory storage solution using Redis.</p>
<h4 id="core-core_state_redis-core.state.redis.RedisStateManager--attributes">Attributes:<a class="headerlink" href="#core-core_state_redis-core.state.redis.RedisStateManager--attributes" title="Permanent link">&para;</a></h4>
<ul>
<li><code>redis</code> (redis.Redis): The Redis connection.</li>
</ul>
<h4 id="core-core_state_redis-core.state.redis.RedisStateManager--usage">Usage:<a class="headerlink" href="#core-core_state_redis-core.state.redis.RedisStateManager--usage" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">manager = RedisStateManager(host=&quot;localhost&quot;, port=6379, db=0)
manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})
state = manager.get_state(&quot;user123&quot;)
print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}
</code></pre>
<p>!!! warning
    Ensure Redis is accessible and running.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/redis.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RedisStateManager</span><span class="p">(</span><span class="n">StateManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🗄️ **RedisStateManager**: A state manager that stores state in Redis.</span>

<span class="sd">    This manager provides a fast, in-memory storage solution using Redis.</span>

<span class="sd">    ## Attributes:</span>
<span class="sd">    - `redis` (redis.Redis): The Redis connection.</span>

<span class="sd">    ## Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    manager = RedisStateManager(host=&quot;localhost&quot;, port=6379, db=0)</span>
<span class="sd">    manager.set_state(&quot;user123&quot;, {&quot;status&quot;: &quot;active&quot;})</span>
<span class="sd">    state = manager.get_state(&quot;user123&quot;)</span>
<span class="sd">    print(state)  # Outputs: {&quot;status&quot;: &quot;active&quot;}</span>
<span class="sd">    ```</span>

<span class="sd">    !!! warning</span>
<span class="sd">        Ensure Redis is accessible and running.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new Redis state manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            host (str): The host of the Redis server.</span>
<span class="sd">            port (int): The port of the Redis server.</span>
<span class="sd">            db (int): The database number to connect to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔌 Connected to Redis at </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">, DB: </span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📖 Get the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to get the state for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict: The state associated with the key, or None if not found.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there&#39;s an error accessing Redis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔍 Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found in Redis.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📝 Set the state associated with a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key to set the state for.</span>
<span class="sd">            value (Dict): The state to set.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there&#39;s an error accessing Redis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ State for key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; set in Redis.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to set state in Redis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_state_redis-core.state.redis.RedisStateManager.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span></code>

<a href="#core-core_state_redis-core.state.redis.RedisStateManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new Redis state manager.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The host of the Redis server.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The port of the Redis server.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>db</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The database number to connect to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/redis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new Redis state manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        host (str): The host of the Redis server.</span>
<span class="sd">        port (int): The port of the Redis server.</span>
<span class="sd">        db (int): The database number to connect to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔌 Connected to Redis at </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">, DB: </span><span class="si">{</span><span class="n">db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_redis-core.state.redis.RedisStateManager.get_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_state</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#core-core_state_redis-core.state.redis.RedisStateManager.get_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📖 Get the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to get the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Dict</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state associated with the key, or None if not found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there's an error accessing Redis.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/redis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📖 Get the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to get the state for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: The state associated with the key, or None if not found.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If there&#39;s an error accessing Redis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔍 Key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found in Redis.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_state_redis-core.state.redis.RedisStateManager.set_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#core-core_state_redis-core.state.redis.RedisStateManager.set_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📝 Set the state associated with a key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to set the state for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The state to set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there's an error accessing Redis.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/state/redis.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📝 Set the state associated with a key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key to set the state for.</span>
<span class="sd">        value (Dict): The state to set.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If there&#39;s an error accessing Redis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jsonpickle</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ State for key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; set in Redis.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Failed to set state in Redis: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><h1 class='nav-section-title-end'>Ended: state</h1>
                        <h3 class='nav-section-title' id='section-task'>
                            task <a class='headerlink' href='#section-task' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="core-core_task_base"><h1 id="core-core_task_base-task">Task<a class="headerlink" href="#core-core_task_base-task" title="Permanent link">&para;</a></h1>
<p>Base class for Task</p>


<div class="doc doc-object doc-module">


<a id="core.task.base"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_task_base-core.task.base.Task" class="doc doc-heading">
          <code>Task</code>


<a href="#core-core_task_base-core.task.base.Task" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span data-autorefs-optional-hover="abc.ABC">ABC</span></code></p>

  
      <p>🛠️ <strong>Task</strong>: Class for managing tasks.</p>
<p>This class provides a foundation for creating and managing tasks. Each task has a unique identifier and can be associated with specific input and output configurations.</p>
<h4 id="core-core_task_base-core.task.base.Task--attributes">Attributes:<a class="headerlink" href="#core-core_task_base-core.task.base.Task--attributes" title="Permanent link">&para;</a></h4>
<ul>
<li><code>id</code> (uuid.UUID): Unique identifier for the task.</li>
<li><code>input_config</code> (InputConfig): Configuration for input data.</li>
<li><code>output_config</code> (OutputConfig): Configuration for output data.</li>
</ul>
<h4 id="core-core_task_base-core.task.base.Task--usage">Usage:<a class="headerlink" href="#core-core_task_base-core.task.base.Task--usage" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">task = Task()
task.execute(&quot;fetch_data&quot;)
</code></pre>
<p>!!! note
    Extend this class to implement specific task functionalities.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Task</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🛠️ **Task**: Class for managing tasks.</span>

<span class="sd">    This class provides a foundation for creating and managing tasks. Each task has a unique identifier and can be associated with specific input and output configurations.</span>

<span class="sd">    ## Attributes:</span>
<span class="sd">    - `id` (uuid.UUID): Unique identifier for the task.</span>
<span class="sd">    - `input_config` (InputConfig): Configuration for input data.</span>
<span class="sd">    - `output_config` (OutputConfig): Configuration for output data.</span>

<span class="sd">    ## Usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    task = Task()</span>
<span class="sd">    task.execute(&quot;fetch_data&quot;)</span>
<span class="sd">    ```</span>

<span class="sd">    !!! note</span>
<span class="sd">        Extend this class to implement specific task functionalities.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">input_config</span><span class="p">:</span> <span class="n">InputConfig</span>
    <span class="n">output_config</span><span class="p">:</span> <span class="n">OutputConfig</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new task.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_config (InputConfig): Configuration for input data.</span>
<span class="sd">            output_config (OutputConfig): Configuration for output data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚀 Initialized Task with ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a string representation of the task.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A string representation of the task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Task(id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, input_config=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="si">}</span><span class="s2">, output_config=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_config</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🚀 Execute a given fetch_* method if it exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            method_name (str): The name of the fetch_* method to execute.</span>
<span class="sd">            *args: Positional arguments to pass to the method.</span>
<span class="sd">            **kwargs: Keyword arguments to pass to the method.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: The result of the fetch_* method, or None if the method does not exist.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: If the specified method doesn&#39;t exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Method &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39; not found!&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_methods</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        📜 Get all the fetch_* methods and their parameters along with their default values and docstrings.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Tuple[str, List[str], str]]: A list of tuples, where each tuple contains the name of a fetch_* method,</span>
<span class="sd">            a list of its parameters along with their default values, and its docstring.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fetch_methods</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;fetch_&quot;</span><span class="p">):</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
                <span class="n">params_str</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">param</span><span class="o">.</span><span class="n">empty</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">]</span>
                <span class="n">docstring</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
                <span class="n">fetch_methods</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">params_str</span><span class="p">,</span> <span class="n">docstring</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">fetch_methods</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">print_help</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        🖨️ Pretty print the fetch_* methods and their parameters along with their default values and docstrings.</span>
<span class="sd">        Also prints the class&#39;s docstring and __init__ parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Print class docstring</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">colored</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">))</span>  <span class="c1"># type: ignore</span>

        <span class="c1"># Print fetch_* methods</span>
        <span class="n">fetch_methods</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_methods</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fetch_methods</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s2">&quot;l&quot;</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Method&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
                <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
                <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">docstring</span> <span class="ow">in</span> <span class="n">fetch_methods</span><span class="p">:</span>
                <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">_p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_p</span> <span class="ow">in</span> <span class="n">params</span> <span class="k">if</span> <span class="s2">&quot;self&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_p</span><span class="p">]</span>
                <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">colored</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parameters</span><span class="p">),</span> <span class="n">docstring</span><span class="p">],</span>
                    <span class="n">divider</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;No fetch_* methods found.&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_task_base-core.task.base.Task.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#core-core_task_base-core.task.base.Task.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new task.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_config</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.data.InputConfig">InputConfig</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration for input data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_config</code></td>
          <td>
                <code><span data-autorefs-optional-hover="geniusrise.core.data.OutputConfig">OutputConfig</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration for output data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new task.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_config (InputConfig): Configuration for input data.</span>
<span class="sd">        output_config (OutputConfig): Configuration for output data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚀 Initialized Task with ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_base-core.task.base.Task.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#core-core_task_base-core.task.base.Task.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of the task.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A string representation of the task.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a string representation of the task.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A string representation of the task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Task(id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, input_config=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_config</span><span class="si">}</span><span class="s2">, output_config=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_config</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_base-core.task.base.Task.execute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#core-core_task_base-core.task.base.Task.execute" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🚀 Execute a given fetch_* method if it exists.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>method_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the fetch_* method to execute.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positional arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments to pass to the method.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The result of the fetch_* method, or None if the method does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="AttributeError">AttributeError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the specified method doesn't exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🚀 Execute a given fetch_* method if it exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        method_name (str): The name of the fetch_* method to execute.</span>
<span class="sd">        *args: Positional arguments to pass to the method.</span>
<span class="sd">        **kwargs: Keyword arguments to pass to the method.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The result of the fetch_* method, or None if the method does not exist.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: If the specified method doesn&#39;t exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚫 Method &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39; not found!&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_base-core.task.base.Task.get_methods" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_methods</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#core-core_task_base-core.task.base.Task.get_methods" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>📜 Get all the fetch_* methods and their parameters along with their default values and docstrings.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional-hover="typing.Tuple">Tuple</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>], <span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List[Tuple[str, List[str], str]]: A list of tuples, where each tuple contains the name of a fetch_* method,</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional-hover="typing.Tuple">Tuple</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>], <span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>a list of its parameters along with their default values, and its docstring.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_methods</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    📜 Get all the fetch_* methods and their parameters along with their default values and docstrings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Tuple[str, List[str], str]]: A list of tuples, where each tuple contains the name of a fetch_* method,</span>
<span class="sd">        a list of its parameters along with their default values, and its docstring.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fetch_methods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;fetch_&quot;</span><span class="p">):</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
            <span class="n">params_str</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">param</span><span class="o">.</span><span class="n">empty</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="n">docstring</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
            <span class="n">fetch_methods</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">params_str</span><span class="p">,</span> <span class="n">docstring</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fetch_methods</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_base-core.task.base.Task.print_help" class="doc doc-heading">
<code class="highlight language-python"><span class="n">print_help</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#core-core_task_base-core.task.base.Task.print_help" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>🖨️ Pretty print the fetch_* methods and their parameters along with their default values and docstrings.
Also prints the class's docstring and <strong>init</strong> parameters.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">print_help</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    🖨️ Pretty print the fetch_* methods and their parameters along with their default values and docstrings.</span>
<span class="sd">    Also prints the class&#39;s docstring and __init__ parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Print class docstring</span>
    <span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">colored</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">))</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># Print fetch_* methods</span>
    <span class="n">fetch_methods</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_methods</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fetch_methods</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s2">&quot;l&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">field_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Method&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
            <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
            <span class="n">colored</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;cyan&quot;</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">docstring</span> <span class="ow">in</span> <span class="n">fetch_methods</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">_p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_p</span> <span class="ow">in</span> <span class="n">params</span> <span class="k">if</span> <span class="s2">&quot;self&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_p</span><span class="p">]</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="p">[</span><span class="n">colored</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parameters</span><span class="p">),</span> <span class="n">docstring</span><span class="p">],</span>
                <span class="n">divider</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="s2">&quot;No fetch_* methods found.&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_task_ecs"><h1 id="core-core_task_ecs-ecs-runner">ECS Runner<a class="headerlink" href="#core-core_task_ecs-ecs-runner" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="core.task.ecs"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_task_ecs-core.task.ecs.ECSManager" class="doc doc-heading">
          <code>ECSManager</code>


<a href="#core-core_task_ecs-core.task.ecs.ECSManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A class used to manage the lifecycle of an ECS container.</p>
<p>...</p>
<h4 id="core-core_task_ecs-core.task.ecs.ECSManager--attributes">Attributes<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager--attributes" title="Permanent link">&para;</a></h4>

<details class="name-" open>
  <summary>str</summary>
  <p>the name of the ECS task or service</p>
</details>
<details class="command-" open>
  <summary>List[str]</summary>
  <p>the command that the container runs</p>
</details>
<details class="cluster-" open>
  <summary>str</summary>
  <p>the name of the ECS cluster</p>
</details>
<details class="subnet_ids-" open>
  <summary>List[str]</summary>
  <p>the subnet IDs for the task or service</p>
</details>
<details class="security_group_ids-" open>
  <summary>List[str]</summary>
  <p>the security group IDs for the task or service</p>
</details>
<details class="image-" open>
  <summary>str</summary>
  <p>the Docker image for the task</p>
</details>
<details class="replicas-" open>
  <summary>int</summary>
  <p>the number of task replicas</p>
</details>
<details class="port-" open>
  <summary>int</summary>
  <p>the port that the container listens on</p>
</details>
<details class="log_group-" open>
  <summary>str</summary>
  <p>the CloudWatch log group for the task logs</p>
</details>
<details class="cpu-" open>
  <summary>int</summary>
  <p>the CPU value for the task</p>
</details>
<details class="memory-" open>
  <summary>int</summary>
  <p>the memory value for the task</p>
</details>      <h4 id="core.task.ecs.ECSManager--methods">Methods<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager--methods" title="Permanent link">&para;</a></h4>
<p>create_task_definition()
    Registers a new task definition from the attributes of this class
run_task(task_definition_arn: str)
    Runs a new task using the specified task definition ARN
describe_task(task_definition_arn: str)
    Describes a task using the specified task definition ARN
stop_task(task_definition_arn: str)
    Stops a running task using the specified task definition ARN
update_task(new_image: str, new_command: list)
    Updates a task with a new Docker image and command
create_service(task_definition_arn: str)
    Creates a new service using the specified task definition ARN
update_service(task_definition_arn: str)
    Updates a service with a new task definition ARN
delete_service()
    Deletes the service</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ECSManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class used to manage the lifecycle of an ECS container.</span>

<span class="sd">    ...</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        the name of the ECS task or service</span>
<span class="sd">    command : List[str]</span>
<span class="sd">        the command that the container runs</span>
<span class="sd">    cluster : str</span>
<span class="sd">        the name of the ECS cluster</span>
<span class="sd">    subnet_ids : List[str]</span>
<span class="sd">        the subnet IDs for the task or service</span>
<span class="sd">    security_group_ids : List[str]</span>
<span class="sd">        the security group IDs for the task or service</span>
<span class="sd">    image : str</span>
<span class="sd">        the Docker image for the task</span>
<span class="sd">    replicas : int</span>
<span class="sd">        the number of task replicas</span>
<span class="sd">    port : int</span>
<span class="sd">        the port that the container listens on</span>
<span class="sd">    log_group : str</span>
<span class="sd">        the CloudWatch log group for the task logs</span>
<span class="sd">    cpu : int</span>
<span class="sd">        the CPU value for the task</span>
<span class="sd">    memory : int</span>
<span class="sd">        the memory value for the task</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    create_task_definition()</span>
<span class="sd">        Registers a new task definition from the attributes of this class</span>
<span class="sd">    run_task(task_definition_arn: str)</span>
<span class="sd">        Runs a new task using the specified task definition ARN</span>
<span class="sd">    describe_task(task_definition_arn: str)</span>
<span class="sd">        Describes a task using the specified task definition ARN</span>
<span class="sd">    stop_task(task_definition_arn: str)</span>
<span class="sd">        Stops a running task using the specified task definition ARN</span>
<span class="sd">    update_task(new_image: str, new_command: list)</span>
<span class="sd">        Updates a task with a new Docker image and command</span>
<span class="sd">    create_service(task_definition_arn: str)</span>
<span class="sd">        Creates a new service using the specified task definition ARN</span>
<span class="sd">    update_service(task_definition_arn: str)</span>
<span class="sd">        Updates a service with a new task definition ARN</span>
<span class="sd">    delete_service()</span>
<span class="sd">        Deletes the service</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">account_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">cluster</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">subnet_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">security_group_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise/geniusrise&quot;</span><span class="p">,</span>
        <span class="n">replicas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
        <span class="n">log_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;/ecs/geniusrise&quot;</span><span class="p">,</span>
        <span class="n">cpu</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span>
        <span class="n">memory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs all the necessary attributes for the ECSManager object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            name : str</span>
<span class="sd">                the name of the ECS task or service</span>
<span class="sd">            account_id : str</span>
<span class="sd">                the id of the AWS account</span>
<span class="sd">            command : List[str]</span>
<span class="sd">                the command that the container runs</span>
<span class="sd">            cluster : str</span>
<span class="sd">                the name of the ECS cluster</span>
<span class="sd">            subnet_ids : List[str]</span>
<span class="sd">                the subnet IDs for the task or service</span>
<span class="sd">            security_group_ids : List[str]</span>
<span class="sd">                the security group IDs for the task or service</span>
<span class="sd">            image : str, optional</span>
<span class="sd">                the Docker image for the task (default is &quot;geniusrise/geniusrise&quot;)</span>
<span class="sd">            replicas : int, optional</span>
<span class="sd">                the number of task replicas (default is 1)</span>
<span class="sd">            port : int, optional</span>
<span class="sd">                the port that the container listens on (default is 80)</span>
<span class="sd">            log_group : str, optional</span>
<span class="sd">                the CloudWatch log group for the task logs (default is &quot;/ecs/geniusrise&quot;)</span>
<span class="sd">            cpu : int, optional</span>
<span class="sd">                the CPU value for the task (default is 256)</span>
<span class="sd">            memory : int, optional</span>
<span class="sd">                the memory value for the task (default is 512)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cluster</span> <span class="o">=</span> <span class="n">cluster</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;ecs&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_group</span> <span class="o">=</span> <span class="n">log_group</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subnet_ids</span> <span class="o">=</span> <span class="n">subnet_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">security_group_ids</span> <span class="o">=</span> <span class="n">security_group_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpu</span> <span class="o">=</span> <span class="n">cpu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account_id</span> <span class="o">=</span> <span class="n">account_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">memory</span>

    <span class="k">def</span> <span class="nf">create_task_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a new task definition from the attributes of this class.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The ARN of the task definition, or None if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">container_definitions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
                <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span>
                <span class="s2">&quot;portMappings&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;containerPort&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp&quot;</span><span class="p">}],</span>
            <span class="p">}</span>
        <span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">register_task_definition</span><span class="p">(</span>
                <span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">networkMode</span><span class="o">=</span><span class="s2">&quot;awsvpc&quot;</span><span class="p">,</span>
                <span class="n">containerDefinitions</span><span class="o">=</span><span class="n">container_definitions</span><span class="p">,</span>
                <span class="n">requiresCompatibilities</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;FARGATE&quot;</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="n">cpu</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu</span><span class="p">),</span>
                <span class="n">memory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">),</span>
                <span class="n">executionRoleArn</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;arn:aws:iam::</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">account_id</span><span class="si">}</span><span class="s2">:role/ecsTaskExecutionRole&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task definition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;taskDefinition&quot;</span><span class="p">][</span><span class="s2">&quot;taskDefinitionArn&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error creating task definition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">run_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs a new task using the specified task definition ARN.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        task_definition_arn : str</span>
<span class="sd">            The ARN of the task definition to run.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The response from the ECS API, or None if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">run_task</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
                <span class="n">taskDefinition</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">,</span>
                <span class="n">count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
                <span class="n">launchType</span><span class="o">=</span><span class="s2">&quot;FARGATE&quot;</span><span class="p">,</span>
                <span class="n">networkConfiguration</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;awsvpcConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;subnets&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet_ids</span><span class="p">,</span>
                        <span class="s2">&quot;assignPublicIp&quot;</span><span class="p">:</span> <span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;securityGroups&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">security_group_ids</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="n">platformVersion</span><span class="o">=</span><span class="s2">&quot;LATEST&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> started.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error starting task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">describe_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Describes a task using the specified task definition ARN.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        task_definition_arn : str</span>
<span class="sd">            The ARN of the task definition to describe.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The response from the ECS API, or None if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">describe_tasks</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span> <span class="n">tasks</span><span class="o">=</span><span class="p">[</span><span class="n">task_definition_arn</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting status of task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">stop_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a running task using the specified task definition ARN.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        task_definition_arn : str</span>
<span class="sd">            The ARN of the task definition to stop.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The response from the ECS API, or None if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">stop_task</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> stopped.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error stopping task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">update_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_command</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates a task with a new Docker image and command.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_image : str</span>
<span class="sd">            The new Docker image for the task.</span>
<span class="sd">        new_command : list</span>
<span class="sd">            The new command for the task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">new_image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">new_command</span>
        <span class="n">task_definition_arn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_task_definition</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">task_definition_arn</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_task</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_task</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - could not create ECS task definition.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new service using the specified task definition ARN.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        task_definition_arn : str</span>
<span class="sd">            The ARN of the task definition to use for the service.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The response from the ECS API, or None if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
                <span class="n">serviceName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">taskDefinition</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">,</span>
                <span class="n">desiredCount</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
                <span class="n">launchType</span><span class="o">=</span><span class="s2">&quot;FARGATE&quot;</span><span class="p">,</span>
                <span class="n">networkConfiguration</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;awsvpcConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;subnets&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet_ids</span><span class="p">,</span>
                        <span class="s2">&quot;assignPublicIp&quot;</span><span class="p">:</span> <span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;securityGroups&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">security_group_ids</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">},</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error creating service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">update_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates a service with a new task definition ARN.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        task_definition_arn : str</span>
<span class="sd">            The new ARN of the task definition to use for the service.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The response from the ECS API, or None if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_service</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
                <span class="n">service</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">taskDefinition</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">,</span>
                <span class="n">desiredCount</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> updated.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">delete_service</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the service.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The response from the ECS API, or None if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_service</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
                <span class="n">service</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> deleted.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error deleting service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="p">[],</span> <span class="n">subnet_ids</span><span class="o">=</span><span class="p">[],</span> <span class="n">security_group_ids</span><span class="o">=</span><span class="p">[],</span> <span class="n">image</span><span class="o">=</span><span class="s1">&#39;geniusrise/geniusrise&#39;</span><span class="p">,</span> <span class="n">replicas</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">log_group</span><span class="o">=</span><span class="s1">&#39;/ecs/geniusrise&#39;</span><span class="p">,</span> <span class="n">cpu</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Constructs all the necessary attributes for the ECSManager object.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.__init__--parameters">Parameters<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.__init__--parameters" title="Permanent link">&para;</a></h5>
<pre><code>name : str
    the name of the ECS task or service
account_id : str
    the id of the AWS account
command : List[str]
    the command that the container runs
cluster : str
    the name of the ECS cluster
subnet_ids : List[str]
    the subnet IDs for the task or service
security_group_ids : List[str]
    the security group IDs for the task or service
image : str, optional
    the Docker image for the task (default is "geniusrise/geniusrise")
replicas : int, optional
    the number of task replicas (default is 1)
port : int, optional
    the port that the container listens on (default is 80)
log_group : str, optional
    the CloudWatch log group for the task logs (default is "/ecs/geniusrise")
cpu : int, optional
    the CPU value for the task (default is 256)
memory : int, optional
    the memory value for the task (default is 512)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">account_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cluster</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">subnet_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">security_group_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise/geniusrise&quot;</span><span class="p">,</span>
    <span class="n">replicas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
    <span class="n">log_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;/ecs/geniusrise&quot;</span><span class="p">,</span>
    <span class="n">cpu</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span>
    <span class="n">memory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs all the necessary attributes for the ECSManager object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the ECS task or service</span>
<span class="sd">        account_id : str</span>
<span class="sd">            the id of the AWS account</span>
<span class="sd">        command : List[str]</span>
<span class="sd">            the command that the container runs</span>
<span class="sd">        cluster : str</span>
<span class="sd">            the name of the ECS cluster</span>
<span class="sd">        subnet_ids : List[str]</span>
<span class="sd">            the subnet IDs for the task or service</span>
<span class="sd">        security_group_ids : List[str]</span>
<span class="sd">            the security group IDs for the task or service</span>
<span class="sd">        image : str, optional</span>
<span class="sd">            the Docker image for the task (default is &quot;geniusrise/geniusrise&quot;)</span>
<span class="sd">        replicas : int, optional</span>
<span class="sd">            the number of task replicas (default is 1)</span>
<span class="sd">        port : int, optional</span>
<span class="sd">            the port that the container listens on (default is 80)</span>
<span class="sd">        log_group : str, optional</span>
<span class="sd">            the CloudWatch log group for the task logs (default is &quot;/ecs/geniusrise&quot;)</span>
<span class="sd">        cpu : int, optional</span>
<span class="sd">            the CPU value for the task (default is 256)</span>
<span class="sd">        memory : int, optional</span>
<span class="sd">            the memory value for the task (default is 512)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cluster</span> <span class="o">=</span> <span class="n">cluster</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;ecs&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_group</span> <span class="o">=</span> <span class="n">log_group</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logs_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">subnet_ids</span> <span class="o">=</span> <span class="n">subnet_ids</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">security_group_ids</span> <span class="o">=</span> <span class="n">security_group_ids</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpu</span> <span class="o">=</span> <span class="n">cpu</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">account_id</span> <span class="o">=</span> <span class="n">account_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">memory</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.create_service" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_service</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.create_service" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a new service using the specified task definition ARN.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.create_service--parameters">Parameters<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.create_service--parameters" title="Permanent link">&para;</a></h5>

<details class="task_definition_arn-" open>
  <summary>str</summary>
  <p>The ARN of the task definition to use for the service.</p>
</details>      <h5 id="core.task.ecs.ECSManager.create_service--returns">Returns<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.create_service--returns" title="Permanent link">&para;</a></h5>
<p>dict
    The response from the ECS API, or None if an error occurred.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new service using the specified task definition ARN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    task_definition_arn : str</span>
<span class="sd">        The ARN of the task definition to use for the service.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The response from the ECS API, or None if an error occurred.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span>
            <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
            <span class="n">serviceName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">taskDefinition</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">,</span>
            <span class="n">desiredCount</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
            <span class="n">launchType</span><span class="o">=</span><span class="s2">&quot;FARGATE&quot;</span><span class="p">,</span>
            <span class="n">networkConfiguration</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;awsvpcConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;subnets&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet_ids</span><span class="p">,</span>
                    <span class="s2">&quot;assignPublicIp&quot;</span><span class="p">:</span> <span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;securityGroups&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">security_group_ids</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error creating service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.create_task_definition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_task_definition</span><span class="p">()</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.create_task_definition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Registers a new task definition from the attributes of this class.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.create_task_definition--returns">Returns<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.create_task_definition--returns" title="Permanent link">&para;</a></h5>
<p>str
    The ARN of the task definition, or None if an error occurred.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_task_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registers a new task definition from the attributes of this class.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The ARN of the task definition, or None if an error occurred.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">container_definitions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
            <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span>
            <span class="s2">&quot;portMappings&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;containerPort&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp&quot;</span><span class="p">}],</span>
        <span class="p">}</span>
    <span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">register_task_definition</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">networkMode</span><span class="o">=</span><span class="s2">&quot;awsvpc&quot;</span><span class="p">,</span>
            <span class="n">containerDefinitions</span><span class="o">=</span><span class="n">container_definitions</span><span class="p">,</span>
            <span class="n">requiresCompatibilities</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;FARGATE&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">cpu</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu</span><span class="p">),</span>
            <span class="n">memory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">),</span>
            <span class="n">executionRoleArn</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;arn:aws:iam::</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">account_id</span><span class="si">}</span><span class="s2">:role/ecsTaskExecutionRole&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task definition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;taskDefinition&quot;</span><span class="p">][</span><span class="s2">&quot;taskDefinitionArn&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error creating task definition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.delete_service" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_service</span><span class="p">()</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.delete_service" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Deletes the service.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.delete_service--returns">Returns<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.delete_service--returns" title="Permanent link">&para;</a></h5>
<p>dict
    The response from the ECS API, or None if an error occurred.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_service</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes the service.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The response from the ECS API, or None if an error occurred.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_service</span><span class="p">(</span>
            <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
            <span class="n">service</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> deleted.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error deleting service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.describe_task" class="doc doc-heading">
<code class="highlight language-python"><span class="n">describe_task</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.describe_task" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Describes a task using the specified task definition ARN.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.describe_task--parameters">Parameters<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.describe_task--parameters" title="Permanent link">&para;</a></h5>

<details class="task_definition_arn-" open>
  <summary>str</summary>
  <p>The ARN of the task definition to describe.</p>
</details>      <h5 id="core.task.ecs.ECSManager.describe_task--returns">Returns<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.describe_task--returns" title="Permanent link">&para;</a></h5>
<p>dict
    The response from the ECS API, or None if an error occurred.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">describe_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Describes a task using the specified task definition ARN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    task_definition_arn : str</span>
<span class="sd">        The ARN of the task definition to describe.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The response from the ECS API, or None if an error occurred.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">describe_tasks</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span> <span class="n">tasks</span><span class="o">=</span><span class="p">[</span><span class="n">task_definition_arn</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting status of task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.run_task" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_task</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.run_task" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Runs a new task using the specified task definition ARN.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.run_task--parameters">Parameters<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.run_task--parameters" title="Permanent link">&para;</a></h5>

<details class="task_definition_arn-" open>
  <summary>str</summary>
  <p>The ARN of the task definition to run.</p>
</details>      <h5 id="core.task.ecs.ECSManager.run_task--returns">Returns<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.run_task--returns" title="Permanent link">&para;</a></h5>
<p>dict
    The response from the ECS API, or None if an error occurred.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs a new task using the specified task definition ARN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    task_definition_arn : str</span>
<span class="sd">        The ARN of the task definition to run.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The response from the ECS API, or None if an error occurred.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">run_task</span><span class="p">(</span>
            <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
            <span class="n">taskDefinition</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">,</span>
            <span class="n">count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
            <span class="n">launchType</span><span class="o">=</span><span class="s2">&quot;FARGATE&quot;</span><span class="p">,</span>
            <span class="n">networkConfiguration</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;awsvpcConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;subnets&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subnet_ids</span><span class="p">,</span>
                    <span class="s2">&quot;assignPublicIp&quot;</span><span class="p">:</span> <span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;securityGroups&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">security_group_ids</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="n">platformVersion</span><span class="o">=</span><span class="s2">&quot;LATEST&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> started.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error starting task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.stop_task" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop_task</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.stop_task" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Stops a running task using the specified task definition ARN.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.stop_task--parameters">Parameters<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.stop_task--parameters" title="Permanent link">&para;</a></h5>

<details class="task_definition_arn-" open>
  <summary>str</summary>
  <p>The ARN of the task definition to stop.</p>
</details>      <h5 id="core.task.ecs.ECSManager.stop_task--returns">Returns<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.stop_task--returns" title="Permanent link">&para;</a></h5>
<p>dict
    The response from the ECS API, or None if an error occurred.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stops a running task using the specified task definition ARN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    task_definition_arn : str</span>
<span class="sd">        The ARN of the task definition to stop.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The response from the ECS API, or None if an error occurred.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">stop_task</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> stopped.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error stopping task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.update_service" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_service</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.update_service" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates a service with a new task definition ARN.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.update_service--parameters">Parameters<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.update_service--parameters" title="Permanent link">&para;</a></h5>

<details class="task_definition_arn-" open>
  <summary>str</summary>
  <p>The new ARN of the task definition to use for the service.</p>
</details>      <h5 id="core.task.ecs.ECSManager.update_service--returns">Returns<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.update_service--returns" title="Permanent link">&para;</a></h5>
<p>dict
    The response from the ECS API, or None if an error occurred.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_definition_arn</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a service with a new task definition ARN.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    task_definition_arn : str</span>
<span class="sd">        The new ARN of the task definition to use for the service.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The response from the ECS API, or None if an error occurred.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_service</span><span class="p">(</span>
            <span class="n">cluster</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster</span><span class="p">,</span>
            <span class="n">service</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">taskDefinition</span><span class="o">=</span><span class="n">task_definition_arn</span><span class="p">,</span>
            <span class="n">desiredCount</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> updated.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">BotoCoreError</span><span class="p">,</span> <span class="n">ClientError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_ecs-core.task.ecs.ECSManager.update_task" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_task</span><span class="p">(</span><span class="n">new_image</span><span class="p">,</span> <span class="n">new_command</span><span class="p">)</span></code>

<a href="#core-core_task_ecs-core.task.ecs.ECSManager.update_task" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates a task with a new Docker image and command.</p>
<h5 id="core-core_task_ecs-core.task.ecs.ECSManager.update_task--parameters">Parameters<a class="headerlink" href="#core-core_task_ecs-core.task.ecs.ECSManager.update_task--parameters" title="Permanent link">&para;</a></h5>

<details class="new_image-" open>
  <summary>str</summary>
  <p>The new Docker image for the task.</p>
</details>
<details class="new_command-" open>
  <summary>list</summary>
  <p>The new command for the task.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/ecs.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_command</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a task with a new Docker image and command.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    new_image : str</span>
<span class="sd">        The new Docker image for the task.</span>
<span class="sd">    new_command : list</span>
<span class="sd">        The new command for the task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">new_image</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">new_command</span>
    <span class="n">task_definition_arn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_task_definition</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">task_definition_arn</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_task</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_task</span><span class="p">(</span><span class="n">task_definition_arn</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating task </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - could not create ECS task definition.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="core-core_task_k8s"><h1 id="core-core_task_k8s-kubernetes-runner">Kubernetes Runner<a class="headerlink" href="#core-core_task_k8s-kubernetes-runner" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="core.task.k8s"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="core-core_task_k8s-core.task.k8s.K8sManager" class="doc doc-heading">
          <code>K8sManager</code>


<a href="#core-core_task_k8s-core.task.k8s.K8sManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A class used to manage Kubernetes deployments and services.</p>
<h4 id="core-core_task_k8s-core.task.k8s.K8sManager--attributes">Attributes<a class="headerlink" href="#core-core_task_k8s-core.task.k8s.K8sManager--attributes" title="Permanent link">&para;</a></h4>

<details class="name-" open>
  <summary>str</summary>
  <p>The name of the deployment and service.</p>
</details>
<details class="namespace-" open>
  <summary>str</summary>
  <p>The namespace to create the deployment and service in.</p>
</details>
<details class="image-" open>
  <summary>str</summary>
  <p>The Docker image to use for the deployment.</p>
</details>
<details class="command-" open>
  <summary>list</summary>
  <p>The command to run in the Docker container.</p>
</details>
<details class="replicas-" open>
  <summary>int</summary>
  <p>The number of replicas to create for the deployment.</p>
</details>
<details class="port-" open>
  <summary>int</summary>
  <p>The port to expose on the service.</p>
</details>      <h4 id="core.task.k8s.K8sManager--methods">Methods<a class="headerlink" href="#core-core_task_k8s-core.task.k8s.K8sManager--methods" title="Permanent link">&para;</a></h4>
<p>create_deployment()
    Creates a new deployment.
update_deployment(replicas)
    Updates the number of replicas in the deployment.
scale_deployment(replicas)
    Scales the deployment to a new number of replicas.
delete_deployment()
    Deletes the deployment.
create_service()
    Creates a new service.
delete_service()
    Deletes the service.
run()
    Creates the deployment and service.
destroy()
    Deletes the deployment and service.
get_status()
    Returns the status of the deployment.
get_statistics()
    Returns the details of the deployment and the pods in the deployment.
get_logs()
    Returns the logs of the pods in the deployment.</p>

            <details class="quote">
              <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">K8sManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class used to manage Kubernetes deployments and services.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the deployment and service.</span>
<span class="sd">    namespace : str</span>
<span class="sd">        The namespace to create the deployment and service in.</span>
<span class="sd">    image : str</span>
<span class="sd">        The Docker image to use for the deployment.</span>
<span class="sd">    command : list</span>
<span class="sd">        The command to run in the Docker container.</span>
<span class="sd">    replicas : int</span>
<span class="sd">        The number of replicas to create for the deployment.</span>
<span class="sd">    port : int</span>
<span class="sd">        The port to expose on the service.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    create_deployment()</span>
<span class="sd">        Creates a new deployment.</span>
<span class="sd">    update_deployment(replicas)</span>
<span class="sd">        Updates the number of replicas in the deployment.</span>
<span class="sd">    scale_deployment(replicas)</span>
<span class="sd">        Scales the deployment to a new number of replicas.</span>
<span class="sd">    delete_deployment()</span>
<span class="sd">        Deletes the deployment.</span>
<span class="sd">    create_service()</span>
<span class="sd">        Creates a new service.</span>
<span class="sd">    delete_service()</span>
<span class="sd">        Deletes the service.</span>
<span class="sd">    run()</span>
<span class="sd">        Creates the deployment and service.</span>
<span class="sd">    destroy()</span>
<span class="sd">        Deletes the deployment and service.</span>
<span class="sd">    get_status()</span>
<span class="sd">        Returns the status of the deployment.</span>
<span class="sd">    get_statistics()</span>
<span class="sd">        Returns the details of the deployment and the pods in the deployment.</span>
<span class="sd">    get_logs()</span>
<span class="sd">        Returns the logs of the pods in the deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise/geniusrise&quot;</span><span class="p">,</span>
        <span class="n">replicas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs all the necessary attributes for the K8sManager object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the deployment and service.</span>
<span class="sd">        command : list</span>
<span class="sd">            The command to run in the Docker container.</span>
<span class="sd">        namespace : str, optional</span>
<span class="sd">            The namespace to create the deployment and service in (default is &quot;default&quot;).</span>
<span class="sd">        image : str, optional</span>
<span class="sd">            The Docker image to use for the deployment (default is &quot;geniusrise/geniusrise&quot;).</span>
<span class="sd">        replicas : int, optional</span>
<span class="sd">            The number of replicas to create for the deployment (default is 1).</span>
<span class="sd">        port : int, optional</span>
<span class="sd">            The port to expose on the service (default is 80).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span> <span class="o">=</span> <span class="n">namespace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>

        <span class="c1"># Load kube config from default location</span>
        <span class="n">config</span><span class="o">.</span><span class="n">load_kube_config</span><span class="p">()</span>

        <span class="c1"># Create a client instance for Core V1 and Apps V1 of Kubernetes API</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_deployment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new deployment.</span>

<span class="sd">        The deployment is created in the namespace specified in the constructor. The deployment uses the Docker image</span>
<span class="sd">        and command specified in the constructor, and creates the number of replicas specified in the constructor.</span>

<span class="sd">        If an error occurs while creating the deployment, an error message is logged and the method returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the container</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Container</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>

        <span class="c1"># Define the template</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1PodTemplateSpec</span><span class="p">(</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">}),</span>
            <span class="n">spec</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1PodSpec</span><span class="p">(</span><span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="n">container</span><span class="p">]),</span>
        <span class="p">)</span>

        <span class="c1"># Define the spec</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1DeploymentSpec</span><span class="p">(</span>
            <span class="n">replicas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
            <span class="n">selector</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1LabelSelector</span><span class="p">(</span><span class="n">match_labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">}),</span>
            <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Define the deployment</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Deployment</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>

        <span class="c1"># Create the deployment</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">create_namespaced_deployment</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when creating deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_deployment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replicas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the number of replicas in the deployment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        replicas : int</span>
<span class="sd">            The new number of replicas for the deployment.</span>

<span class="sd">        If an error occurs while updating the deployment, an error message is logged and the method returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the existing deployment</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

            <span class="c1"># Update the number of replicas</span>
            <span class="n">deployment</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>

            <span class="c1"># Update the deployment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">replace_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> updated.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when updating deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">scale_deployment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replicas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scales the deployment to a new number of replicas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        replicas : int</span>
<span class="sd">            The new number of replicas for the deployment.</span>

<span class="sd">        If an error occurs while scaling the deployment, an error message is logged and the method returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the existing deployment</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

            <span class="c1"># Update the number of replicas</span>
            <span class="n">deployment</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>

            <span class="c1"># Update the deployment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">replace_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> scaled to </span><span class="si">{</span><span class="n">replicas</span><span class="si">}</span><span class="s2"> replicas.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when scaling deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_deployment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Delete the deployment</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">delete_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> deleted.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when deleting deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the deployment.</span>

<span class="sd">        If an error occurs while deleting the deployment, an error message is logged and the method returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the service spec</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1ServiceSpec</span><span class="p">(</span>
            <span class="n">selector</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
            <span class="n">ports</span><span class="o">=</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">V1ServicePort</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="n">target_port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)],</span>
        <span class="p">)</span>

        <span class="c1"># Define the service</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Service</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>

        <span class="c1"># Create the service</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">create_namespaced_service</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">service</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when creating service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new service.</span>

<span class="sd">        The service is created in the namespace specified in the constructor. The service exposes the port specified</span>
<span class="sd">        in the constructor.</span>

<span class="sd">        If an error occurs while creating the service, an error message is logged and the method returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Delete the service</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">delete_namespaced_service</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> deleted.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when deleting service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates the deployment and service.</span>

<span class="sd">        If an error occurs while creating the deployment or service,</span>
<span class="sd">        an error message is logged and the method returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_deployment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_service</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the deployment and service.</span>

<span class="sd">        If an error occurs while deleting the deployment or service,</span>
<span class="sd">        an error message is logged and the method returns None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_deployment</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_service</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the status of the deployment</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Any]: The status of the deployment</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get the status of the deployment</span>
            <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">deployment</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when getting status of deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">get_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the details of the deployment and the pods in the deployment</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Any]: The details of the deployment and the pods</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get the details of the deployment</span>
            <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
            <span class="n">deployment_stats</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">status</span>

            <span class="c1"># Get the details of the pods in the deployment</span>
            <span class="n">pod_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">label_selector</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;app=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">pod_stats</span> <span class="o">=</span> <span class="p">[</span><span class="n">pod</span><span class="o">.</span><span class="n">status</span> <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pod_list</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>

            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;deployment&quot;</span><span class="p">:</span> <span class="n">deployment_stats</span><span class="p">,</span> <span class="s2">&quot;pods&quot;</span><span class="p">:</span> <span class="n">pod_stats</span><span class="p">}</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when getting statistics of deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">get_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the logs of the pods in the deployment</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, str]: The logs of the pods</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get the logs of the pods in the deployment</span>
            <span class="n">logs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">_continue</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">pod_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span>
                    <span class="n">label_selector</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;app=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">_continue</span><span class="o">=</span><span class="n">_continue</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pod_list</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
                    <span class="n">logs</span><span class="p">[</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">read_namespaced_pod_log</span><span class="p">(</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
                <span class="n">_continue</span> <span class="o">=</span> <span class="n">pod_list</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">_continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">_continue</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">return</span> <span class="n">logs</span>
        <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when getting logs of deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="p">[],</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="s1">&#39;geniusrise/geniusrise&#39;</span><span class="p">,</span> <span class="n">replicas</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Constructs all the necessary attributes for the K8sManager object.</p>
<h5 id="core-core_task_k8s-core.task.k8s.K8sManager.__init__--parameters">Parameters<a class="headerlink" href="#core-core_task_k8s-core.task.k8s.K8sManager.__init__--parameters" title="Permanent link">&para;</a></h5>

<details class="name-" open>
  <summary>str</summary>
  <p>The name of the deployment and service.</p>
</details>
<details class="command-" open>
  <summary>list</summary>
  <p>The command to run in the Docker container.</p>
</details>
<details class="namespace-" open>
  <summary>str, optional</summary>
  <p>The namespace to create the deployment and service in (default is "default").</p>
</details>
<details class="image-" open>
  <summary>str, optional</summary>
  <p>The Docker image to use for the deployment (default is "geniusrise/geniusrise").</p>
</details>
<details class="replicas-" open>
  <summary>int, optional</summary>
  <p>The number of replicas to create for the deployment (default is 1).</p>
</details>
<details class="port-" open>
  <summary>int, optional</summary>
  <p>The port to expose on the service (default is 80).</p>
</details>
          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">command</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geniusrise/geniusrise&quot;</span><span class="p">,</span>
    <span class="n">replicas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs all the necessary attributes for the K8sManager object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the deployment and service.</span>
<span class="sd">    command : list</span>
<span class="sd">        The command to run in the Docker container.</span>
<span class="sd">    namespace : str, optional</span>
<span class="sd">        The namespace to create the deployment and service in (default is &quot;default&quot;).</span>
<span class="sd">    image : str, optional</span>
<span class="sd">        The Docker image to use for the deployment (default is &quot;geniusrise/geniusrise&quot;).</span>
<span class="sd">    replicas : int, optional</span>
<span class="sd">        The number of replicas to create for the deployment (default is 1).</span>
<span class="sd">    port : int, optional</span>
<span class="sd">        The port to expose on the service (default is 80).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span> <span class="o">=</span> <span class="n">namespace</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>

    <span class="c1"># Load kube config from default location</span>
    <span class="n">config</span><span class="o">.</span><span class="n">load_kube_config</span><span class="p">()</span>

    <span class="c1"># Create a client instance for Core V1 and Apps V1 of Kubernetes API</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.create_deployment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_deployment</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.create_deployment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a new deployment.</p>
<p>The deployment is created in the namespace specified in the constructor. The deployment uses the Docker image
and command specified in the constructor, and creates the number of replicas specified in the constructor.</p>
<p>If an error occurs while creating the deployment, an error message is logged and the method returns None.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_deployment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new deployment.</span>

<span class="sd">    The deployment is created in the namespace specified in the constructor. The deployment uses the Docker image</span>
<span class="sd">    and command specified in the constructor, and creates the number of replicas specified in the constructor.</span>

<span class="sd">    If an error occurs while creating the deployment, an error message is logged and the method returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the container</span>
    <span class="n">container</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Container</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>

    <span class="c1"># Define the template</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1PodTemplateSpec</span><span class="p">(</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">}),</span>
        <span class="n">spec</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1PodSpec</span><span class="p">(</span><span class="n">containers</span><span class="o">=</span><span class="p">[</span><span class="n">container</span><span class="p">]),</span>
    <span class="p">)</span>

    <span class="c1"># Define the spec</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1DeploymentSpec</span><span class="p">(</span>
        <span class="n">replicas</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replicas</span><span class="p">,</span>
        <span class="n">selector</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1LabelSelector</span><span class="p">(</span><span class="n">match_labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="s2">&quot;geniusrise&quot;</span><span class="p">}),</span>
        <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Define the deployment</span>
    <span class="n">deployment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Deployment</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>

    <span class="c1"># Create the deployment</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">create_namespaced_deployment</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when creating deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.create_service" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_service</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.create_service" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Deletes the deployment.</p>
<p>If an error occurs while deleting the deployment, an error message is logged and the method returns None.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes the deployment.</span>

<span class="sd">    If an error occurs while deleting the deployment, an error message is logged and the method returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the service spec</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1ServiceSpec</span><span class="p">(</span>
        <span class="n">selector</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">},</span>
        <span class="n">ports</span><span class="o">=</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">V1ServicePort</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="n">target_port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)],</span>
    <span class="p">)</span>

    <span class="c1"># Define the service</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Service</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">spec</span><span class="o">=</span><span class="n">spec</span><span class="p">)</span>

    <span class="c1"># Create the service</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">create_namespaced_service</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">service</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> created.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when creating service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.delete_service" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_service</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.delete_service" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a new service.</p>
<p>The service is created in the namespace specified in the constructor. The service exposes the port specified
in the constructor.</p>
<p>If an error occurs while creating the service, an error message is logged and the method returns None.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new service.</span>

<span class="sd">    The service is created in the namespace specified in the constructor. The service exposes the port specified</span>
<span class="sd">    in the constructor.</span>

<span class="sd">    If an error occurs while creating the service, an error message is logged and the method returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Delete the service</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">delete_namespaced_service</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> deleted.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when deleting service </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.destroy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">destroy</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.destroy" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Deletes the deployment and service.</p>
<p>If an error occurs while deleting the deployment or service,
an error message is logged and the method returns None.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes the deployment and service.</span>

<span class="sd">    If an error occurs while deleting the deployment or service,</span>
<span class="sd">    an error message is logged and the method returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delete_deployment</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delete_service</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.get_logs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_logs</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.get_logs" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get the logs of the pods in the deployment</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dict[str, str]: The logs of the pods</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the logs of the pods in the deployment</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, str]: The logs of the pods</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the logs of the pods in the deployment</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">_continue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">pod_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">label_selector</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;app=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">_continue</span><span class="o">=</span><span class="n">_continue</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pod_list</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
                <span class="n">logs</span><span class="p">[</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">read_namespaced_pod_log</span><span class="p">(</span><span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
            <span class="n">_continue</span> <span class="o">=</span> <span class="n">pod_list</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">_continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_continue</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">logs</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when getting logs of deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.get_statistics" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_statistics</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.get_statistics" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get the details of the deployment and the pods in the deployment</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dict[str, Any]: The details of the deployment and the pods</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the details of the deployment and the pods in the deployment</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Any]: The details of the deployment and the pods</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the details of the deployment</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
        <span class="n">deployment_stats</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">status</span>

        <span class="c1"># Get the details of the pods in the deployment</span>
        <span class="n">pod_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">label_selector</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;app=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">pod_stats</span> <span class="o">=</span> <span class="p">[</span><span class="n">pod</span><span class="o">.</span><span class="n">status</span> <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pod_list</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;deployment&quot;</span><span class="p">:</span> <span class="n">deployment_stats</span><span class="p">,</span> <span class="s2">&quot;pods&quot;</span><span class="p">:</span> <span class="n">pod_stats</span><span class="p">}</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when getting statistics of deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.get_status" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_status</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.get_status" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get the status of the deployment</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dict[str, Any]: The status of the deployment</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the status of the deployment</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Any]: The status of the deployment</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get the status of the deployment</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">deployment</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="vm">__dict__</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when getting status of deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.run" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates the deployment and service.</p>
<p>If an error occurs while creating the deployment or service,
an error message is logged and the method returns None.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the deployment and service.</span>

<span class="sd">    If an error occurs while creating the deployment or service,</span>
<span class="sd">    an error message is logged and the method returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">create_deployment</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">create_service</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.scale_deployment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scale_deployment</span><span class="p">(</span><span class="n">replicas</span><span class="p">)</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.scale_deployment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Scales the deployment to a new number of replicas.</p>
<h5 id="core-core_task_k8s-core.task.k8s.K8sManager.scale_deployment--parameters">Parameters<a class="headerlink" href="#core-core_task_k8s-core.task.k8s.K8sManager.scale_deployment--parameters" title="Permanent link">&para;</a></h5>

<details class="replicas-" open>
  <summary>int</summary>
  <p>The new number of replicas for the deployment.</p>
</details>      <p>If an error occurs while scaling the deployment, an error message is logged and the method returns None.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">scale_deployment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replicas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scales the deployment to a new number of replicas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    replicas : int</span>
<span class="sd">        The new number of replicas for the deployment.</span>

<span class="sd">    If an error occurs while scaling the deployment, an error message is logged and the method returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the existing deployment</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

        <span class="c1"># Update the number of replicas</span>
        <span class="n">deployment</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>

        <span class="c1"># Update the deployment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">replace_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> scaled to </span><span class="si">{</span><span class="n">replicas</span><span class="si">}</span><span class="s2"> replicas.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when scaling deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="core-core_task_k8s-core.task.k8s.K8sManager.update_deployment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_deployment</span><span class="p">(</span><span class="n">replicas</span><span class="p">)</span></code>

<a href="#core-core_task_k8s-core.task.k8s.K8sManager.update_deployment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates the number of replicas in the deployment.</p>
<h5 id="core-core_task_k8s-core.task.k8s.K8sManager.update_deployment--parameters">Parameters<a class="headerlink" href="#core-core_task_k8s-core.task.k8s.K8sManager.update_deployment--parameters" title="Permanent link">&para;</a></h5>

<details class="replicas-" open>
  <summary>int</summary>
  <p>The new number of replicas for the deployment.</p>
</details>      <p>If an error occurs while updating the deployment, an error message is logged and the method returns None.</p>

          <details class="quote">
            <summary>Source code in <code>/run/media/ixaxaar/src/code/src/geniusrise/geniusrise/geniusrise/core/task/k8s.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_deployment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replicas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the number of replicas in the deployment.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    replicas : int</span>
<span class="sd">        The new number of replicas for the deployment.</span>

<span class="sd">    If an error occurs while updating the deployment, an error message is logged and the method returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the existing deployment</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">read_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

        <span class="c1"># Update the number of replicas</span>
        <span class="n">deployment</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">replicas</span> <span class="o">=</span> <span class="n">replicas</span>

        <span class="c1"># Update the deployment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apps_api</span><span class="o">.</span><span class="n">replace_namespaced_deployment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">deployment</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> updated.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception when updating deployment </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><h1 class='nav-section-title-end'>Ended: task</h1><h1 class='nav-section-title-end'>Ended: core</h1><h1 class='nav-section-title-end'>Ended: Core Reference</h1></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "/", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.tracking", "navigation.sections", "navigation.expand", "header.autohide"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../js/print-site.js"></script>
        
      
    
  </body>
</html>